require=function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){var n=e[s][1][t];return r(n?n:t)},u,u.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e){var n="/* BASIC */\n\n.biojs_msa_stage {\n    cursor: default;\n    line-height: normal; \n}\n\n.biojs_msa_seqblock {\n    cursor: move;\n}\n\n.biojs_msa_layer{\n    display: block;\n    white-space: nowrap;\n}\n\n.biojs_msa_labels {\n    color:black;\n    display: inline-block;\n    white-space: nowrap;\n    cursor: pointer;\n    vertical-align:middle;\n    overflow: hidden;\n    text-overflow: clip;\n    /*margin:auto; */\n    text-align: left;\n}\n\n.biojs_msa_header {\n    white-space: nowrap;\n    text-align: left;\n}\n\n.biojs_msa_labelrow:before {\n    content: '';\n    display: inline-block;\n    width: 0;\n    height: 100%;\n    vertical-align: middle;\n}\n\n.biojs_msa_labelrow{\n    height: 100%;\n}\n\n.biojs_msa_labelblock::-webkit-scrollbar, .biojs_msa_rheader::-webkit-scrollbar{\n    // FIX scrollbars on Mac\n    -webkit-appearance: none;\n    width: 7px;\n    height: 7px;\n}\n.biojs_msa_labelblock::-webkit-scrollbar-thumb, .biojs_msa_rheader::-webkit-scrollbar-thumb{\n    border-radius: 4px;\n    background-color: rgba(0,0,0,.5);\n    box-shadow: 0 0 1px rgba(255,255,255,.5);\n}\n\n/* END BASIC */\n/* Marker */\n\n.biojs_msa_marker{\n    color:grey;\n    white-space: nowrap;\n    cursor: pointer;\n}\n\n.biojs_msa_marker span{\n    text-align: center;\n}\n\n/* END Marker */\n/* Menubar */\n\n.smenubar .smenubar_alink {\n    background: #3498db;\n    background-image: -webkit-linear-gradient(top, #3498db, #2980b9);\n    background-image: -moz-linear-gradient(top, #3498db, #2980b9);\n    background-image: -ms-linear-gradient(top, #3498db, #2980b9);\n    background-image: -o-linear-gradient(top, #3498db, #2980b9);\n    background-image: linear-gradient(to bottom, #3498db, #2980b9);\n    -webkit-border-radius: 28;\n    -moz-border-radius: 28;\n    border-radius: 28px;\n    font-family: Arial;\n    color: #ffffff;\n    padding: 3px 10px 3px 10px;\n    margin-left: 10px;\n    text-decoration: none;\n}\n.smenubar {\n    display: inline-block;\n}\n\n.smenubar .smenubar_alink:hover {\n    cursor: pointer;\n}\n\n\n/* jquery dropdown CSS */\n\n.smenu-dropdown {\n    position: absolute;\n    z-index: 9999999;\n    display: none;\n}\n\n.smenu-dropdown .smenu-dropdown-menu,\n.smenu-dropdown .smenu-dropdown-panel {\n    min-width: 160px;\n    max-width: 360px;\n    list-style: none;\n    background: #FFF;\n    border: solid 1px #DDD;\n    border: solid 1px rgba(0, 0, 0, .2);\n    border-radius: 6px;\n    box-shadow: 0 5px 10px rgba(0, 0, 0, .2);\n    overflow: visible;\n    padding: 4px 0;\n    margin: 0;\n}\n\n.smenu-dropdown .smenu-dropdown-panel {\n    padding: 10px;\n}\n\n\n.smenu-dropdown.smenu-dropdown-scroll .smenu-dropdown-menu,\n.smenu-dropdown.smenu-dropdown-scroll .smenu-dropdown-panel {\n    max-height: 358px;\n    overflow: auto;\n}\n\n.smenu-dropdown .smenu-dropdown-menu LI {\n    list-style: none;\n    padding: 0 0;\n    margin: 0;\n    line-height: 18px;\n}\n\n.smenu-dropdown .smenu-dropdown-menu LI,\n.smenu-dropdown .smenu-dropdown-menu LABEL {\n    display: block;\n    color: #555;\n    text-decoration: none;\n    line-height: 18px;\n    padding: 3px 15px;\n    white-space: nowrap;\n}\n\n.smenu-dropdown .smenu-dropdown-menu LI:hover,\n.smenu-dropdown .smenu-dropdown-menu LABEL:hover {\n    background-color: #08C;\n    color: #FFF;\n    cursor: pointer;\n}\n\n.smenu-dropdown .smenu-dropdown-menu .smenu-dropdown-divider {\n    font-size: 1px;\n    border-top: solid 1px #E5E5E5;\n    padding: 0;\n    margin: 5px 0;\n}\n\n/* END Menubar */\n";t("/home/xsebi/ownCloud/projects/biojs.bak/packages/msa/node_modules/cssify")(n),e.exports=n},{"/home/xsebi/ownCloud/projects/biojs.bak/packages/msa/node_modules/cssify":40}],2:[function(t,e){function n(t){var e=t.parentNode,n=t.nextSibling;return e.removeChild(t),function(){n?e.insertBefore(t,n):e.appendChild(t)}}var i,r=t("underscore"),o=t("backbone-viewj"),s=function(t){for(var e;e=t.lastChild;)t.removeChild(e)};e.exports=i=o.extend({renderSubviews:function(){var t=this.el,e=void 0!=t.parentNode;if(e)var i=n(t);s(t);for(var o,a,l=document.createDocumentFragment(),h=this._views(),u=r.sortBy(h,function(t){return t.ordering}),c=0;c<u.length;c++)o=u[c],o.render(),a=o.el,null!=a&&l.appendChild(a);return t.appendChild(l),e&&i(),t},addView:function(t,e){var n=this._views();if(null==e)throw"Invalid plugin. ";return null==e.ordering&&(e.ordering=t),n[t]=e},removeViews:function(){var t,e,n=this._views();for(e in n)t=n[e],t.undelegateEvents(),t.unbind(),null!=t.removeViews&&t.removeViews(),t.remove();return this.views={}},removeView:function(t){var e=this._views();return e[t].remove(),delete e[t]},getView:function(t){var e=this._views();return e[t]},remove:function(){return this.removeViews(),o.prototype.remove.apply(this)},_views:function(){return null==this.views&&(this.views={}),this.views}})},{"backbone-viewj":9,underscore:66}],3:[function(t,e){var n=t("backbone-events-standalone"),i=t("backbone-extend-standalone"),r=t("underscore"),o=t("./model"),s=[],a=s.slice,l=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,r.extend({silent:!0},e))},h={add:!0,remove:!0,merge:!0},u={add:!0,remove:!1};r.extend(l.prototype,n,{model:o,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(t,e){return this.set(t,r.extend({merge:!1},e,u))},remove:function(t,e){var n=!r.isArray(t);t=n?[t]:r.clone(t),e||(e={});for(var i=0,o=t.length;o>i;i++){var s=t[i]=this.get(t[i]);if(s){var a=this.modelId(s.attributes);null!=a&&delete this._byId[a],delete this._byId[s.cid];var l=this.indexOf(s);this.models.splice(l,1),this.length--,e.silent||(e.index=l,s.trigger("remove",s,this,e)),this._removeReference(s,e)}}return n?t[0]:t},set:function(t,e){e=r.defaults({},e,h),e.parse&&(t=this.parse(t,e));var n=!r.isArray(t);t=n?t?[t]:[]:t.slice();for(var i,o,s,a,l,u=e.at,c=this.comparator&&null==u&&e.sort!==!1,d=r.isString(this.comparator)?this.comparator:null,f=[],g=[],m={},p=e.add,v=e.merge,b=e.remove,x=!c&&p&&b?[]:!1,w=0,y=t.length;y>w;w++){if(s=t[w],a=this.get(s))b&&(m[a.cid]=!0),v&&s!==a&&(s=this._isModel(s)?s.attributes:s,e.parse&&(s=a.parse(s,e)),a.set(s,e),c&&!l&&a.hasChanged(d)&&(l=!0)),t[w]=a;else if(p){if(o=t[w]=this._prepareModel(s,e),!o)continue;f.push(o),this._addReference(o,e)}o=a||o,o&&(i=this.modelId(o.attributes),!x||!o.isNew()&&m[i]||x.push(o),m[i]=!0)}if(b){for(var w=0,y=this.length;y>w;w++)m[(o=this.models[w]).cid]||g.push(o);g.length&&this.remove(g,e)}if(f.length||x&&x.length)if(c&&(l=!0),this.length+=f.length,null!=u)for(var w=0,y=f.length;y>w;w++)this.models.splice(u+w,0,f[w]);else{x&&(this.models.length=0);for(var _=x||f,w=0,y=_.length;y>w;w++)this.models.push(_[w])}if(l&&this.sort({silent:!0}),!e.silent){for(var S=null!=u?r.clone(e):e,w=0,y=f.length;y>w;w++)null!=u&&(S.index=u+w),(o=f[w]).trigger("add",o,this,S);(l||x&&x.length)&&this.trigger("sort",this,e)}return n?t[0]:t},reset:function(t,e){e||(e={});for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,r.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,r.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,r.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return a.apply(this.models,arguments)},get:function(t){if(null==t)return void 0;var e=this.modelId(this._isModel(t)?t.attributes:t);return this._byId[t]||this._byId[e]||this._byId[t.cid]},at:function(t){return 0>t&&(t+=this.length),this.models[t]},where:function(t,e){return r.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),r.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(r.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return r.invoke(this.models,"get",t)},fetch:function(t){t=t?r.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,n=this;return t.success=function(i){var r=t.reset?"reset":"set";n[r](i,t),e&&e(n,i,t),n.trigger("sync",n,i,t)},wrapError(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?r.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,i=e.success;return e.success=function(t,r){e.wait&&n.add(t,e),i&&i(t,r,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?r.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_isModel:function(t){return t instanceof o},_addReference:function(t){this._byId[t.cid]=t;var e=this.modelId(t.attributes);null!=e&&(this._byId[e]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){if("add"!==t&&"remove"!==t||n===this){if("destroy"===t&&this.remove(e,i),"change"===t){var r=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes);r!==o&&(null!=r&&delete this._byId[r],null!=o&&(this._byId[o]=e))}this.trigger.apply(this,arguments)}}});var c=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"];r.each(c,function(t){r[t]&&(l.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),r[t].apply(r,e)})});var d=["groupBy","countBy","sortBy","indexBy"];r.each(d,function(t){r[t]&&(l.prototype[t]=function(e,n){var i=r.isFunction(e)?e:function(t){return t.get(e)};return r[t](this.models,i,n)})}),l.extend=i,e.exports=l},{"./model":5,"backbone-events-standalone":7,"backbone-extend-standalone":8,underscore:66}],4:[function(t,e){e.exports.Model=t("./model"),e.exports.Collection=t("./collection"),e.exports.Events=t("backbone-events-standalone"),e.exports.extend=t("backbone-extend-standalone")},{"./collection":3,"./model":5,"backbone-events-standalone":7,"backbone-extend-standalone":8}],5:[function(t,e){var n=t("backbone-events-standalone"),i=t("backbone-extend-standalone"),r=t("underscore"),o=function(t,e){var n=t||{};e||(e={}),this.cid=r.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=r.defaults({},n,r.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};r.extend(o.prototype,n,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return r.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return r.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,o,s,a,l,h,u,c;if(null==t)return this;if("object"==typeof t?(o=t,n=e):(o={})[t]=e,n||(n={}),!this._validate(o,n))return!1;s=n.unset,l=n.silent,a=[],h=this._changing,this._changing=!0,h||(this._previousAttributes=r.clone(this.attributes),this.changed={}),c=this.attributes,u=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(i in o)e=o[i],r.isEqual(c[i],e)||a.push(i),r.isEqual(u[i],e)?delete this.changed[i]:this.changed[i]=e,s?delete c[i]:c[i]=e;if(!l){a.length&&(this._pending=n);for(var d=0,f=a.length;f>d;d++)this.trigger("change:"+a[d],this,c[a[d]],n)}if(h)return this;if(!l)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,r.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,r.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!r.isEmpty(this.changed):r.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?r.clone(this.changed):!1;var e,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var o in t)r.isEqual(i[o],e=t[o])||((n||(n={}))[o]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return r.clone(this._previousAttributes)},fetch:function(t){t=t?r.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(i){return e.set(e.parse(i,t),t)?(n&&n(e,i,t),e.trigger("sync",e,i,t),void 0):!1},wrapError(this,t),this.sync("read",this,t)},save:function(t,e,n){var i,o,s,a=this.attributes;if(null==t||"object"==typeof t?(i=t,n=e):(i={})[t]=e,n=r.extend({validate:!0},n),i&&!n.wait){if(!this.set(i,n))return!1}else if(!this._validate(i,n))return!1;i&&n.wait&&(this.attributes=r.extend({},a,i)),void 0===n.parse&&(n.parse=!0);var l=this,h=n.success;return n.success=function(t){l.attributes=a;var e=l.parse(t,n);return n.wait&&(e=r.extend(i||{},e)),r.isObject(e)&&!l.set(e,n)?!1:(h&&h(l,t,n),l.trigger("sync",l,t,n),void 0)},wrapError(this,n),o=this.isNew()?"create":n.patch?"patch":"update","patch"!==o||n.attrs||(n.attrs=i),s=this.sync(o,this,n),i&&n.wait&&(this.attributes=a),s},destroy:function(t){t=t?r.clone(t):{};var e=this,n=t.success,i=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};if(t.success=function(r){(t.wait||e.isNew())&&i(),n&&n(e,r,t),e.isNew()||e.trigger("sync",e,r,t)},this.isNew())return t.success(),!1;wrapError(this,t);var o=this.sync("delete",this,t);return t.wait||i(),o},url:function(){var t=r.result(this,"urlRoot")||r.result(this.collection,"url")||urlError();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},r.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=r.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,r.extend(e,{validationError:n})),!1):!0}});var s=["keys","values","pairs","invert","pick","omit","chain","isEmpty"];r.each(s,function(t){r[t]&&(o.prototype[t]=function(){var e=slice.call(arguments);return e.unshift(this.attributes),r[t].apply(r,e)})}),o.extend=i,e.exports=o},{"backbone-events-standalone":7,"backbone-extend-standalone":8,underscore:66}],6:[function(t,e,n){!function(){function t(){return{keys:Object.keys||function(t){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("keys() called on a non-object");var e,n=[];for(e in t)t.hasOwnProperty(e)&&(n[n.length]=e);return n},uniqueId:function(t){var e=++h+"";return t?t+e:e},has:function(t,e){return a.call(t,e)},each:function(t,e,n){if(null!=t)if(s&&t.forEach===s)t.forEach(e,n);else if(t.length===+t.length){for(var i=0,r=t.length;r>i;i++)if(e.call(n,t[i],i,t)===o)return}else for(var a in t)if(this.has(t,a)&&e.call(n,t[a],a,t)===o)return},once:function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}}}}var i,r=this,o={},s=Array.prototype.forEach,a=Object.prototype.hasOwnProperty,l=Array.prototype.slice,h=0,u=t();i={on:function(t,e,n){if(!d(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!d(this,"once",t,[e,n])||!e)return this;var i=this,r=u.once(function(){i.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,n)},off:function(t,e,n){var i,r,o,s,a,l,h,c;if(!this._events||!d(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(s=t?[t]:u.keys(this._events),a=0,l=s.length;l>a;a++)if(t=s[a],o=this._events[t]){if(this._events[t]=i=[],e||n)for(h=0,c=o.length;c>h;h++)r=o[h],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=l.call(arguments,1);if(!d(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&f(n,e),i&&f(i,arguments),this},stopListening:function(t,e,n){var i=this._listeners;if(!i)return this;var r=!e&&!n;"object"==typeof e&&(n=this),t&&((i={})[t._listenerId]=t);for(var o in i)i[o].off(e,n,this),r&&delete this._listeners[o];return this}};var c=/\s+/,d=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(c.test(n)){for(var o=n.split(c),s=0,a=o.length;a>s;s++)t[e].apply(t,[o[s]].concat(i));return!1}return!0},f=function(t,e){var n,i=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s,a);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e)}},g={listenTo:"on",listenToOnce:"once"};u.each(g,function(t,e){i[e]=function(e,n,i){var r=this._listeners||(this._listeners={}),o=e._listenerId||(e._listenerId=u.uniqueId("l"));return r[o]=e,"object"==typeof n&&(i=this),e[t](n,i,this),this}}),i.bind=i.on,i.unbind=i.off,i.mixin=function(t){var e=["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"];return u.each(e,function(e){t[e]=this[e]},this),t},"function"==typeof define?define(function(){return i}):"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=i),n.BackboneEvents=i):r.BackboneEvents=i}(this)},{}],7:[function(t,e){e.exports=t("./backbone-events-standalone")},{"./backbone-events-standalone":6}],8:[function(t,e,n){!function(t){"object"==typeof n?e.exports=t():"function"==typeof define&&define.amd?define(t):window.BackboneExtend=t()}(function(){"use strict";var t={has:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},extend:function(t){for(var e=1;e<arguments.length;++e){var n=arguments[e];if(n)for(var i in n)t[i]=n[i]}return t}},e=function(e,n){var i,r=this;i=e&&t.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},t.extend(i,r,n);var o=function(){this.constructor=i};return o.prototype=r.prototype,i.prototype=new o,e&&t.extend(i.prototype,e),i.__super__=r.prototype,i};return e})},{}],9:[function(t,e){var n=t("underscore"),i=t("backbone-events-standalone"),r=t("backbone-extend-standalone"),o=t("jbone"),s=function(t){this.cid=n.uniqueId("view"),t||(t={}),n.extend(this,n.pick(t,l)),this._ensureElement(),this.initialize.apply(this,arguments)},a=/^(\S+)\s*(.*)$/,l=["model","collection","el","id","attributes","className","tagName","events"];n.extend(s.prototype,i,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof o?t:o(t),this.el=this.$el[0]},delegateEvents:function(t){if(!t&&!(t=n.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(n.isFunction(i)||(i=this[t[e]]),i){var r=e.match(a);this.delegate(r[1],r[2],n.bind(i,this))}}return this},delegate:function(t,e,n){this.$el.on(t+".delegateEvents"+this.cid,e,n)},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){this.$el.off(t+".delegateEvents"+this.cid,e,n)},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t["class"]=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),s.extend=r,e.exports=s},{"backbone-events-standalone":11,"backbone-extend-standalone":12,jbone:42,underscore:66}],10:[function(t,e,n){arguments[4][6][0].apply(n,arguments)},{dup:6}],11:[function(t,e,n){arguments[4][7][0].apply(n,arguments)},{"./backbone-events-standalone":10,dup:7}],12:[function(t,e,n){arguments[4][8][0].apply(n,arguments)},{dup:8}],13:[function(t,e){var n=t("backbone-events-standalone");n.onAll=function(t,e){return this.on("all",t,e),this},n.oldMixin=n.mixin,n.mixin=function(t){n.oldMixin(t);for(var e=["onAll"],i=0;i<e.length;i++){var r=e[i];t[r]=this[r]}return t},e.exports=n},{"backbone-events-standalone":15}],14:[function(t,e,n){arguments[4][6][0].apply(n,arguments)},{dup:6}],15:[function(t,e,n){arguments[4][7][0].apply(n,arguments)},{"./backbone-events-standalone":14,dup:7}],16:[function(t,e){var n,i;i=t("xhr"),e.exports=n=function(){function t(){}return t.read=function(t,e){var n;return n=function(t){return function(n,i,r){return t._onRetrieval(r,e)}}(this),i(t,n)},t._onRetrieval=function(t,e){var n;return n=this.parse(t),e(n)},t}()},{xhr:"xhr"}],17:[function(t,e){var n,i;i=t("xhr"),e.exports=n=function(){function t(){}return t.read=function(t,e){var n;return n=function(t){return function(n,i,r){return t._onRetrieval(r,e)}}(this),i(t,n)},t._onRetrieval=function(t,e){var n;return n=this.parse(t),e(n)},t}()},{xhr:"xhr"}],18:[function(t,e){var n,i,r,o=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;i=t("./generic_reader"),r=t("msa-seqtools"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.parse=function(t){var e,n,i,o,s,a,l,h;if(a=[],!t||0===t.length)return[];for("[object Array]"!==Object.prototype.toString.call(t)&&(t=t.split("\n")),l=0,h=t.length;h>l;l++)o=t[l],">"===o[0]||";"===o[0]?(i=o.slice(1),s=r.getMeta(i),i=s.name,e=new r.model("",i,a.length),e.ids=s.ids||{},n=Object.keys(e.ids),n.length>0&&(e.id=e.ids[n[0]]),e.details=s.details||{},a.push(e)):e.seq+=o;return a},e.write=function(t,e){var n,i,o,s;for(i="",o=0,s=t.length;s>o;o++)n=t[o],null!=e&&(n=e(n)),i+=">"+n.name+"\n",i+=r.splitNChars(n.seq,80).join("\n"),i+="\n";return i},e}(i)},{"./generic_reader":17,"msa-seqtools":64}],19:[function(t,e){var n={};e.exports=n;var i=t("./utils");n.readHeader=function(t){for(var e,i={},r=0,o=[];r<t.length;r++){var s=t[r];if(s.indexOf("#")>=0)break;var a=s.split(/\t/),l=a[0].trim();if("GFF"===l)break;if(2===a.length)if("startgroup"===l)e=a[1].trim();else{if("endgroup"===l){e="";continue}i[a[0]]=n.parseColor(a[1])}else if(a.length>=5){var h=n.parseLine(a);e&&(h.attributes.Parent=e),o.push(h)}}return{offset:r,colors:i,features:o}},n.parseColor=function(t){return t.indexOf(",")>=0?i.rgbToHex(t.split(",").map(function(t){return parseInt(t)})):6===t.length&&parseInt(t.charAt(0),16)<=16&&"bisque"!==t?"#"+t:t},n.parseLine=function(t){var e={attributes:{}};return e.attributes.Name=t[0].trim(),e.seqname=t[1].trim(),e.start=parseInt(t[3]),e.end=parseInt(t[4]),e.feature=t[5].trim(),"ID_NOT_SPECIFIED"===e.seqname&&(e.seqname=t[2].trim()),e}},{"./utils":20}],20:[function(t,e){function n(t){var e=t.toString(16);return 1===e.length?"0"+e:e}var i={};e.exports=i,i.extractKeys=function(t){var e={},n=t.split(";");return n.forEach(function(t){var n,i,r;t.indexOf("=")>0?(n=t.split("="),i=n[0],r=n[1],e[i]=r):t.indexOf(" ")>0&&(n=t.split(" "),i=n[0],r=n[1].replace(/"/g,""),e[i]=r)}),e},i.rgbToHex=function(t,e,r){return 3===t.length?i.rgbToHex(t[0],t[1],t[2]):"#"+n(t)+n(e)+n(r)}},{}],21:[function(t,e){e.exports.seq=t("./seq")},{"./seq":22}],22:[function(t,e){e.exports=function(t,e,n){this.seq=t,this.name=e,this.id=n,this.meta={}}},{}],23:[function(t,e){e.exports=t("./src/index.js")},{"./src/index.js":29}],24:[function(t,e){e.exports={render_x_axis_label:function(){var t="Model Position";this.display_ali_map&&(t="Alignment Column"),this.called_on.find(".logo_xaxis").remove(),this.called_on.prepend('<div class="logo_xaxis" class="centered" style="margin-left:40px"><p class="xaxis_text" style="width:10em;margin:1em auto">'+t+"</p></div>")},render_y_axis_label:function(){this.dom_element.parent().before('<canvas class="logo_yaxis" height="'+this.options.height+'" width="55"></canvas>');var t=this.called_on.find(".logo_yaxis"),e=(Math.abs(this.data.max_height),isNaN(this.data.min_height_obs)?0:parseInt(this.data.min_height_obs,10),null),n="Information Content (bits)";e=t[0].getContext("2d"),e.beginPath(),e.moveTo(55,1),e.lineTo(40,1),e.moveTo(55,this.info_content_height),e.lineTo(40,this.info_content_height),e.moveTo(55,this.info_content_height/2),e.lineTo(40,this.info_content_height/2),e.lineWidth=1,e.strokeStyle="#666666",e.stroke(),e.fillStyle="#666666",e.textAlign="right",e.font="bold 10px Arial",e.textBaseline="top",e.fillText(parseFloat(this.data.max_height).toFixed(1),38,0),e.textBaseline="middle",e.fillText(parseFloat(this.data.max_height/2).toFixed(1),38,this.info_content_height/2),e.fillText("0",38,this.info_content_height),"score"===this.data.height_calc&&(n="Score (bits)"),e.save(),e.translate(5,this.height/2-20),e.rotate(-Math.PI/2),e.textAlign="center",e.font="normal 12px Arial",e.fillText(n,1,0),e.restore(),e.fillText("occupancy",55,this.info_content_height+7),this.show_inserts&&(e.fillText("ins. prob.",50,280),e.fillText("ins. len.",46,296))}}},{}],25:[function(t,e){var n=null;e.exports=function(){if(!n){var t=document.createElement("canvas");n=!(!t.getContext||!t.getContext("2d"))}return n}},{}],26:[function(t,e){e.exports={A:"#FF9966",C:"#009999",D:"#FF0000",E:"#CC0033",F:"#00FF00",G:"#f2f20c",H:"#660033",I:"#CC9933",K:"#663300",L:"#FF9933",M:"#CC99CC",N:"#336666",P:"#0099FF",Q:"#6666CC",R:"#990000",S:"#0000FF",T:"#00FFFF",V:"#FFCC33",W:"#66CC66",Y:"#006600"}},{}],27:[function(t,e){e.exports={A:"#cbf751",C:"#5ec0cc",G:"#ffdf59",T:"#b51f16",U:"#b51f16"}},{}],28:[function(t,e){var n=t("jbone");e.exports=function(t,e,i){t.find(".logo_settings_switch, .logo_settings .close").on("click",function(t){t.preventDefault(),n(".logo_settings").toggle()}),t.find(".logo_reset").on("click",function(t){t.preventDefault(),e.changeZoom({target:e.default_zoom})}),t.find(".logo_change").on("click",function(t){t.preventDefault()}),t.find(".logo_zoomin").on("click",function(t){t.preventDefault(),e.changeZoom({distance:.1,direction:"+"})}),t.find(".logo_zoomout").on("click",function(t){t.preventDefault(),e.changeZoom({distance:.1,direction:"-"})}),t.find(".logo_scale").on("change",function(){e.toggleScale(this.value)}),t.find(".logo_color").on("change",function(){e.toggleColorscheme(this.value)}),t.find(".logo_ali_map").on("change",function(){e.toggleAliMap(this.value)}),t.find(".logo_position").on("change",function(){this.value.match(/^\d+$/m)&&e.scrollToColumn(this.value,1)}),i.on("dblclick",function(n){console.log("dblclick",e),offset=e.logo_graphic.offset(),x=parseInt(n.pageX-offset.left,10),window_position=n.pageX-t.parent().offset().left,col=e.columnFromCoordinates(x),console.log("col",col),current=e.zoom,1>current?e.changeZoom({target:1,offset:window_position,column:col}):e.changeZoom({target:.3,offset:window_position,column:col})}),n(document).on(t.attr("id")+".scrolledTo",function(t,n){e.render({target:n})}),n(document).on("keydown",function(t){t.ctrlKey||((61===t.which||107===t.which)&&(zoom+=.1,e.changeZoom({distance:.1,direction:"+"})),(109===t.which||0===t.which)&&(zoom-=.1,e.changeZoom({distance:.1,direction:"-"})))})}},{jbone:42}],29:[function(t,e){_=t("underscore");var n=t("./canvasSupport.js"),i=t("./render/render.js"),r=t("./model/letter.js"),o=t("backbone-viewj"),s=t("./axis"),a=t("./eventListener.js"),l=t("./info/settings.js"),h=t("jbone");e.exports=o.extend({options:{xaxis:!0,yaxis:!0,height:300,column_width:34,debug:!0,scale_height_enabled:!0,scaled_max:!0,zoom_buttons:!0,colorscheme:"default",data:void 0,start:1,end:void 0,zoom:.4,colors:void 0,divider:!1,show_probs:!1,divider_step:5,show_divider:!1,border:!1,settings:!1,scroller:!0,positionMarker:!0},loadDefault:function(e){this.data=e.data,this.display_ali_map=0,this.alphabet=e.data.alphabet||"dna",this.start=e.start,this.zoom=parseFloat(e.zoom)||.4,this.default_zoom=this.zoom,this.column_width=e.column_width,this.height=e.height,this.canvas_width=5e3,this.scale_height_enabled=e.scale_height_enabled,this.scrollme=null,this.previous_target=0,this.rendered=[],this.previous_zoom=0,void 0==this.data.max_height&&(this.data.max_height=this.calcMaxHeight(this.data.heightArr)),this.data.insert_probs&&this.data.delete_probs||(this.options.show_probs=!1),this.data.max_height=e.scaled_max?e.data.max_height_obs||this.data.max_height||2:e.data.max_height_theory||this.data.max_height||2,e.colors?this.changeColors(e.colors):"aa"===this.alphabet?(this.aa_colors=t("./colors/aa.js"),this.changeColors(this.aa_colors)):(this.dna_colors=t("./colors/dna.js"),this.changeColors(this.dna_colors))},initialize:function(t){if(!n())return this.el.textContent="Your browser doesn't support canvas.",void 0;void 0==t.data&&(this.el.textContent="No data added."),_.extend(this.options,t);var e=this.options;if(this.loadDefault(e),this.options.show_probs?this.data.processing&&/^observed|weighted/.test(this.data.processing)?(this.show_inserts=0,this.info_content_height=this.height-14):(this.show_inserts=1,this.info_content_height=this.height-44):this.info_content_height=this.height,this.$el=h(this.el),this.initDivs(),this.options.settings){var i=l(this,e);this.$el.append(i)}a(this.$el,this,this.logo_graphic)},initDivs:function(){var t=u("div");t.className="logo_graphic",this.logo_graphic=h(t);var e=u("div");if(e.className="logo_container",e.style.height=this.height,this.container=h(e),this.container.append(t),this.$el.append(e),this.options.divider){var n=u("div");n.className="logo_divider",this.$el.append(n)}this.dom_element=h(t),this.called_on=this.$el,this.options.xaxis&&s.render_x_axis_label.call(this),this.options.yaxis?s.render_y_axis_label.call(this):this.container[0].style.marginLeft="0px"},render:function(){return i.call(this),this},changeColors:function(t){this.colors=t;var e=void 0!=t&&void 0!=t.type;e&&(this.colorscheme="dynamic"),this.buildAlphabet()},buildAlphabet:function(){this.letters={};var t=this.colors;if("dynamic"==this.colorscheme){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");t={},e.forEach(function(e){t[e]=""})}for(var n in t)if(t.hasOwnProperty(n)){var i={color:t[n]};this.letters[n]=new r(n,i)}},toggleColorscheme:function(t){var e=this.currentColumn();this.colorscheme=t?"default"===t?"default":"consensus":"default"===this.colorscheme?"consensus":"default",this.rendered=[],this.scrollme.reflow(),this.scrollToColumn(e+1),this.scrollToColumn(e)
},toggleScale:function(t){var e=this.currentColumn();this.data.max_height=t?"obs"===t?this.data.max_height_obs:this.data.max_height_theory:this.data.max_height===this.data.max_height_obs?this.data.max_height_theory:this.data.max_height_obs,this.rendered=[],this.logoYAxis&&this.logoYAxis.remove(),s.render_y_axis_label.call(this),this.scrollme.reflow(),this.scrollToColumn(e+1),this.scrollToColumn(e)},toggleAliMap:function(t){var e=this.currentColumn();this.display_ali_map=t?"model"===t?0:1:1===this.display_ali_map?0:1,s.render_x_axis_label(this),this.rendered=[],this.scrollme.reflow(),this.scrollToColumn(e+1),this.scrollToColumn(e)},currentColumn:function(){var t=this.scrollme.scroller.getValues().left,e=this.column_width*this.zoom,n=t/e,i=this.container.width()/e/2,r=Math.ceil(n+i);return r},changeZoom:function(t){var e=.3,n=null;if(t.target?e=t.target:t.distance&&(e=(parseFloat(this.zoom)-parseFloat(t.distance)).toFixed(1),"+"===t.direction&&(e=(parseFloat(this.zoom)+parseFloat(t.distance)).toFixed(1))),e>1?e=1:.1>e&&(e=.1),n=this.logo_graphic.width()*e/this.zoom,n>this.container.width())if(t.column){this.zoom=e,this.render({zoom:this.zoom}),this.scrollme.reflow();var i=this.coordinatesFromColumn(t.column);this.scrollme.scroller.scrollTo(i-t.offset)}else{var r=this.currentColumn();this.zoom=e,this.render({zoom:this.zoom}),this.scrollme.reflow(),this.scrollToColumn(r)}return this.zoom},columnFromCoordinates:function(t){var e=Math.ceil(t/(this.column_width*this.zoom));return e},coordinatesFromColumn:function(t){var e=t-1,n=e*this.column_width*this.zoom+this.column_width*this.zoom/2;return n},scrollToColumn:function(t,e){var n=this.logo_container.width()/2,i=this.coordinatesFromColumn(t);this.scrollme.scroller.scrollTo(i-n,0,e)},calcMaxHeight:function(t){return t.reduce(function(t,e){var n=0;for(var i in e)n+=e[i];return n>t?n:t},0)}});var u=function(t){return document.createElement(t)}},{"./axis":24,"./canvasSupport.js":25,"./colors/aa.js":26,"./colors/dna.js":27,"./eventListener.js":28,"./info/settings.js":30,"./model/letter.js":31,"./render/render.js":35,"backbone-viewj":9,jbone:42,underscore:66}],30:[function(t,e){var n=t("jbone");e.exports=function(t,e){var i=n('<form class="logo_form"><fieldset><label for="position">Column number</label><input type="text" name="position" class="logo_position"></input><button class="button logo_change">Go</button></fieldset></form>'),r=n('<div class="logo_settings"></div>');if(r.append('<span class="close">x</span>'),t.scale_height_enabled&&t.data.max_height_obs<t.data.max_height_theory){var o="",s="",a="",l="";t.data.max_height_obs===t.data.max_height?o="checked":s="checked"}var h='<fieldset><legend>Scale</legend><label><input type="radio" name="scale" class="logo_scale" value="obs" '+o+"/>Maximum Observed "+l+'</label></br><label><input type="radio" name="scale" class="logo_scale" value="theory" '+s+"/>Maximum Theoretical "+a+"</label></fieldset>";if(r.append(h),"score"!==t.data.height_calc&&"aa"===t.data.alphabet&&t.data.probs_arr){var u=null,c=null,d="",f="";"default"===t.colorscheme?u="checked":c="checked",e.help&&(d='<a class="help" href="/help#colors_default" title="Each letter receives its own color."><span aria-hidden="true" data-icon="?"></span><span class="reader-text">help</span></a>',f='<a class="help" href="/help#colors_consensus" title="Letters are colored as in Clustalx and Jalview, with colors depending on composition of the column."><span aria-hidden="true" data-icon="?"></span><span class="reader-text">help</span></a>');var g='<fieldset><legend>Color Scheme</legend><label><input type="radio" name="color" class="logo_color" value="default" '+u+"/>Default "+d+'</label></br><label><input type="radio" name="color" class="logo_color" value="consensus" '+c+"/>Consensus Colors "+f+"</label></fieldset>";r.append(g)}if(t.data.ali_map){var m=null,p=null,v="",b="";0===t.display_ali_map?m="checked":p="checked",e.help&&(v='<a class="help" href="/help#coords_model" title="The coordinates along the top of the plot show the model position."><span aria-hidden="true" data-icon="?"></span><span class="reader-text">help</span></a>',b='<a class="help" href="/help#coords_ali" title="The coordinates along the top of the plot show the column in the alignment associated with the model"><span aria-hidden="true" data-icon="?"></span><span class="reader-text">help</span></a>');var x='<fieldset><legend>Coordinates</legend><label><input type="radio" name="coords" class="logo_ali_map" value="model" '+m+"/>Model "+v+'</label></br><label><input type="radio" name="coords" class="logo_ali_map" value="alignment" '+p+"/>Alignment "+b+"</label></fieldset>";r.append(x)}var w=n('<div class="logo_controls"></div>');return t.zoom_enabled&&w.append('<button class="logo_zoomout button">-</button><button class="logo_zoomin button">+</button>'),r.children().length>0&&(w.append('<button class="logo_settings_switch button">Settings</button>'),w.append(r)),i.append(w),i}},{jbone:42}],31:[function(t,e){e.exports=function(t,e){e=e||{},this.value=t,this.width=parseInt(e.width,10)||100,"W"===this.value&&(this.width+=30*this.width/100),this.height=parseInt(e.height,10)||100,this.color=e.color||"#000000",this.fontSize=e.fontSize||138,this.scaled=function(){},this.draw=function(t,e,n,i,r,o){var s=e/this.height,a=n/this.width,l=t.font;t.transform(a,0,0,s,i,r),t.fillStyle=o||this.color,t.textAlign="center",t.font="bold "+this.fontSize+"px Arial",t.fillText(this.value,0,0),t.setTransform(1,0,0,1,0,0),t.fillStyle="#000000",t.font=l}}},{}],32:[function(t,e){e.exports=function(t,e,n){t.beginPath(),t.moveTo(0,e),t.lineTo(n,e),t.lineWidth=1,t.strokeStyle="#999999",t.stroke()}},{}],33:[function(t,e){e.exports=function(t,e,n,i,r,o,s){t.font=o+"px Arial",t.textAlign=s?"right":"center",t.fillStyle="#666666",t.fillText(r,e+i/2,n)}},{}],34:[function(t,e){e.exports=function(t,e,n,i,r){r=r||"#999999",t.beginPath(),t.moveTo(e,n),t.lineTo(e,n+i),t.lineWidth=1,t.strokeStyle=r,t.stroke()}},{}],35:[function(t,e){function n(t,e,n,i,r){var s=o(t).find("#canv_"+i);return s.length||(o(t).append('<canvas class="canvas_logo" id="canv_'+i+'"  height="'+e+'" width="'+n+'" style="left:'+r*i+'px"></canvas>'),s=o(t).find("#canv_"+i)),o(s).attr("width",n).attr("height",e),s[0]}var i=t("./render_with_text.js"),r=t("./render_with_rects.js"),o=t("jbone");e.exports=function(t){if(this.data){t=t||{};var e=t.zoom||this.zoom,o=t.target||1,s=(t.scaled||null,this.dom_element.parent().attr("width")),a=1,l=null,h=null,u=0;if(this.previous_target=o,t.start&&(this.start=t.start),t.end&&(this.end=t.end),.1>=e?e=.1:e>=1&&(e=1),this.zoom=e,l=this.end||this.data.heightArr.length,h=this.start||1,l=l>this.data.heightArr.length?this.data.heightArr.length:l,l=h>l?h:l,h=h>l?l:h,h=h>1?h:1,this.y=this.height-20,this.max_width=this.column_width*(l-h+1),s>this.max_width&&(e=1,this.zoom_enabled=!1),this.zoom=e,this.zoomed_column=this.column_width*e,this.total_width=this.zoomed_column*(l-h+1),1>e)for(;this.total_width<s&&(this.zoom+=.1,this.zoomed_column=this.column_width*this.zoom,this.total_width=this.zoomed_column*(l-h+1),this.zoom_enabled=!1,!(e>=1)););o>this.total_width&&(o=this.total_width),this.dom_element.attr({width:this.total_width+"px"}).css({width:this.total_width+"px"}),this.canvas_width=this.total_width;var c=Math.ceil(this.total_width/this.canvas_width);for(this.columns_per_canvas=Math.ceil(this.canvas_width/this.zoomed_column),this.previous_zoom!==this.zoom&&(this.dom_element.find("canvas").remove(),this.previous_zoom=this.zoom,this.rendered=[]),this.canvases=[],this.contexts=[],u=0;c>u;u++){var d=this.columns_per_canvas*u+h,f=d+this.columns_per_canvas-1;f>l&&(f=l);var g=(f-d+1)*this.zoomed_column;g>a&&(a=g);var m=a*u,p=m+g;if(p+p/2>o&&o>m-m/2)if(this.canvases[u]=n(this.dom_element,this.height,g,u,a),this.contexts[u]=this.canvases[u].getContext("2d"),this.contexts[u].setTransform(1,0,0,1,0,0),this.contexts[u].clearRect(0,0,g,this.height),this.contexts[u].fillStyle="#ffffff",this.contexts[u].fillRect(0,0,p,this.height),this.zoomed_column>12){var v=parseInt(10*e,10);v=v>10?10:v,this.debug&&r.call(this,d,f,u,1),i.call(this,d,f,u,v)}else r.call(this,d,f,u)}!this.scrollme&&this.options.scroller&&(this.scrollme=new EasyScroller(this.dom_element[0],{scrollingX:1,scrollingY:0,eventTarget:this.called_on})),1!==o&&this.scrollme.reflow()}}},{"./render_with_rects.js":36,"./render_with_text.js":37,jbone:42}],36:[function(t,e){function n(t,e,n,i,r,o,s,a){var l="#ffffff";a?(r>.1?l="#d7301f":r>.05?l="#fc8d59":r>.03&&(l="#fdcc8a"),t.fillStyle=l,t.fillRect(e,n+15,i,10),l="#ffffff",o>9?l="#d7301f":o>7?l="#fc8d59":o>4&&(l="#fdcc8a"),t.fillStyle=l,t.fillRect(e,n+30,i,10)):n+=30,l="#ffffff",.75>s?l="#2171b5":.85>s?l="#6baed6":.95>s&&(l="#bdd7e7"),t.fillStyle=l,t.fillRect(e,n,i,10)}var i=t("./draw/border.js"),r=t("./draw/ticks.js"),o=t("./draw/column_number.js");e.exports=function(t,e,s,a){var l=0,h=t,u=null,c=0,d=Math.abs(this.data.max_height),f=Math.abs(this.data.min_height_obs),g=d+f,m=Math.round(100*Math.abs(this.data.max_height)/g),p=Math.round(this.info_content_height*m/100),v=(this.info_content_height-p,10);for(c=t;e>=c;c++){if(this.data.mmline&&1===this.data.mmline[c-1])this.contexts[s].fillStyle="#cccccc",this.contexts[s].fillRect(l,10,this.zoomed_column,this.height-40);else{var b=this.data.heightArr[c-1],x=0,w=(b.length,0);for(var w in b)if(values=[w,b[w]],values[1]>.01){var y=parseFloat(values[1])/this.data.max_height,_=l,S=(this.info_content_height-2)*y,k=this.info_content_height-2-x-S,C=null;C="dynamic"===this.colorscheme?this.colors.getColor(values[0],{pos:c-1}):"consensus"===this.colorscheme?this.cmap[c-1][values[0]]||"#7a7a7a":this.colors[values[0]],a?(this.contexts[s].strokeStyle=C,this.contexts[s].strokeRect(_,k,this.zoomed_column,S)):(this.contexts[s].fillStyle=C,this.contexts[s].fillRect(_,k,this.zoomed_column,S)),x+=S}}this.zoom<.2?v=20:this.zoom<.3&&(v=10),this.options.positionMarker&&c%v===0&&(this.options.show_probs&&r(this.contexts[s],l+this.zoomed_column,this.height-30,parseFloat(this.height),"#dddddd"),r(this.contexts[s],l+this.zoomed_column,0,5),u=this.display_ali_map?this.data.ali_map[c-1]:h,o(this.contexts[s],l-2,10,this.zoomed_column,u,10,!0)),this.options.show_probs&&n(this.contexts[s],l,this.height-42,this.zoomed_column,this.data.insert_probs[c-1],this.data.insert_lengths[c-1],this.data.delete_probs[c-1],this.show_inserts),this.options.show_probs&&(this.show_inserts?i(this.contexts[s],this.height-45,this.total_width):i(this.contexts[s],this.height-15,this.total_width)),this.options.border&&i(this.contexts[s],0,this.total_width),l+=this.zoomed_column,h++}}},{"./draw/border.js":32,"./draw/column_number.js":33,"./draw/ticks.js":34}],37:[function(t,e){function n(t,e,n,r,o,s,a){var l=n-4,h="#ffffff",u="#555555";a&&(l=n-35),.75>o?(h="#2171b5",u="#ffffff"):.85>o?h="#6baed6":.95>o&&(h="#bdd7e7"),i(t,e,l,o,s,r,h,u)}function i(t,e,n,i,r,o,s,a){t.font=r+"px Arial",t.fillStyle=s,t.fillRect(e,n-10,o,14),t.textAlign="center",t.fillStyle=a,t.fillText(i,e+o/2,n)}function r(t,e){var n=e.ralign?e.x+t.zoomed_column:e.x,i=e.ralign?e.x+2:e.x;l(t.contexts[e.context_num],n,t.height-30,-30-t.height,"#dddddd"),l(t.contexts[e.context_num],n,0,5),h(t.contexts[e.context_num],i,10,t.zoomed_column,e.column_num,e.fontsize,e.ralign)}function o(t,e,n,r,o,s){var a=n-20,h="#ffffff",u="#555555";o>.1?(h="#d7301f",u="#ffffff"):o>.05?h="#fc8d59":o>.03&&(h="#fdcc8a"),i(t,e,a,o,s,r,h,u),o>.03&&l(t,e+r,n-30,-30-n,h)}function s(t,e,n,r,o,s){var a="#ffffff",l="#555555";o>9?(a="#d7301f",l="#ffffff"):o>7?a="#fc8d59":o>4&&(a="#fdcc8a"),i(t,e,n,o,s,r,a,l)}var a=t("./draw/border.js"),l=t("./draw/ticks.js"),h=t("./draw/column_number.js");e.exports=function(t,e,i,h){{var u=0,c=t,d=null,f=0,g=Math.abs(this.data.max_height),m=isNaN(this.data.min_height_obs)?0:parseInt(this.data.min_height_obs,10),p=g+Math.abs(m),v=Math.round(100*Math.abs(this.data.max_height)/p),b=Math.round(this.info_content_height*v/100),x=this.info_content_height-b;b/this.info_content_height,x/this.info_content_height}for(e+3<=this.end&&(e+=3),f=t;e>=f;f++){if(this.data.mmline&&1===this.data.mmline[f-1])this.contexts[i].fillStyle="#cccccc",this.contexts[i].fillRect(u,10,this.zoomed_column,this.height-40);else{var w=this.data.heightArr[f-1],y=[];if(w){var _=0,S=(w.length,0),k=null;for(var S in w){var C=w[S],z=[S,C];if(x_pos=u+this.zoomed_column/2,letter_height=null,z[1]>.01){letter_height=parseFloat(z[1])/this.data.max_height;var j=this.info_content_height-2-_,E=(this.info_content_height-2)*letter_height;y[S]=[E,this.zoomed_column,x_pos,j],_+=E}}for(var S in w)y[S]&&this.letters[S]&&(k="dynamic"===this.colorscheme?this.colors.getColor(S,{pos:f-1}):"consensus"===this.colorscheme?this.cmap[f-1][S]||"#7a7a7a":null,this.letters[S].draw(this.contexts[i],y[S][0],y[S][1],y[S][2],y[S][3],k))}}d=this.display_ali_map?this.data.ali_map[f-1]:c,this.options.show_divider&&(this.zoom<.7?f%this.options.divider_step===0&&r(this,{context_num:i,x:u,fontsize:10,column_num:d,ralign:!0}):r(this,{context_num:i,x:u,fontsize:h,column_num:d})),this.options.show_probs&&(n(this.contexts[i],u,this.height,this.zoomed_column,this.data.delete_probs[f-1],h,this.show_inserts),l(this.contexts[i],u,this.height-15,5),this.show_inserts&&(o(this.contexts[i],u,this.height,this.zoomed_column,this.data.insert_probs[f-1],h),s(this.contexts[i],u,this.height-5,this.zoomed_column,this.data.insert_lengths[f-1],h),l(this.contexts[i],u,this.height-45,5),l(this.contexts[i],u,this.height-30,5))),u+=this.zoomed_column,c++}this.options.show_probs&&(this.show_inserts&&(a(this.contexts[i],this.height-30,this.total_width),a(this.contexts[i],this.height-45,this.total_width)),a(this.contexts[i],this.height-15,this.total_width)),this.options.border&&a(this.contexts[i],0,this.total_width)}},{"./draw/border.js":32,"./draw/column_number.js":33,"./draw/ticks.js":34}],38:[function(t,e){var n=window.HTMLCanvasElement&&window.HTMLCanvasElement.prototype,i=window.Blob&&function(){try{return Boolean(new Blob)}catch(t){return!1}}(),r=i&&window.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(t){return!1}}(),o=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,s=(i||o)&&window.atob&&window.ArrayBuffer&&window.Uint8Array&&function(t){var e,n,s,a,l,h;for(e=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):decodeURIComponent(t.split(",")[1]),n=new ArrayBuffer(e.length),s=new Uint8Array(n),a=0;a<e.length;a+=1)s[a]=e.charCodeAt(a);return l=t.split(",")[0].split(":")[1].split(";")[0],i?new Blob([r?s:n],{type:l}):(h=new o,h.append(n),h.getBlob(l))};window.HTMLCanvasElement&&!n.toBlob&&(n.mozGetAsFile?n.toBlob=function(t,e,i){i&&n.toDataURL&&s?t(s(this.toDataURL(e,i))):t(this.mozGetAsFile("blob",e))}:n.toDataURL&&s&&(n.toBlob=function(t,e,n){t(s(this.toDataURL(e,n)))})),e.exports=s},{}],39:[function(t,e){var n=n||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(t){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var e=t.document,n=function(){return t.URL||t.webkitURL||t},i=e.createElementNS("http://www.w3.org/1999/xhtml","a"),r=!t.externalHost&&"download"in i,o=function(n){var i=e.createEvent("MouseEvents");i.initMouseEvent("click",!0,!1,t,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(i)},s=t.webkitRequestFileSystem,a=t.requestFileSystem||s||t.mozRequestFileSystem,l=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},h="application/octet-stream",u=0,c=[],d=function(){for(var t=c.length;t--;){var e=c[t];"string"==typeof e?n().revokeObjectURL(e):e.remove()}c.length=0},f=function(t,e,n){e=[].concat(e);for(var i=e.length;i--;){var r=t["on"+e[i]];if("function"==typeof r)try{r.call(t,n||t)}catch(o){l(o)}}},g=function(e,l){var d,g,m,p=this,v=e.type,b=!1,x=function(){var t=n().createObjectURL(e);return c.push(t),t},w=function(){f(p,"writestart progress write writeend".split(" "))},y=function(){(b||!d)&&(d=x(e)),g?g.location.href=d:window.open(d,"_blank"),p.readyState=p.DONE,w()},_=function(t){return function(){return p.readyState!==p.DONE?t.apply(this,arguments):void 0}},S={create:!0,exclusive:!1};return p.readyState=p.INIT,l||(l="download"),r?(d=x(e),i.href=d,i.download=l,o(i),p.readyState=p.DONE,w(),void 0):(t.chrome&&v&&v!==h&&(m=e.slice||e.webkitSlice,e=m.call(e,0,e.size,h),b=!0),s&&"download"!==l&&(l+=".download"),(v===h||s)&&(g=t),a?(u+=e.size,a(t.TEMPORARY,u,_(function(t){t.root.getDirectory("saved",S,_(function(t){var n=function(){t.getFile(l,S,_(function(t){t.createWriter(_(function(n){n.onwriteend=function(e){g.location.href=t.toURL(),c.push(t),p.readyState=p.DONE,f(p,"writeend",e)},n.onerror=function(){var t=n.error;t.code!==t.ABORT_ERR&&y()},"writestart progress write abort".split(" ").forEach(function(t){n["on"+t]=p["on"+t]}),n.write(e),p.abort=function(){n.abort(),p.readyState=p.DONE},p.readyState=p.WRITING}),y)}),y)};t.getFile(l,{create:!1},_(function(t){t.remove(),n()}),_(function(t){t.code===t.NOT_FOUND_ERR?n():y()}))}),y)}),y),void 0):(y(),void 0))},m=g.prototype,p=function(t,e){return new g(t,e)};return m.abort=function(){var t=this;t.readyState=t.DONE,f(t,"abort")},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,t.addEventListener("unload",d,!1),p.unload=function(){d(),t.removeEventListener("unload",d,!1)},p}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);amdDefine=window.define,"undefined"==typeof amdDefine&&"undefined"!=typeof window.almond&&"define"in window.almond&&(amdDefine=window.almond.define),"undefined"!=typeof e&&null!==e?e.exports=n:"undefined"!=typeof amdDefine&&null!==amdDefine&&null!=amdDefine.amd&&amdDefine("saveAs",[],function(){return n})},{}],40:[function(t,e){e.exports=function(t,e){var n=e||document;if(n.createStyleSheet){var i=n.createStyleSheet();return i.cssText=t,i.ownerNode}var r=n.getElementsByTagName("head")[0],o=n.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=t:o.appendChild(n.createTextNode(t)),r.appendChild(o),o},e.exports.byUrl=function(t){if(document.createStyleSheet)return document.createStyleSheet(t).ownerNode;var e=document.getElementsByTagName("head")[0],n=document.createElement("link");return n.rel="stylesheet",n.href=t,e.appendChild(n),n}},{}],41:[function(t,e){var n={};n.removeToInsertLater=function(t){var e,n;return n=t.parentNode,e=t.nextSibling,n.removeChild(t),function(){e?n.insertBefore(t,e):n.appendChild(t)}},n.removeAllChilds=function(t){var e;for(e=0;t.firstChild;)e++,t.removeChild(t.firstChild)},e.exports=n},{}],42:[function(t,e){!function(t){function n(e){var n=e.length,i=typeof e;return m(i)||e===t?!1:1===e.nodeType&&n?!0:p(i)||0===n||"number"==typeof n&&n>0&&n-1 in e}function i(t,e){var n,i;this.originalEvent=t,i=function(t,e){this[t]="preventDefault"===t?function(){return this.defaultPrevented=!0,e[t]()}:m(e[t])?function(){return e[t]()}:e[t]};for(n in t)(t[n]||"function"==typeof t[n])&&i.call(this,n,t);v.extend(this,e)}var r,o=t.$,s=t.jBone,a=/^<(\w+)\s*\/?>$/,l=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,h=[].slice,u=[].splice,c=Object.keys,d=document,f=function(t){return"string"==typeof t},g=function(t){return t instanceof Object},m=function(t){return"[object Function]"==={}.toString.call(t)},p=function(t){return Array.isArray(t)},v=function(t,e){return new r.init(t,e)};v.noConflict=function(){return t.$=o,t.jBone=s,v},r=v.fn=v.prototype={init:function(t,e){var n,i,r,o;if(!t)return this;if(f(t)){if(i=a.exec(t))return this[0]=d.createElement(i[1]),this.length=1,g(e)&&this.attr(e),this;if((i=l.exec(t))&&i[1]){for(o=d.createDocumentFragment(),r=d.createElement("div"),r.innerHTML=t;r.lastChild;)o.appendChild(r.firstChild);return n=h.call(o.childNodes),v.merge(this,n)}if(v.isElement(e))return v(e).find(t);try{return n=d.querySelectorAll(t),v.merge(this,n)}catch(s){return this}}return t.nodeType?(this[0]=t,this.length=1,this):m(t)?t():t instanceof v?t:v.makeArray(t,this)},pop:[].pop,push:[].push,reverse:[].reverse,shift:[].shift,sort:[].sort,splice:[].splice,slice:[].slice,indexOf:[].indexOf,forEach:[].forEach,unshift:[].unshift,concat:[].concat,join:[].join,every:[].every,some:[].some,filter:[].filter,map:[].map,reduce:[].reduce,reduceRight:[].reduceRight,length:0},r.constructor=v,r.init.prototype=r,v.setId=function(e){var n=e.jid;e===t?n="window":void 0===e.jid&&(e.jid=n=++v._cache.jid),v._cache.events[n]||(v._cache.events[n]={})},v.getData=function(e){e=e instanceof v?e[0]:e;var n=e===t?"window":e.jid;return{jid:n,events:v._cache.events[n]}},v.isElement=function(t){return t&&t instanceof v||t instanceof HTMLElement||f(t)},v._cache={events:{},jid:0},v.merge=function(t,e){for(var n=e.length,i=t.length,r=0;n>r;)t[i++]=e[r++];return t.length=i,t},v.contains=function(t,e){var n;return t.reverse().some(function(t){return t.contains(e)?n=t:void 0}),n},v.extend=function(t){var e;return u.call(arguments,1).forEach(function(n){if(e=t,n)for(var i in n)e[i]=n[i]}),t},v.makeArray=function(t,e){var i=e||[];return null!==t&&(n(t)?v.merge(i,f(t)?[t]:t):i.push(t)),i},v.unique=function(t){if(null==t)return[];for(var e=[],n=0,i=t.length;i>n;n++){var r=t[n];e.indexOf(r)<0&&e.push(r)}return e},v.Event=function(t,e){var n,i;return t.type&&!e&&(e=t,t=t.type),n=t.split(".").splice(1).join("."),i=t.split(".")[0],t=d.createEvent("Event"),t.initEvent(i,!0,!0),v.extend(t,{namespace:n,isDefaultPrevented:function(){return t.defaultPrevented}},e)},r.on=function(t){var e,n,r,o,s,a,l,u,c=arguments,d=this.length,m=0,p=h.call(c,-1)[0];for(3===c.length&&f(c[1])?e=c[1]:3===c.length&&g(c[1])?n=c[1]:4===c.length&&(e=c[1],n=c[2]),u=function(h){v.setId(h),s=v.getData(h).events,t.split(" ").forEach(function(t){var u={};n&&(u.data=n),a=t.split(".")[0],r=t.split(".").splice(1).join("."),s[a]=s[a]||[],o=function(t){t.namespace&&t.namespace!==r||(l=null,e?(~v(h).find(e).indexOf(t.target)||(l=v.contains(v(h).find(e),t.target)))&&(l=l||t.target,u.currentTarget=l,p.call(l,new i(t,u))):p.call(h,new i(t,u)))},s[a].push({namespace:r,fn:o,originfn:p}),h.addEventListener&&h.addEventListener(a,o,!1)})};d>m;m++)u(this[m]);return this},r.one=function(t){var e,n=arguments,i=0,r=this.length,o=h.call(n,1,n.length-1),s=h.call(n,-1)[0];for(e=function(e){var n=v(e);t.split(" ").forEach(function(t){var i=function(r){n.off(t,i),s.call(e,r)};n.on.apply(n,[t].concat(o,i))})};r>i;i++)e(this[i]);return this},r.trigger=function(t){var e,n=[],i=0,r=this.length;if(!t)return this;for(f(t)?n=t.split(" ").map(function(t){return v.Event(t)}):(t=t instanceof Event?t:v.Event(t),n=[t]),e=function(t){n.forEach(function(e){e.type&&t.dispatchEvent&&t.dispatchEvent(e)})};r>i;i++)e(this[i]);return this},r.off=function(t,e){var n,i,r,o,s=0,a=this.length,l=function(t,n,i,r,o){var s;(e&&o.originfn===e||!e)&&(s=o.fn),t[n][i].fn===s&&(r.removeEventListener(n,s),v._cache.events[v.getData(r).jid][n].splice(i,1))};for(r=function(e){var r,s,a;return(n=v.getData(e).events)?!t&&n?c(n).forEach(function(t){for(s=n[t],r=s.length;r--;)l(n,t,r,e,s[r])}):(t.split(" ").forEach(function(t){if(o=t.split(".")[0],i=t.split(".").splice(1).join("."),n[o])for(s=n[o],r=s.length;r--;)a=s[r],(!i||i&&a.namespace===i)&&l(n,o,r,e,a);else i&&c(n).forEach(function(t){for(s=n[t],r=s.length;r--;)a=s[r],a.namespace.split(".")[0]===i.split(".")[0]&&l(n,t,r,e,a)})}),void 0):void 0};a>s;s++)r(this[s]);return this},r.find=function(t){for(var e=[],n=0,i=this.length,r=function(n){m(n.querySelectorAll)&&[].forEach.call(n.querySelectorAll(t),function(t){e.push(t)})};i>n;n++)r(this[n]);return v(e)},r.get=function(t){return null!=t?0>t?this[t+this.length]:this[t]:h.call(this)},r.eq=function(t){return v(this[t])},r.parent=function(){for(var t,e=[],n=0,i=this.length;i>n;n++)!~e.indexOf(t=this[n].parentElement)&&t&&e.push(t);return v(e)},r.toArray=function(){return h.call(this)},r.is=function(){var t=arguments;return this.some(function(e){return e.tagName.toLowerCase()===t[0]})},r.has=function(){var t=arguments;return this.some(function(e){return e.querySelectorAll(t[0]).length})},r.add=function(t,e){return v.unique(v.merge(this.get(),v(t,e)))},r.attr=function(t,e){var n,i=arguments,r=0,o=this.length;if(f(t)&&1===i.length)return this[0]&&this[0].getAttribute(t);for(2===i.length?n=function(n){n.setAttribute(t,e)}:g(t)&&(n=function(e){c(t).forEach(function(n){e.setAttribute(n,t[n])})});o>r;r++)n(this[r]);return this},r.removeAttr=function(t){for(var e=0,n=this.length;n>e;e++)this[e].removeAttribute(t);return this},r.val=function(t){var e=0,n=this.length;if(0===arguments.length)return this[0]&&this[0].value;for(;n>e;e++)this[e].value=t;return this},r.css=function(e,n){var i,r=arguments,o=0,s=this.length;if(f(e)&&1===r.length)return this[0]&&t.getComputedStyle(this[0])[e];for(2===r.length?i=function(t){t.style[e]=n}:g(e)&&(i=function(t){c(e).forEach(function(n){t.style[n]=e[n]})});s>o;o++)i(this[o]);return this},r.data=function(t,e){var n,i=arguments,r={},o=0,s=this.length,a=function(t,e,n){g(n)?(t.jdata=t.jdata||{},t.jdata[e]=n):t.dataset[e]=n},l=function(t){return"true"===t?!0:"false"===t?!1:t};if(0===i.length)return this[0].jdata&&(r=this[0].jdata),c(this[0].dataset).forEach(function(t){r[t]=l(this[0].dataset[t])},this),r;if(1===i.length&&f(t))return this[0]&&l(this[0].dataset[t]||this[0].jdata&&this[0].jdata[t]);for(1===i.length&&g(t)?n=function(e){c(t).forEach(function(n){a(e,n,t[n])})}:2===i.length&&(n=function(n){a(n,t,e)});s>o;o++)n(this[o]);return this},r.removeData=function(t){for(var e,n,i=0,r=this.length;r>i;i++)if(e=this[i].jdata,n=this[i].dataset,t)e&&e[t]&&delete e[t],delete n[t];else{for(t in e)delete e[t];for(t in n)delete n[t]}return this},r.html=function(t){var e,n=arguments;return 1===n.length&&void 0!==t?this.empty().append(t):0===n.length&&(e=this[0])?e.innerHTML:this},r.append=function(t){var e,n=0,i=this.length;for(f(t)&&l.exec(t)?t=v(t):g(t)||(t=document.createTextNode(t)),t=t instanceof v?t:v(t),e=function(e,n){t.forEach(function(t){n?e.appendChild(t.cloneNode(!0)):e.appendChild(t)})};i>n;n++)e(this[n],n);return this},r.appendTo=function(t){return v(t).append(this),this},r.empty=function(){for(var t,e=0,n=this.length;n>e;e++)for(t=this[e];t.lastChild;)t.removeChild(t.lastChild);return this},r.remove=function(){var t,e=0,n=this.length;for(this.off();n>e;e++)t=this[e],delete t.jdata,t.parentNode&&t.parentNode.removeChild(t);return this},"object"==typeof e&&e&&"object"==typeof e.exports?e.exports=v:"function"==typeof define&&define.amd?(define(function(){return v}),t.jBone=t.$=v):"object"==typeof t&&"object"==typeof t.document&&(t.jBone=t.$=v)}(window)},{}],43:[function(t,e){var n={};n.d=n.defaultValue=function(t,e){return void 0===t?"function"==typeof t?e():e:t},n.id=function(t){return document.getElementById(t)},n.mk=function(t){return document.createElement(t)},void 0!==e&&void 0!==e.exports&&(e.exports=n)},{}],44:[function(t,e){e.exports=t("./lib/menubuilder")},{"./lib/menubuilder":45}],45:[function(t,e){var n,i,r;i=t("jbone"),r=t("backbone-viewj"),e.exports=n=r.extend({initialize:function(t){this._nodes=[],this.name=t.name||"",this.el.className+="smenubar"},render:function(){for(var t=this.el.firstChild;t;)this.el.removeChild(t),t=this.el.firstChild;this.el.appendChild(this.buildDOM())},setName:function(t){this.name=t},addNode:function(t,e,n){var i;null!=n&&(i=n.style),null==this._nodes&&(this._nodes=[]),this._nodes.push({label:t,callback:e,style:i})},getNode:function(t){var e=void 0;return this._nodes.forEach(function(n){n.label===t&&(e=n)}),e},modifyNode:function(t,e,n){var i=this.getNode(t);i.callback=e||i.callback,n=n||{},i.style=n.style||i.style},renameNode:function(t,e){var n=this.getNode(t);n.label=e||n.label},removeNode:function(t){var e=this.getNode(t);this._nodes.splice(this._nodes.indexOf(e),1)},removeAllNodes:function(){this._nodes=[]},buildDOM:function(){var t=document.createElement("span");return t.appendChild(this._buildM({nodes:this._nodes,name:this.name})),t},_buildM:function(t){var e,n,r,o,s,a,l,h=t.nodes,u=t.name,c=document.createElement("div");c.className="smenu-dropdown smenu-dropdown-tip",c.style.display="none";var d=document.createElement("ul");d.className="smenu-dropdown-menu";for(var f=0,g=h.length;g>f;f++){s=h[f],o=document.createElement("li"),o.textContent=s.label,l=s.style;for(r in l)a=l[r],o.style[r]=a;o.addEventListener("click",s.callback),this.trigger("new:node",o),d.appendChild(o)}return this.trigger("new:menu",d),c.appendChild(d),e=document.createElement("a"),e.textContent=u,e.className="smenubar_alink",this.trigger("new:button",e),i(e).on("click",function(t){return function(n){return t._showMenu(n,c,e),window.setTimeout(function(){return i(document.body).one("click",function(){return c.style.display="none"})},5)}}(this)),n=document.createDocumentFragment(),n.appendChild(c),n.appendChild(e),n},_showMenu:function(t,e,n){var i;e.style.display="block",e.style.position="absolute",i=n.getBoundingClientRect(),e.style.left=i.left+"px",e.style.top=i.top+n.offsetHeight+"px"}})},{"backbone-viewj":9,jbone:42}],46:[function(t,e){var n;e.exports=n={rel:function(t){var e,n,i,r;return e=t.offsetX,n=t.offsetY,void 0==e&&(i=r.getBoundingClientRect(),r=t.target||t.srcElement,void 0==e&&(e=t.clientX-i.left,n=t.clientY-i.top),void 0==e&&(e=t.pageX-r.offsetLeft,n=t.pageY-r.offsetTop),void 0==e)?(console.log(t,"no mouse event defined. your browser sucks"),void 0):[e,n]},abs:function(t){var e,n;return e=t.pageX,n=t.pageY,void 0==e&&(e=t.layerX,n=t.layerY),void 0==e&&(e=t.clientX,n=t.clientY),void 0==e&&(e=t.x,n=t.y),[e,n]},wheelDelta:function(t){var e;return e=[t.deltaX,t.deltaY],void 0==e[0]&&t.mozMovementX&&(e=[0,t.mozMovementX]),isNaN(e[0])&&(e[0]=0),isNaN(e[1])&&(e[1]=0),e}}},{}],47:[function(t,e){e.exports={A:"#00a35c",R:"#00fc03",N:"#00eb14",D:"#00eb14",C:"#0000ff",Q:"#00f10e",E:"#00f10e",G:"#009d62",H:"#00d52a",I:"#0054ab",L:"#007b84",K:"#00ff00",M:"#009768",F:"#008778",P:"#00e01f",S:"#00d52a",T:"#00db24",W:"#00a857",Y:"#00e619",V:"#005fa0",B:"#00eb14",X:"#00b649",Z:"#00f10e"}},{}],48:[function(t,e){e.exports={A:"#BBBBBB",B:"grey",C:"yellow",D:"red",E:"red",F:"magenta",G:"brown",H:"#00FFFF",I:"#BBBBBB",J:"#fff",K:"#00FFFF",L:"#BBBBBB",M:"#BBBBBB",N:"green",O:"#fff",P:"brown",Q:"green",R:"#00FFFF",S:"green",T:"green",U:"#fff",V:"#BBBBBB",W:"magenta",X:"grey",Y:"magenta",Z:"grey",Gap:"grey"}},{}],49:[function(t,e){e.exports={A:"orange",B:"#fff",C:"green",D:"red",E:"red",F:"blue",G:"orange",H:"red",I:"green",J:"#fff",K:"red",L:"green",M:"green",N:"#fff",O:"#fff",P:"orange",Q:"#fff",R:"red",S:"orange",T:"orange",U:"#fff",V:"green",W:"blue",X:"#fff",Y:"blue",Z:"#fff",Gap:"#fff"}},{}],50:[function(t,e){e.exports={A:"#80a0f0",R:"#f01505",N:"#00ff00",D:"#c048c0",C:"#f08080",Q:"#00ff00",E:"#c048c0",G:"#f09048",H:"#15a4a4",I:"#80a0f0",L:"#80a0f0",K:"#f01505",M:"#80a0f0",F:"#80a0f0",P:"#ffff00",S:"#00ff00",T:"#00ff00",W:"#80a0f0",Y:"#15a4a4",V:"#80a0f0",B:"#fff",X:"#fff",Z:"#fff"}},{}],51:[function(t,e){e.exports={A:"#e718e7",R:"#6f906f",N:"#1be41b",D:"#778877",C:"#23dc23",Q:"#926d92",E:"#ff00ff",G:"#00ff00",H:"#758a75",I:"#8a758a",L:"#ae51ae",K:"#a05fa0",M:"#ef10ef",F:"#986798",P:"#00ff00",S:"#36c936",T:"#47b847",W:"#8a758a",Y:"#21de21",V:"#857a85",B:"#49b649",X:"#758a75",Z:"#c936c9"}},{}],52:[function(t,e){e.exports={A:"#ad0052",B:"#0c00f3",C:"#c2003d",D:"#0c00f3",E:"#0c00f3",F:"#cb0034",G:"#6a0095",H:"#1500ea",I:"#ff0000",J:"#fff",K:"#0000ff",L:"#ea0015",M:"#b0004f",N:"#0c00f3",O:"#fff",P:"#4600b9",Q:"#0c00f3",R:"#0000ff",S:"#5e00a1",T:"#61009e",U:"#fff",V:"#f60009",W:"#5b00a4",X:"#680097",Y:"#4f00b0",Z:"#0c00f3"}},{}],53:[function(t,e){function n(t){if(null==t||"object"!=typeof t)return t;var e=t.constructor();for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var i=t("./schemeclass"),r=i.stat,o=i.dyn,s=t("./buried"),a=t("./cinema"),l=t("./clustal"),h=t("./clustal2"),u=t("./helix"),c=t("./hydrophobicity"),d=t("./lesk"),f=t("./mae"),g=t("./nucleotide"),m=t("./purine"),p=t("./strand"),v=t("./taylor"),b=t("./turn"),x=t("./zappo"),w={buried:s,buried_index:s,cinema:a,clustal2:h,clustal:l,helix:u,helix_propensity:u,hydro:c,lesk:d,mae:f,nucleotide:g,purine:m,purine_pyrimidine:m,strand:p,strand_propensity:p,taylor:v,turn:b,turn_propensity:b,zappo:x},y=t("./pid_colors.js"),_={pid:y};
e.exports=Colors=function(t){this.maps=n(w),this.dyn=n(_),this.opt=t},Colors.getScheme=function(t){return w[t]},Colors.prototype.getScheme=function(t){var e=this.maps[t];return void 0===e&&(e={},void 0!=this.dyn[t])?new o(this.dyn[t],this.opt):new r(e)},Colors.prototype.addStaticScheme=function(t,e){this.maps[t]=e},Colors.prototype.addDynScheme=function(t,e){this.dyn[t]=e}},{"./buried":47,"./cinema":48,"./clustal":49,"./clustal2":50,"./helix":51,"./hydrophobicity":52,"./lesk":54,"./mae":55,"./nucleotide":56,"./pid_colors.js":57,"./purine":58,"./schemeclass":59,"./strand":60,"./taylor":61,"./turn":62,"./zappo":63}],54:[function(t,e){e.exports={A:" orange",B:" #fff",C:" green",D:" red",E:" red",F:" green",G:" orange",H:" magenta",I:" green",J:" #fff",K:" red",L:" green",M:" green",N:" magenta",O:" #fff",P:" green",Q:" magenta",R:" red",S:" orange",T:" orange",U:" #fff",V:" green",W:" green",X:" #fff",Y:" green",Z:" #fff",Gap:" #fff"}},{}],55:[function(t,e){e.exports={A:" #77dd88",B:" #fff",C:" #99ee66",D:" #55bb33",E:" #55bb33",F:" #9999ff",G:" #77dd88",H:" #5555ff",I:" #66bbff",J:" #fff",K:" #ffcc77",L:" #66bbff",M:" #66bbff",N:" #55bb33",O:" #fff",P:" #eeaaaa",Q:" #55bb33",R:" #ffcc77",S:" #ff4455",T:" #ff4455",U:" #fff",V:" #66bbff",W:" #9999ff",X:" #fff",Y:" #9999ff",Z:" #fff",Gap:" #fff"}},{}],56:[function(t,e){e.exports={A:" #64F73F",C:" #FFB340",G:" #EB413C",T:" #3C88EE",U:" #3C88EE"}},{}],57:[function(t,e){var n;e.exports=n={},n.init=function(){this.cons=this.opt.conservation()},n.run=function(t,e){var n=this.cons[e.pos];return n>.8?"#6464ff":n>.6?"#9da5ff":n>.4?"#cccccc":"#ffffff"}},{}],58:[function(t,e){e.exports={A:" #FF83FA",C:" #40E0D0",G:" #FF83FA",R:" #FF83FA",T:" #40E0D0",U:" #40E0D0",Y:" #40E0D0"}},{}],59:[function(t,e){var n=function(t){this.defaultColor="#ffffff",this.type="static",this.map=t,this.getColor=function(t){return void 0!==this.map[t]?this.map[t]:this.defaultColor}},i=function(t,e){this.type="dyn",this.opt=e,void 0!==t.init?(t.init.call(this),this.getColor=t.run,this.reset=t.init):this.getColor=t};e.exports.stat=n,e.exports.dyn=i},{}],60:[function(t,e){e.exports={A:"#5858a7",R:"#6b6b94",N:"#64649b",D:"#2121de",C:"#9d9d62",Q:"#8c8c73",E:"#0000ff",G:"#4949b6",H:"#60609f",I:"#ecec13",L:"#b2b24d",K:"#4747b8",M:"#82827d",F:"#c2c23d",P:"#2323dc",S:"#4949b6",T:"#9d9d62",W:"#c0c03f",Y:"#d3d32c",V:"#ffff00",B:"#4343bc",X:"#797986",Z:"#4747b8"}},{}],61:[function(t,e){e.exports={A:"#ccff00",R:"#0000ff",N:"#cc00ff",D:"#ff0000",C:"#ffff00",Q:"#ff00cc",E:"#ff0066",G:"#ff9900",H:"#0066ff",I:"#66ff00",L:"#33ff00",K:"#6600ff",M:"#00ff00",F:"#00ff66",P:"#ffcc00",S:"#ff3300",T:"#ff6600",W:"#00ccff",Y:"#00ffcc",V:"#99ff00",B:"#fff",X:"#fff",Z:"#fff"}},{}],62:[function(t,e){e.exports={A:"#2cd3d3",R:"#708f8f",N:"#ff0000",D:"#e81717",C:"#a85757",Q:"#3fc0c0",E:"#778888",G:"#ff0000",H:"#708f8f",I:"#00ffff",L:"#1ce3e3",K:"#7e8181",M:"#1ee1e1",F:"#1ee1e1",P:"#f60909",S:"#e11e1e",T:"#738c8c",W:"#738c8c",Y:"#9d6262",V:"#07f8f8",B:"#f30c0c",X:"#7c8383",Z:"#5ba4a4"}},{}],63:[function(t,e){e.exports={A:"#ffafaf",R:"#6464ff",N:"#00ff00",D:"#ff0000",C:"#ffff00",Q:"#00ff00",E:"#ff0000",G:"#ff00ff",H:"#6464ff",I:"#ffafaf",L:"#ffafaf",K:"#6464ff",M:"#ffafaf",F:"#ffc800",P:"#ff00ff",S:"#00ff00",T:"#00ff00",W:"#ffc800",Y:"#ffc800",V:"#ffafaf",B:"#fff",X:"#fff",Z:"#fff"}},{}],64:[function(t,e){var n={};e.exports=n,n.getMeta=function(t){if(n.contains(t,"|")){for(var e,o,s=t.split("|"),a=0,l={};a<s.length-1;)e=s[a],o=s[a+1],l[e]=o,a+=2;var h=s[s.length-1];if(h.indexOf("=")>=0&&h.indexOf("OS")>=0){var u={},c=h.split(" ");u.en=c[0],c=c.splice(1);var d=i(c,"="),f=c.splice(d-1);h=c.join(" "),c=f,a=0;var g=[];return c.forEach(function(t){g.push(t),t.indexOf("=")>=0&&(r(g.join(" "),"=",u),g=[])}),{name:h,ids:l,details:u}}return{name:h,ids:l}}return{name:t}};var i=function(t){for(var e=0;e<t.lenght;e++)if(t[e].indexOf(e))return e;return t.length-1},r=function(t,e,n){n=n||{};var i=t.split(e);return n[i[0].toLowerCase()]=i[1],n},o={sp:{link:"http://www.uniprot.org/%s",name:"Uniprot"},tr:{link:"http://www.uniprot.org/%s",name:"Trembl"},gb:{link:"http://www.ncbi.nlm.nih.gov/nuccore/%s",name:"Genbank"},pdb:{link:"http://www.rcsb.org/pdb/explore/explore.do?structureId=%s",name:"PDB"}};n.buildLinks=function(t){var e={};return t=t||{},Object.keys(t).forEach(function(n){if(n in o){var i=o[n],r=i.link.replace("%s",t[n]);e[i.name]=r}}),e},n.contains=function(t,e){return-1!=="".indexOf.call(t,e,0)},n.splitNChars=function(t,e){var n,i;e=e||80;var r=[];for(n=0,i=t.length-1;i>=n;n+=e)r.push(t.substr(n,e));return r},n.model=function(t,e,n){this.seq=t,this.name=e,this.id=n,this.ids={}}},{}],65:[function(t,e){var n=t("underscore"),i=function(t){if(this.constructor!==i)return new i(t);if(void 0===t||"string"==typeof t)throw new TypeError("you need to give the seq stat an array");this.resetSeqs(t),this.alphabetSize=4,this._useBackground=!1,this.ignoredChars=["-","*"]};i.prototype.addSeq=function(t){this.seqs.push(t),this._reset()},i.prototype.removeSeq=function(t){"number"==typeof t?this.seqs.splice(t,1):n.each(this.seqs,function(e,n){t===e&&this.seqs.splice(n,1)}.bind(this)),this._reset()},i.prototype.addSeqs=function(t){t.forEach(function(t){this.addSeq(t)}.bind(this))},i.prototype.resetSeqs=function(t){if(this.seqs=[],t instanceof Array)this.addSeqs(t),this._reset(),this.trigger("reset");else{this.mseqs=t;var e=function(){var t=this.mseqs.pluck("seq");this.resetSeqs(t)};t.on("add change reset ",e,this),e.call(this)}};var r=["consensus","frequency","maxLength","ic","gaps"];i.prototype._reset=function(){for(var t=0;t<r.length;t++)this["_"+r[t]]=void 0;this._identity=void 0,this._background=void 0},i.prototype.setBackground=function(t){this._useBackground=t,this._reset()},i.prototype.useBackground=function(){this.setBackground(!0)},i.prototype.setDNA=function(){this.alphabetSize=4},i.prototype.setProtein=function(){this.alphabetSize=20},r.forEach(function(t){i.prototype[t]=function(){return void 0===this["_"+t]&&this[t+"Calc"](),this["_"+t]}}),i.prototype.identity=function(t){var e;return(void 0===this._identity||t)&&(e=this.identityCalc(t),this._identity=void 0),this._identity||e},i.prototype.background=function(){return void 0!==this.bg?this.bg:(void 0===this._background&&this.backgroundCalc(),this._background)},i.prototype.frequencyCalc=function(t){var e,i;e=new Array(this.maxLength()),i=new Array(this.seqs.length);var r=this.ignoredChars;return void 0!==t&&t.all&&(r=[]),n.each(this.seqs,function(t){n.each(t,function(t,n){r.indexOf(t)>=0||(void 0===e[n]&&(e[n]={}),void 0===e[n][t]&&(e[n][t]=0),e[n][t]++,void 0===i[n]&&(i[n]=0),i[n]++)})}),n.each(e,function(t,r){return n.each(t,function(t,n){return e[r][n]=t/i[r]})}),this._frequency=e,e},i.prototype.backgroundCalc=function(){var t={},e=0;return n.each(this.seqs,function(i){n.each(i,function(n){return void 0===t[n]&&(t[n]=0),t[n]++,e++})}),t=n.mapValues(t,function(t){return t/e}),this._background=t,t},i.prototype.icCalc=function(){var t=this.frequency();if(this._useBackground)var e=this.background();var i=this.ignoredChars,r=this._useBackground,o=n.map(t,function(t){return n.reduce(t,function(t,n,o){return i.indexOf(o)>=0?t:(r&&(n/=e[o]),t-n*(Math.log(n)/Math.log(2)))},0)});return this._ic=o,o},i.prototype.conservation=function(t){var e=this.ic();t=t||this.alphabetSize;var i=Math.log(t)/Math.log(2),r=n.map(e,function(t){return i-t});return r},i.prototype.conservResidue=function(t){var e,i=t?t.alphabetSize:void 0,r=this.ignoredChars;e=void 0!==t&&t.scaled?this.scale(this.conservation(i)):this.conservation(i);var o,s=this.frequency(),a=n.map(s,function(t,i){o=n.reject(n.keys(t),function(t){return r.indexOf(t)>=0});var s={};return n.each(o,function(n){s[n]=t[n]*e[i]}),s});return a},i.prototype.conservResidue2=function(t){var e=this.frequency(),i=this.conservation(t),r=this.background(),o=n.map(e,function(t,o){return n.map(t,function(t){var s=n.reduce(e[o],function(t,e){return t+e/r[o]},0);return t/r[o]/s*i[o]},0)});return o},i.prototype.scale=function(t,e){e=e||this.alphabetSize;var i=Math.log(e)/Math.log(2),r=n.map(t,function(t){return t/i});return r},i.prototype.maxLengthCalc=function(){this._maxLength=n.max(this.seqs,function(t){return t.length}).length},i.prototype.consensusCalc=function(){var t=new Array(this.maxLength());return n.each(this.seqs,function(e){n.each(e,function(e,n){void 0===t[n]&&(t[n]={}),void 0===t[n][e]&&(t[n][e]=0),t[n][e]++})}),this._consensus=n.reduce(t,function(t,e){var i;return i=n.keys(e),t+=n.max(i,function(t){return e[t]})},""),this._consensus},i.prototype.identityCalc=function(t){var e=t||this.consensus();return this._identity=this.seqs.map(function(t){for(var n=0,i=0,r=0;r<t.length;r++)"-"!==t[r]&&"-"!==e[r]&&(i++,t[r]===e[r]&&n++);return n/i}),this._identity},i.prototype.gapsCalc=function(){var t=new Array(this.maxLength());return n.each(this.seqs,function(e){n.each(e,function(e,n){void 0===t[n]&&(t[n]={g:0,t:0}),e="-"===e?"g":"t",t[n][e]++})}),this._gaps=n.map(t,function(t){return t.g/(t.g+t.t)}),this._gaps},n.mixin({mapValues:function(t,e){return n.object(n.keys(t),n.map(t,e))}}),t("biojs-events").mixin(i.prototype),e.exports=i},{"biojs-events":13,underscore:66}],66:[function(t,e,n){(function(){var t=this,i=t._,r=Array.prototype,o=Object.prototype,s=Function.prototype,a=r.push,l=r.slice,h=r.concat,u=o.toString,c=o.hasOwnProperty,d=Array.isArray,f=Object.keys,g=s.bind,m=function(t){return t instanceof m?t:this instanceof m?(this._wrapped=t,void 0):new m(t)};"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=m),n._=m):t._=m,m.VERSION="1.7.0";var p=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return function(){return t.apply(e,arguments)}};m.iteratee=function(t,e,n){return null==t?m.identity:m.isFunction(t)?p(t,e,n):m.isObject(t)?m.matches(t):m.property(t)},m.each=m.forEach=function(t,e,n){if(null==t)return t;e=p(e,n);var i,r=t.length;if(r===+r)for(i=0;r>i;i++)e(t[i],i,t);else{var o=m.keys(t);for(i=0,r=o.length;r>i;i++)e(t[o[i]],o[i],t)}return t},m.map=m.collect=function(t,e,n){if(null==t)return[];e=m.iteratee(e,n);for(var i,r=t.length!==+t.length&&m.keys(t),o=(r||t).length,s=Array(o),a=0;o>a;a++)i=r?r[a]:a,s[a]=e(t[i],i,t);return s};var v="Reduce of empty array with no initial value";m.reduce=m.foldl=m.inject=function(t,e,n,i){null==t&&(t=[]),e=p(e,i,4);var r,o=t.length!==+t.length&&m.keys(t),s=(o||t).length,a=0;if(arguments.length<3){if(!s)throw new TypeError(v);n=t[o?o[a++]:a++]}for(;s>a;a++)r=o?o[a]:a,n=e(n,t[r],r,t);return n},m.reduceRight=m.foldr=function(t,e,n,i){null==t&&(t=[]),e=p(e,i,4);var r,o=t.length!==+t.length&&m.keys(t),s=(o||t).length;if(arguments.length<3){if(!s)throw new TypeError(v);n=t[o?o[--s]:--s]}for(;s--;)r=o?o[s]:s,n=e(n,t[r],r,t);return n},m.find=m.detect=function(t,e,n){var i;return e=m.iteratee(e,n),m.some(t,function(t,n,r){return e(t,n,r)?(i=t,!0):void 0}),i},m.filter=m.select=function(t,e,n){var i=[];return null==t?i:(e=m.iteratee(e,n),m.each(t,function(t,n,r){e(t,n,r)&&i.push(t)}),i)},m.reject=function(t,e,n){return m.filter(t,m.negate(m.iteratee(e)),n)},m.every=m.all=function(t,e,n){if(null==t)return!0;e=m.iteratee(e,n);var i,r,o=t.length!==+t.length&&m.keys(t),s=(o||t).length;for(i=0;s>i;i++)if(r=o?o[i]:i,!e(t[r],r,t))return!1;return!0},m.some=m.any=function(t,e,n){if(null==t)return!1;e=m.iteratee(e,n);var i,r,o=t.length!==+t.length&&m.keys(t),s=(o||t).length;for(i=0;s>i;i++)if(r=o?o[i]:i,e(t[r],r,t))return!0;return!1},m.contains=m.include=function(t,e){return null==t?!1:(t.length!==+t.length&&(t=m.values(t)),m.indexOf(t,e)>=0)},m.invoke=function(t,e){var n=l.call(arguments,2),i=m.isFunction(e);return m.map(t,function(t){return(i?e:t[e]).apply(t,n)})},m.pluck=function(t,e){return m.map(t,m.property(e))},m.where=function(t,e){return m.filter(t,m.matches(e))},m.findWhere=function(t,e){return m.find(t,m.matches(e))},m.max=function(t,e,n){var i,r,o=-1/0,s=-1/0;if(null==e&&null!=t){t=t.length===+t.length?t:m.values(t);for(var a=0,l=t.length;l>a;a++)i=t[a],i>o&&(o=i)}else e=m.iteratee(e,n),m.each(t,function(t,n,i){r=e(t,n,i),(r>s||r===-1/0&&o===-1/0)&&(o=t,s=r)});return o},m.min=function(t,e,n){var i,r,o=1/0,s=1/0;if(null==e&&null!=t){t=t.length===+t.length?t:m.values(t);for(var a=0,l=t.length;l>a;a++)i=t[a],o>i&&(o=i)}else e=m.iteratee(e,n),m.each(t,function(t,n,i){r=e(t,n,i),(s>r||1/0===r&&1/0===o)&&(o=t,s=r)});return o},m.shuffle=function(t){for(var e,n=t&&t.length===+t.length?t:m.values(t),i=n.length,r=Array(i),o=0;i>o;o++)e=m.random(0,o),e!==o&&(r[o]=r[e]),r[e]=n[o];return r},m.sample=function(t,e,n){return null==e||n?(t.length!==+t.length&&(t=m.values(t)),t[m.random(t.length-1)]):m.shuffle(t).slice(0,Math.max(0,e))},m.sortBy=function(t,e,n){return e=m.iteratee(e,n),m.pluck(m.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var b=function(t){return function(e,n,i){var r={};return n=m.iteratee(n,i),m.each(e,function(i,o){var s=n(i,o,e);t(r,i,s)}),r}};m.groupBy=b(function(t,e,n){m.has(t,n)?t[n].push(e):t[n]=[e]}),m.indexBy=b(function(t,e,n){t[n]=e}),m.countBy=b(function(t,e,n){m.has(t,n)?t[n]++:t[n]=1}),m.sortedIndex=function(t,e,n,i){n=m.iteratee(n,i,1);for(var r=n(e),o=0,s=t.length;s>o;){var a=o+s>>>1;n(t[a])<r?o=a+1:s=a}return o},m.toArray=function(t){return t?m.isArray(t)?l.call(t):t.length===+t.length?m.map(t,m.identity):m.values(t):[]},m.size=function(t){return null==t?0:t.length===+t.length?t.length:m.keys(t).length},m.partition=function(t,e,n){e=m.iteratee(e,n);var i=[],r=[];return m.each(t,function(t,n,o){(e(t,n,o)?i:r).push(t)}),[i,r]},m.first=m.head=m.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:0>e?[]:l.call(t,0,e)},m.initial=function(t,e,n){return l.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},m.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:l.call(t,Math.max(t.length-e,0))},m.rest=m.tail=m.drop=function(t,e,n){return l.call(t,null==e||n?1:e)},m.compact=function(t){return m.filter(t,m.identity)};var x=function(t,e,n,i){if(e&&m.every(t,m.isArray))return h.apply(i,t);for(var r=0,o=t.length;o>r;r++){var s=t[r];m.isArray(s)||m.isArguments(s)?e?a.apply(i,s):x(s,e,n,i):n||i.push(s)}return i};m.flatten=function(t,e){return x(t,e,!1,[])},m.without=function(t){return m.difference(t,l.call(arguments,1))},m.uniq=m.unique=function(t,e,n,i){if(null==t)return[];m.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=m.iteratee(n,i));for(var r=[],o=[],s=0,a=t.length;a>s;s++){var l=t[s];if(e)s&&o===l||r.push(l),o=l;else if(n){var h=n(l,s,t);m.indexOf(o,h)<0&&(o.push(h),r.push(l))}else m.indexOf(r,l)<0&&r.push(l)}return r},m.union=function(){return m.uniq(x(arguments,!0,!0,[]))},m.intersection=function(t){if(null==t)return[];for(var e=[],n=arguments.length,i=0,r=t.length;r>i;i++){var o=t[i];if(!m.contains(e,o)){for(var s=1;n>s&&m.contains(arguments[s],o);s++);s===n&&e.push(o)}}return e},m.difference=function(t){var e=x(l.call(arguments,1),!0,!0,[]);return m.filter(t,function(t){return!m.contains(e,t)})},m.zip=function(t){if(null==t)return[];for(var e=m.max(arguments,"length").length,n=Array(e),i=0;e>i;i++)n[i]=m.pluck(arguments,i);return n},m.object=function(t,e){if(null==t)return{};for(var n={},i=0,r=t.length;r>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},m.indexOf=function(t,e,n){if(null==t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return i=m.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,r+n):n}for(;r>i;i++)if(t[i]===e)return i;return-1},m.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=t.length;for("number"==typeof n&&(i=0>n?i+n+1:Math.min(i,n+1));--i>=0;)if(t[i]===e)return i;return-1},m.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),o=0;i>o;o++,t+=n)r[o]=t;return r};var w=function(){};m.bind=function(t,e){var n,i;if(g&&t.bind===g)return g.apply(t,l.call(arguments,1));if(!m.isFunction(t))throw new TypeError("Bind must be called on a function");return n=l.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(l.call(arguments)));w.prototype=t.prototype;var r=new w;w.prototype=null;var o=t.apply(r,n.concat(l.call(arguments)));return m.isObject(o)?o:r}},m.partial=function(t){var e=l.call(arguments,1);return function(){for(var n=0,i=e.slice(),r=0,o=i.length;o>r;r++)i[r]===m&&(i[r]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return t.apply(this,i)}},m.bindAll=function(t){var e,n,i=arguments.length;if(1>=i)throw new Error("bindAll must be passed function names");for(e=1;i>e;e++)n=arguments[e],t[n]=m.bind(t[n],t);return t},m.memoize=function(t,e){var n=function(i){var r=n.cache,o=e?e.apply(this,arguments):i;return m.has(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return n.cache={},n},m.delay=function(t,e){var n=l.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},m.defer=function(t){return m.delay.apply(m,[t,1].concat(l.call(arguments,1)))},m.throttle=function(t,e,n){var i,r,o,s=null,a=0;n||(n={});var l=function(){a=n.leading===!1?0:m.now(),s=null,o=t.apply(i,r),s||(i=r=null)};return function(){var h=m.now();a||n.leading!==!1||(a=h);var u=e-(h-a);return i=this,r=arguments,0>=u||u>e?(clearTimeout(s),s=null,a=h,o=t.apply(i,r),s||(i=r=null)):s||n.trailing===!1||(s=setTimeout(l,u)),o}},m.debounce=function(t,e,n){var i,r,o,s,a,l=function(){var h=m.now()-s;e>h&&h>0?i=setTimeout(l,e-h):(i=null,n||(a=t.apply(o,r),i||(o=r=null)))};return function(){o=this,r=arguments,s=m.now();var h=n&&!i;return i||(i=setTimeout(l,e)),h&&(a=t.apply(o,r),o=r=null),a}},m.wrap=function(t,e){return m.partial(e,t)},m.negate=function(t){return function(){return!t.apply(this,arguments)}},m.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},m.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},m.before=function(t,e){var n;return function(){return--t>0?n=e.apply(this,arguments):e=null,n}},m.once=m.partial(m.before,2),m.keys=function(t){if(!m.isObject(t))return[];if(f)return f(t);var e=[];for(var n in t)m.has(t,n)&&e.push(n);return e},m.values=function(t){for(var e=m.keys(t),n=e.length,i=Array(n),r=0;n>r;r++)i[r]=t[e[r]];return i},m.pairs=function(t){for(var e=m.keys(t),n=e.length,i=Array(n),r=0;n>r;r++)i[r]=[e[r],t[e[r]]];return i},m.invert=function(t){for(var e={},n=m.keys(t),i=0,r=n.length;r>i;i++)e[t[n[i]]]=n[i];return e},m.functions=m.methods=function(t){var e=[];for(var n in t)m.isFunction(t[n])&&e.push(n);return e.sort()},m.extend=function(t){if(!m.isObject(t))return t;for(var e,n,i=1,r=arguments.length;r>i;i++){e=arguments[i];for(n in e)c.call(e,n)&&(t[n]=e[n])}return t},m.pick=function(t,e,n){var i,r={};if(null==t)return r;if(m.isFunction(e)){e=p(e,n);for(i in t){var o=t[i];e(o,i,t)&&(r[i]=o)}}else{var s=h.apply([],l.call(arguments,1));t=new Object(t);for(var a=0,u=s.length;u>a;a++)i=s[a],i in t&&(r[i]=t[i])}return r},m.omit=function(t,e,n){if(m.isFunction(e))e=m.negate(e);else{var i=m.map(h.apply([],l.call(arguments,1)),String);e=function(t,e){return!m.contains(i,e)}}return m.pick(t,e,n)},m.defaults=function(t){if(!m.isObject(t))return t;for(var e=1,n=arguments.length;n>e;e++){var i=arguments[e];for(var r in i)void 0===t[r]&&(t[r]=i[r])}return t},m.clone=function(t){return m.isObject(t)?m.isArray(t)?t.slice():m.extend({},t):t},m.tap=function(t,e){return e(t),t};var y=function(t,e,n,i){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof m&&(t=t._wrapped),e instanceof m&&(e=e._wrapped);var r=u.call(t);if(r!==u.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=n.length;o--;)if(n[o]===t)return i[o]===e;var s=t.constructor,a=e.constructor;if(s!==a&&"constructor"in t&&"constructor"in e&&!(m.isFunction(s)&&s instanceof s&&m.isFunction(a)&&a instanceof a))return!1;n.push(t),i.push(e);var l,h;if("[object Array]"===r){if(l=t.length,h=l===e.length)for(;l--&&(h=y(t[l],e[l],n,i)););}else{var c,d=m.keys(t);if(l=d.length,h=m.keys(e).length===l)for(;l--&&(c=d[l],h=m.has(e,c)&&y(t[c],e[c],n,i)););}return n.pop(),i.pop(),h};m.isEqual=function(t,e){return y(t,e,[],[])},m.isEmpty=function(t){if(null==t)return!0;if(m.isArray(t)||m.isString(t)||m.isArguments(t))return 0===t.length;for(var e in t)if(m.has(t,e))return!1;return!0},m.isElement=function(t){return!(!t||1!==t.nodeType)},m.isArray=d||function(t){return"[object Array]"===u.call(t)},m.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},m.each(["Arguments","Function","String","Number","Date","RegExp"],function(t){m["is"+t]=function(e){return u.call(e)==="[object "+t+"]"}}),m.isArguments(arguments)||(m.isArguments=function(t){return m.has(t,"callee")}),"function"!=typeof/./&&(m.isFunction=function(t){return"function"==typeof t||!1}),m.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},m.isNaN=function(t){return m.isNumber(t)&&t!==+t},m.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===u.call(t)},m.isNull=function(t){return null===t},m.isUndefined=function(t){return void 0===t},m.has=function(t,e){return null!=t&&c.call(t,e)},m.noConflict=function(){return t._=i,this},m.identity=function(t){return t},m.constant=function(t){return function(){return t}},m.noop=function(){},m.property=function(t){return function(e){return e[t]}},m.matches=function(t){var e=m.pairs(t),n=e.length;return function(t){if(null==t)return!n;t=new Object(t);for(var i=0;n>i;i++){var r=e[i],o=r[0];if(r[1]!==t[o]||!(o in t))return!1}return!0}},m.times=function(t,e,n){var i=Array(Math.max(0,t));e=p(e,n,1);for(var r=0;t>r;r++)i[r]=e(r);return i},m.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},m.now=Date.now||function(){return(new Date).getTime()};var _={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},S=m.invert(_),k=function(t){var e=function(e){return t[e]},n="(?:"+m.keys(t).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,e):t}};m.escape=k(_),m.unescape=k(S),m.result=function(t,e){if(null==t)return void 0;var n=t[e];return m.isFunction(n)?t[e]():n};var C=0;m.uniqueId=function(t){var e=++C+"";return t?t+e:e},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var z=/(.)^/,j={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},E=/\\|'|\r|\n|\u2028|\u2029/g,T=function(t){return"\\"+j[t]};m.template=function(t,e,n){!e&&n&&(e=n),e=m.defaults({},e,m.templateSettings);var i=RegExp([(e.escape||z).source,(e.interpolate||z).source,(e.evaluate||z).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(i,function(e,n,i,s,a){return o+=t.slice(r,a).replace(E,T),r=a+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?o+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var s=new Function(e.variable||"obj","_",o)}catch(a){throw a.source=o,a}var l=function(t){return s.call(this,t,m)},h=e.variable||"obj";return l.source="function("+h+"){\n"+o+"}",l},m.chain=function(t){var e=m(t);return e._chain=!0,e};var q=function(t){return this._chain?m(t).chain():t};m.mixin=function(t){m.each(m.functions(t),function(e){var n=m[e]=t[e];m.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),q.call(this,n.apply(m,t))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=r[t];m.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],q.call(this,n)}}),m.each(["concat","join","slice"],function(t){var e=r[t];m.prototype[t]=function(){return q.call(this,e.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return m})}).call(this)},{}],67:[function(t,e){(function(t){e.exports="undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],68:[function(t,e){function n(t){var e=!1;return function(){return e?void 0:(e=!0,t.apply(this,arguments))}}e.exports=n,n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0})})},{}],69:[function(t,e){function n(t,e,n){if(!s(e))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===a.call(t)?i(t,e,n):"string"==typeof t?r(t,e,n):o(t,e,n)}function i(t,e,n){for(var i=0,r=t.length;r>i;i++)l.call(t,i)&&e.call(n,t[i],i,t)}function r(t,e,n){for(var i=0,r=t.length;r>i;i++)e.call(n,t.charAt(i),i,t)}function o(t,e,n){for(var i in t)l.call(t,i)&&e.call(n,t[i],i,t)}var s=t("is-function");e.exports=n;var a=Object.prototype.toString,l=Object.prototype.hasOwnProperty},{"is-function":70}],70:[function(t,e){function n(t){var e=i.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}e.exports=n;var i=Object.prototype.toString},{}],71:[function(t,e,n){function i(t){return t.replace(/^\s*|\s*$/g,"")}n=e.exports=i,n.left=function(t){return t.replace(/^\s*/,"")},n.right=function(t){return t.replace(/\s*$/,"")}},{}],72:[function(t,e){var n=t("trim"),i=t("for-each"),r=function(t){return"[object Array]"===Object.prototype.toString.call(t)};e.exports=function(t){if(!t)return{};var e={};return i(n(t).split("\n"),function(t){var i=t.indexOf(":"),o=n(t.slice(0,i)).toLowerCase(),s=n(t.slice(i+1));"undefined"==typeof e[o]?e[o]=s:r(e[o])?e[o].push(s):e[o]=[e[o],s]}),e}},{"for-each":69,trim:71}],73:[function(t,e){var n,i,r;n=t("msa-colorschemes"),r=t("backbone-thin").Model,e.exports=i=r.extend({defaults:{scheme:"taylor",colorBackground:!0,showLowerCase:!0,opacity:.6},initialize:function(t,e,i){return this.colors=new n({seqs:e,conservation:function(){return i.scale(i.conservation())}}),i.on("reset",function(){return"dyn"===this.getSelectedScheme().type?this.getSelectedScheme().reset():void 0},this)},addStaticScheme:function(t,e){return this.colors.addStaticScheme(t,e)},addDynScheme:function(t,e){return this.colors.addDynScheme(t,e)},getScheme:function(t){return this.colors.getScheme(t)},getSelectedScheme:function(){return this.colors.getScheme(this.get("scheme"))}})},{"backbone-thin":4,"msa-colorschemes":53}],74:[function(t,e){var n,i,r;i=t("backbone-thin").Model,r=t("underscore"),e.exports=n=i.extend({initialize:function(t,e){return null==this.get("hidden")&&this.set("hidden",[]),this.stats=e},calcHiddenColumns:function(t){var e,n,i,r,o;for(e=this.get("hidden"),i=t,r=0,o=e.length;o>r;r++)n=e[r],i>=n&&i++;return i-t}})},{"backbone-thin":4,underscore:66}],75:[function(t,e){var n,i;i=t("backbone-thin").Model,e.exports=n=i.extend({defaults:{registerMouseHover:!1,registerMouseClicks:!0,importProxy:"https://cors-anywhere.herokuapp.com/",eventBus:!0,alphabetSize:20,dropImport:!1,debug:!1,hasRef:!1}})},{"backbone-thin":4}],76:[function(t,e){var n,i,r;n=t("../utils/loader"),i=t("backbone-thin").Model,e.exports=r=i.extend({initialize:function(t){return this.g=t},development:{"msa-tnt":"/node_modules/msa-tnt/build/bundle.js","biojs-io-newick":"/node_modules/biojs-io-newick/build/biojs-io-newick.min.js"},loadPackage:function(e,i){var r;try{return r=t(e),i(r)}catch(o){return n.loadScript(this._pkgURL(e),i)}},loadPackages:function(t,e){var i;return i=n.joinCb(function(){return e()},t.length),t.forEach(function(t){return function(e){return t.loadPackage(e,i)}}(this))},_pkgURL:function(t){var e;return e=this.g.config.get("debug")?this.development[t]:"http://wzrd.in/bundle/"+t+"@latest"}})},{"../utils/loader":107,"backbone-thin":4}],77:[function(t,e){var n,i,r,o,s,a;a=t("underscore"),i=t("backbone-thin").Model,s=i.extend({defaults:{type:"super"}}),o=s.extend({defaults:a.extend({},s.prototype.defaults,{type:"row",seqId:""}),inRow:function(t){return t===this.get("seqId")},inColumn:function(){return!0},getLength:function(){return 1}}),n=s.extend({defaults:a.extend({},s.prototype.defaults,{type:"column",xStart:-1,xEnd:-1}),inRow:function(){return!0},inColumn:function(t){return t>=xStart&&xEnd>=t},getLength:function(){return xEnd-xStart}}),r=o.extend(a.extend({},a.pick(n,"inColumn"),a.pick(n,"getLength"),{defaults:a.extend({},n.prototype.defaults,o.prototype.defaults,{type:"pos"})})),e.exports.sel=s,e.exports.possel=r,e.exports.rowsel=o,e.exports.columnsel=n},{"backbone-thin":4,underscore:66}],78:[function(t,e){var n,i,r,o;r=t("./Selection"),o=t("underscore"),n=t("backbone-thin").Collection,e.exports=i=n.extend({model:r.sel,initialize:function(t,e){return null!=e?(this.g=e.g,this.listenTo(this.g,"residue:click",function(t){return this._handleE(t.evt,new r.possel({xStart:t.rowPos,xEnd:t.rowPos,seqId:t.seqId}))}),this.listenTo(this.g,"row:click",function(t){return this._handleE(t.evt,new r.rowsel({seqId:t.seqId}))}),this.listenTo(this.g,"column:click",function(t){return this._handleE(t.evt,new r.columnsel({xStart:t.rowPos,xEnd:t.rowPos+t.stepSize-1}))})):void 0},getSelForRow:function(t){return this.filter(function(e){return e.inRow(t)})},getSelForColumns:function(t){return this.filter(function(e){return e.inColumn(t)})},addJSON:function(t){return this.add(this._fromJSON(t))},_fromJSON:function(t){switch(t.type){case"column":return new r.columnsel(t);case"row":return new r.rowsel(t);case"pos":return new r.possel(t)}},resetJSON:function(t){return t=o.map(t,this._fromJSON),this.reset(t)},getBlocksForRow:function(t,e){var n,i,r,o,s,a,l,h;for(r=this.filter(function(e){return e.inRow(t)}),n=[],o=0,s=r.length;s>o;o++){if(i=r[o],"row"===i.attributes.type){n=function(){l=[];for(var t=0;e>=0?e>=t:t>=e;e>=0?t++:t--)l.push(t);return l}.apply(this);break}n=n.concat(function(){h=[];for(var t=a=i.attributes.xStart,e=i.attributes.xEnd;e>=a?e>=t:t>=e;e>=a?t++:t--)h.push(t);return h}.apply(this))}return n},getAllColumnBlocks:function(t){var e,n,i,r,s,a,l,h,u;for(i=t.maxLen,s=t.withPos,e=[],n=t.withPos?this.filter(function(t){return null!=t.get("xStart")}):this.filter(function(t){return"column"===t.get("type")}),a=0,l=n.length;l>a;a++)r=n[a],e=e.concat(function(){u=[];for(var t=h=r.attributes.xStart,e=r.attributes.xEnd;e>=h?e>=t:t>=e;e>=h?t++:t--)u.push(t);return u}.apply(this));return e=o.uniq(e)},invertRow:function(t){var e,n,i,s,a,l;for(s=this.where({type:"row"}),s=o.map(s,function(t){return t.attributes.seqId}),n=o.filter(t,function(t){return s.indexOf(t)>=0?!1:!0}),i=[],a=0,l=n.length;l>a;a++)e=n[a],i.push(new r.rowsel({seqId:e}));return this.reset(i)},invertCol:function(t){var e,n,i,s,a,l,h,u;if(s=this.where({type:"column"}),s=o.reduce(s,function(t,e){var n,i;return t.concat(function(){i=[];for(var t=n=e.attributes.xStart,r=e.attributes.xEnd;r>=n?r>=t:t>=r;r>=n?t++:t--)i.push(t);return i}.apply(this))},[]),n=o.filter(t,function(t){return s.indexOf(t)>=0?!1:!0}),0!==n.length){for(i=[],l=a=n[0],h=0,u=n.length;u>h;h++)e=n[h],a+1===e?a=e:(i.push(new r.columnsel({xStart:l,xEnd:a})),l=a=e);return l!==a&&i.push(new r.columnsel({xStart:l,xEnd:n[n.length-1]})),this.reset(i)}},_handleE:function(t,e){return t.ctrlKey||t.metaKey?this.add(e):this.reset([e])},_reduceColumns:function(){return this.each(function(t,e,n){var i,r,s,a,l,h,u,c,d,f,g;
for(i=o.filter(n,function(t){return"column"===t.get("type")}),u=t.get("xStart"),h=t.get("xEnd"),s=o.filter(i,function(t){return t.get("xEnd")===u-1}),c=0,f=s.length;f>c;c++)r=s[c],r.set("xEnd",u);for(l=o.filter(i,function(t){return t.get("xStart")===h+1}),d=0,g=l.length;g>d;d++)a=l[d],a.set("xStart",h);return s.length>0||l.length>0?(console.log("removed el"),t.collection.remove(t)):void 0})}})},{"./Selection":77,"backbone-thin":4,underscore:66}],79:[function(t,e){var n,i;i=t("backbone-thin").Model,e.exports=n=i.extend({defaults:{searchText:""}})},{"backbone-thin":4}],80:[function(t,e){var n,i;n=t("backbone-thin").Model,e.exports=i=n.extend({defaults:{searchBox:-10,overviewBox:30,headerBox:-1,alignmentBody:0}})},{"backbone-thin":4}],81:[function(t,e){var n,i;n=t("backbone-thin").Model,e.exports=i=n.extend({defaults:{sequences:!0,markers:!0,metacell:!1,conserv:!1,overviewbox:!1,seqlogo:!1,gapHeader:!1,leftHeader:!0,labels:!0,labelName:!0,labelId:!0,labelPartition:!1,labelCheckbox:!1,metaGaps:!0,metaIdentity:!0,metaLinks:!0},constructor:function(t,e){return this.calcDefaults(e.model),n.apply(this,arguments)},initialize:function(){return this.listenTo(this,"change:metaLinks change:metaIdentity change:metaGaps",function(){return this.trigger("change:metacell")},this),this.listenTo(this,"change:labelName change:labelId change:labelPartition change:labelCheckbox",function(){return this.trigger("change:labels")},this),this.listenTo(this,"change:markers change:conserv change:seqlogo change:gapHeader",function(){return this.trigger("change:header")},this)},calcDefaults:function(t){var e,n;return console.log(t),t.length>0&&(n=t.at(0),e=n.get("ids"),void 0!==e&&0===Object.keys(e).length)?this.defaults.metaLinks=!1:void 0}})},{"backbone-thin":4}],82:[function(t,e){var n,i;n=t("backbone-thin").Model,e.exports=i=n.extend({constructor:function(t,e){return this.calcDefaults(e.model),n.apply(this,arguments),this.g=e.g,this.listenTo(this,"change:labelIdLength change:labelNameLength change:labelPartLength change:labelCheckLength",function(){return this.trigger("change:labelWidth",this.getLabelWidth())},this),this.listenTo(this,"change:metaLinksWidth change:metaIdentWidth change:metaGapWidth",function(){return this.trigger("change:metaWidth",this.getMetaWidth())},this),this},defaults:{alignmentWidth:"auto",alignmentHeight:225,columnWidth:15,rowHeight:15,autoResize:!0,textVisible:!0,labelIdLength:30,labelNameLength:100,labelPartLength:15,labelCheckLength:15,labelFontsize:13,labelLineHeight:"13px",markerFontsize:"10px",stepSize:1,markerStepSize:2,markerHeight:20,residueFont:"13",canvasEventScale:1,boxRectHeight:2,boxRectWidth:2,overviewboxPaddingTop:10,menuFontsize:"14px",menuItemFontsize:"14px",menuItemLineHeight:"14px",menuMarginLeft:"3px",menuPadding:"3px 4px 3px 4px",metaGapWidth:35,metaIdentWidth:40,metaLinksWidth:25,_alignmentScrollLeft:0,_alignmentScrollTop:0},calcDefaults:function(t){var e;return e=t.getMaxLength(),200>e&&t.length<30?this.defaults.boxRectWidth=this.defaults.boxRectHeight=5:void 0},getAlignmentWidth:function(t){return this.get("autoResize")&&void 0!==t?this.get("columnWidth")*t:void 0===this.get("alignmentWidth")||"auto"===this.get("alignmentWidth")||0===this.get("alignmentWidth")?this._adjustWidth():this.get("alignmentWidth")},setLeftOffset:function(t){var e;return e=t,e=Math.max(0,e),e-=this.g.columns.calcHiddenColumns(e),this.set("_alignmentScrollLeft",e*this.get("columnWidth"))},setTopOffset:function(t){var e,n,i,r,o;for(r=Math.max(0,t-1),e=0,n=o=0;r>=o;n=o+=1)i=this.model.at(n),e+=i.attributes.height||1;return this.set("_alignmentScrollTop",e*this.get("rowHeight"))},getLeftBlockWidth:function(){var t;return t=0,this.g.vis.get("labels")&&(t+=this.getLabelWidth()),this.g.vis.get("metacell")&&(t+=this.getMetaWidth()),t},getMetaWidth:function(){var t;return t=0,this.g.vis.get("metaGaps")&&(t+=this.get("metaGapWidth")),this.g.vis.get("metaIdentity")&&(t+=this.get("metaIdentWidth")),this.g.vis.get("metaLinks")&&(t+=this.get("metaLinksWidth")),t},getLabelWidth:function(){var t;return t=0,this.g.vis.get("labelName")&&(t+=this.get("labelNameLength")),this.g.vis.get("labelId")&&(t+=this.get("labelIdLength")),this.g.vis.get("labelPartition")&&(t+=this.get("labelPartLength")),this.g.vis.get("labelCheckbox")&&(t+=this.get("labelCheckLength")),t},_adjustWidth:function(){var t,e,n,i;if(void 0!==this.el&&void 0!==this.model)return n=null!=this.el.parentNode&&0!==this.el.parentNode.offsetWidth?this.el.parentNode.offsetWidth:document.body.clientWidth-35,e=n-this.getLeftBlockWidth(),t=this.getAlignmentWidth(this.model.getMaxLength()-this.g.columns.get("hidden").length),i=Math.min(e,t),i=Math.floor(i/this.get("columnWidth"))*this.get("columnWidth"),this.attributes.alignmentWidth=i},autoResize:function(){return this.get("autoResize")?this._adjustWidth(this.el,this.model):void 0},autoHeight:function(t){var e;return e=this.getMaxAlignmentHeight(),void 0!==t&&t>0&&(e=Math.min(e,t)),this.set("alignmentHeight",e)},setEl:function(t,e){return this.el=t,this.model=e},_checkScrolling:function(t,e){var n,i;return n=t[0],i=t[1],this.set("_alignmentScrollLeft",n,e),this.set("_alignmentScrollTop",i,e)},getMaxAlignmentHeight:function(){var t;return t=0,this.model.each(function(e){return t+=e.attributes.height||1}),t*this.get("rowHeight")},getMaxAlignmentWidth:function(){return this.model.getMaxLength()*this.get("columnWidth")}})},{"backbone-thin":4}],83:[function(t,e){var n;n=t("./msa"),e.exports=function(){var t;return t=function(t){return n.apply(this,t)},t.prototype=n.prototype,new t(arguments)},e.exports.msa=n,e.exports.model=t("./model"),e.exports.menu=t("./menu"),e.exports.utils=t("./utils"),e.exports.selection=t("./g/selection/Selection"),e.exports.selcol=t("./g/selection/SelectionCol"),e.exports.view=t("backbone-viewj"),e.exports.boneView=t("backbone-childs"),e.exports._=t("underscore"),e.exports.$=t("jbone"),e.exports.io={},e.exports.io.xhr=t("xhr"),e.exports.io.fasta=t("biojs-io-fasta"),e.exports.io.clustal=t("biojs-io-clustal"),e.exports.io.gff=t("biojs-io-gff"),e.exports.version="0.2.0"},{"./g/selection/Selection":77,"./g/selection/SelectionCol":78,"./menu":85,"./model":101,"./msa":102,"./utils":106,"backbone-childs":2,"backbone-viewj":9,"biojs-io-clustal":"biojs-io-clustal","biojs-io-fasta":"biojs-io-fasta","biojs-io-gff":"biojs-io-gff",jbone:42,underscore:66,xhr:"xhr"}],84:[function(t,e){var n,i,r,o,s,a,l,h,u,c,d,f;f=t("backbone-childs"),l=t("./views/ImportMenu"),s=t("./views/FilterMenu"),c=t("./views/SelectionMenu"),d=t("./views/VisMenu"),n=t("./views/ColorMenu"),u=t("./views/OrderingMenu"),o=t("./views/ExtraMenu"),r=t("./views/ExportMenu"),a=t("./views/HelpMenu"),i=t("./views/DebugMenu"),e.exports=h=f.extend({initialize:function(t){return this.msa=t.msa,this.addView("10_import",new l({model:this.msa.seqs,g:this.msa.g,msa:this.msa})),this.addView("20_filter",new s({model:this.msa.seqs,g:this.msa.g})),this.addView("30_selection",new c({model:this.msa.seqs,g:this.msa.g})),this.addView("40_vis",new d({model:this.msa.seqs,g:this.msa.g})),this.addView("50_color",new n({model:this.msa.seqs,g:this.msa.g})),this.addView("60_ordering",new u({model:this.msa.seqs,g:this.msa.g})),this.addView("70_extra",new o({model:this.msa.seqs,g:this.msa.g,msa:this.msa})),this.addView("80_export",new r({model:this.msa.seqs,g:this.msa.g,msa:this.msa})),this.addView("90_help",new a({g:this.msa.g})),this.msa.g.config.get("debug")?this.addView("95_debug",new i({g:this.msa.g})):void 0},render:function(){return this.renderSubviews(),this.el.setAttribute("class","smenubar"),this.el.appendChild(document.createElement("p"))}})},{"./views/ColorMenu":87,"./views/DebugMenu":88,"./views/ExportMenu":89,"./views/ExtraMenu":90,"./views/FilterMenu":91,"./views/HelpMenu":92,"./views/ImportMenu":93,"./views/OrderingMenu":94,"./views/SelectionMenu":95,"./views/VisMenu":96,"backbone-childs":2}],85:[function(t,e){e.exports.defaultmenu=t("./defaultmenu"),e.exports.menubuilder=t("./menubuilder")},{"./defaultmenu":84,"./menubuilder":86}],86:[function(t,e){var n,i;i=t("menu-builder"),e.exports=n=i.extend({buildDOM:function(){return this.on("new:node",this.buildNode),this.on("new:button",this.buildButton),this.on("new:menu",this.buildMenu),i.prototype.buildDOM.call(this)},buildNode:function(t){return null!=this.g?t.style.lineHeight=this.g.zoomer.get("menuItemLineHeight"):void 0},buildButton:function(t){return null!=this.g?(t.style.fontSize=this.g.zoomer.get("menuFontsize"),t.style.marginLeft=this.g.zoomer.get("menuMarginLeft"),t.style.padding=this.g.zoomer.get("menuPadding")):void 0},buildMenu:function(t){return null!=this.g?t.style.fontSize=this.g.zoomer.get("menuItemFontsize"):void 0}})},{"menu-builder":44}],87:[function(t,e){var n,i,r,o;i=t("../menubuilder"),o=t("underscore"),r=t("dom-helper"),e.exports=n=i.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block",this.listenTo(this.g.colorscheme,"change",function(){return this.render()})},render:function(){var t,e,n,i,o,s;for(e=this.setName("Color scheme"),this.removeAllNodes(),t=this.getColorschemes(),o=0,s=t.length;s>o;o++)n=t[o],this.addScheme(e,n);return i="Background",i=this.g.colorscheme.get("colorBackground")?"Hide "+i:"Show "+i,this.addNode(i,function(t){return function(){return t.g.colorscheme.set("colorBackground",!t.g.colorscheme.get("colorBackground"))}}(this)),this.grey(e),r.removeAllChilds(this.el),this.el.appendChild(this.buildDOM()),this},addScheme:function(t,e){var n,i;return i={},n=this.g.colorscheme.get("scheme"),n===e.id&&(i.backgroundColor="#77ED80"),this.addNode(e.name,function(t){return function(){return t.g.colorscheme.set("scheme",e.id)}}(this),{style:i})},getColorschemes:function(){var t;return t=[],t.push({name:"Zappo",id:"zappo"}),t.push({name:"Taylor",id:"taylor"}),t.push({name:"Hydrophobicity",id:"hydro"}),t.push({name:"Lesk",id:"lesk"}),t.push({name:"Cinema",id:"cinema"}),t.push({name:"MAE",id:"mae"}),t.push({name:"Clustal",id:"clustal"}),t.push({name:"Clustal2",id:"clustal2"}),t.push({name:"Turn",id:"turn"}),t.push({name:"Strand",id:"strand"}),t.push({name:"Buried",id:"buried"}),t.push({name:"Helix",id:"helix"}),t.push({name:"Nucleotide",id:"nucleotide"}),t.push({name:"Purine",id:"purine"}),t.push({name:"PID",id:"pid"}),t.push({name:"No color",id:"foo"}),t},grey:function(){return this.addNode("Shade",function(t){return function(){return t.g.colorscheme.set("showLowerCase",!1),t.model.each(function(t){var e,n;return n=t.get("seq"),e=[],o.each(n,function(t,n){return t===t.toLowerCase()?e.push(n):void 0}),t.set("grey",e)})}}(this)),this.addNode("Shade by threshold",function(t){return function(){var e,n,i,r,o,s,a;for(o=prompt("Enter threshold (in percent)",20),o/=100,r=t.model.getMaxLength(),e=t.g.stats.scale(t.g.stats.conservation()),n=[],i=s=0,a=r-1;a>=0?a>=s:s>=a;i=a>=0?++s:--s)e[i]<o&&n.push(i);return t.model.each(function(t){return t.set("grey",n)})}}(this)),this.addNode("Shade selection",function(t){return function(){var e;return e=t.model.getMaxLength(),t.model.each(function(n){var i;return i=t.g.selcol.getBlocksForRow(n.get("id"),e),n.set("grey",i)})}}(this)),this.addNode("Reset shade",function(t){return function(){return t.g.colorscheme.set("showLowerCase",!0),t.model.each(function(t){return t.set("grey",[])})}}(this))}})},{"../menubuilder":86,"dom-helper":41,underscore:66}],88:[function(t,e){var n,i;i=t("../menubuilder"),e.exports=n=i.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block"},render:function(){return this.setName("Debug"),this.addNode("Get the code",function(){return function(){return window.open("https://github.com/greenify/msa")}}(this)),this.addNode("Toggle mouseover events",function(t){return function(){return t.g.config.set("registerMouseHover",!t.g.config.get("registerMouseHover")),t.g.onAll(function(){return console.log(arguments)})}}(this)),this.el.appendChild(this.buildDOM()),this}})},{"../menubuilder":86}],89:[function(t,e){var n,i,r,o,s;o=t("../menubuilder"),r=t("biojs-io-fasta").writer,s=t("underscore"),i=t("../../utils/export"),e.exports=n=o.extend({initialize:function(t){return this.g=t.g,this.msa=t.msa,this.el.style.display="inline-block"},render:function(){return this.setName("Export"),this.addNode("View in Jalview",function(t){return function(){var e;return e=t.g.config.get("url"),null==e?alert("Sequence weren't imported via an URL"):e.indexOf("localhost")?i.publishWeb(t.msa,function(e){return i.openInJalview(e,t.g.colorscheme.get("scheme"))}):i.openInJalview(e,t.g.colorscheme.get("scheme"))}}(this)),this.addNode("Publish to the web",function(t){return function(){return i.publishWeb(t.msa,function(t){return window.open(t,"_blank")})}}(this)),this.addNode("Share link",function(t){return function(){return i.shareLink(t.msa,function(t){return window.open(t,"_blank")})}}(this)),this.addNode("Export sequences",function(t){return function(){return i.saveAsFile(t.msa,"all.fasta")}}(this)),this.addNode("Export selection",function(t){return function(){return i.saveSelection(t.msa,"selection.fasta")}}(this)),this.addNode("Export features",function(t){return function(){return i.saveAnnots(t.msa,"features.gff3")}}(this)),this.addNode("Export image",function(t){return function(){return i.saveAsImg(t.msa,"biojs-msa.png")}}(this)),this.el.appendChild(this.buildDOM()),this}})},{"../../utils/export":104,"../menubuilder":86,"biojs-io-fasta":"biojs-io-fasta",underscore:66}],90:[function(t,e){var n,i,r,o,s;r=t("../menubuilder"),o=t("../../model/Sequence"),i=t("../../utils/loader"),s=t("xhr"),e.exports=n=r.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block",this.msa=t.msa},render:function(){var t,e;return this.setName("Extras"),e=this.g.stats,t=this.msa,this.addNode("Add consensus seq",function(t){return function(){var n,i;return n=e.consensus(),i=new o({seq:n,id:"0c",name:"consenus"}),t.model.add(i),t.model.setRef(i),t.model.comparator=function(t){return!t.get("ref")},t.model.sort()}}(this)),this.addNode("Calc Tree",function(){var e,n,r;return n="",e=i.joinCb(function(){return t.u.tree.showTree(r)},2,this),t.u.tree.loadTree(e),r={name:"root",children:[{name:"c1",branch_length:4,children:t.seqs.filter(function(t,e){return e%2===0})},{name:"c2",children:t.seqs.filter(function(t,e){return e%2===1}),branch_length:4}]},t.seqs.each(function(t){return t.set("branch_length",2)}),e()}),this.addNode("Increase font size",function(t){return function(){var e,n,i;return e=t.g.zoomer.get("columnWidth"),n=e+5,t.g.zoomer.set("columnWidth",n),t.g.zoomer.set("rowHeight",n),i=.7*n,t.g.zoomer.set("residueFont",i),t.g.zoomer.set("labelFontSize",i)}}(this)),this.addNode("Decrease font size",function(t){return function(){var e,n,i;return e=t.g.zoomer.get("columnWidth"),n=e-2,t.g.zoomer.set("columnWidth",n),t.g.zoomer.set("rowHeight",n),i=.6*n,t.g.zoomer.set("residueFont",i),t.g.zoomer.set("labelFontSize",i),t.g.zoomer.get("columnWidth")<8?t.g.zoomer.set("textVisible",!1):void 0}}(this)),this.addNode("Minimized width",function(t){return function(){return t.g.zoomer.set("alignmentWidth",600)}}(this)),this.addNode("Minimized height",function(t){return function(){return t.g.zoomer.set("alignmentHeight",120)}}(this)),this.addNode("Jump to a column",function(t){return function(){var e;return e=prompt("Column","20"),0>e||e>t.model.getMaxLength()||isNaN(e)?(alert("invalid column"),void 0):t.g.zoomer.setLeftOffset(e)}}(this)),this.el.appendChild(this.buildDOM()),this}})},{"../../model/Sequence":100,"../../utils/loader":107,"../menubuilder":86,xhr:"xhr"}],91:[function(t,e){var n,i,r;i=t("../menubuilder"),r=t("underscore"),e.exports=n=i.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block"},render:function(){return this.setName("Filter"),this.addNode("Hide columns by threshold",function(t){return function(){var e,n,i,r,o,s,a;for(o=prompt("Enter threshold (in percent)",20),o/=100,r=t.model.getMaxLength(),n=[],e=t.g.stats.scale(t.g.stats.conservation()),i=s=0,a=r-1;a>=0?a>=s:s>=a;i=a>=0?++s:--s)e[i]<o&&n.push(i);return t.g.columns.set("hidden",n)}}(this)),this.addNode("Hide columns by selection",function(t){return function(){var e,n;return n=t.g.columns.get("hidden"),e=n.concat(t.g.selcol.getAllColumnBlocks({maxLen:t.model.getMaxLength(),withPos:!0})),t.g.selcol.reset([]),t.g.columns.set("hidden",e)}}(this)),this.addNode("Hide columns by gaps",function(t){return function(){var e,n,i,r,o,s,a,l,h;for(s=prompt("Enter threshold (in percent)",20),s/=100,o=t.model.getMaxLength(),i=[],r=l=0,h=o-1;h>=0?h>=l:l>=h;r=h>=0?++l:--l)n=0,a=0,t.model.each(function(t){return"-"===t.get("seq")[r]&&n++,a++}),e=n/a,e>s&&i.push(r);return t.g.columns.set("hidden",i)}}(this)),this.addNode("Hide seqs by identity",function(t){return function(){var e;return e=prompt("Enter threshold (in percent)",20),e/=100,t.model.each(function(t){return t.get("identity")<e?t.set("hidden",!0):void 0})}}(this)),this.addNode("Hide seqs by selection",function(t){return function(){var e,n;return e=t.g.selcol.where({type:"row"}),n=r.map(e,function(t){return t.get("seqId")}),t.g.selcol.reset([]),t.model.each(function(t){return n.indexOf(t.get("id"))>=0?t.set("hidden",!0):void 0})}}(this)),this.addNode("Hide seqs by gaps",function(t){return function(){var e;return e=prompt("Enter threshold (in percent)",40),t.model.each(function(t){var n,i;return i=t.get("seq"),n=r.reduce(i,function(t,e){return"-"===e&&t++,t},0),n>e?t.set("hidden",!0):void 0})}}(this)),this.addNode("Reset",function(t){return function(){return t.g.columns.set("hidden",[]),t.model.each(function(t){return t.get("hidden")?t.set("hidden",!1):void 0})}}(this)),this.el.appendChild(this.buildDOM()),this}})},{"../menubuilder":86,underscore:66}],92:[function(t,e){var n,i;i=t("../menubuilder"),e.exports=n=i.extend({initialize:function(t){return this.g=t.g},render:function(){return this.setName("Help"),this.addNode("About the project",function(){return function(){return window.open("https://github.com/greenify/msa")}}(this)),this.addNode("Report issues",function(){return function(){return window.open("https://github.com/greenify/msa/issues")}}(this)),this.addNode("User manual",function(){return function(){return window.open("https://github.com/greenify/msa/wiki")}}(this)),this.el.style.display="inline-block",this.el.appendChild(this.buildDOM()),this}})},{"../menubuilder":86}],93:[function(t,e){var n,i,r;i=t("../menubuilder"),r=t("koala-js"),e.exports=n=i.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block",this.msa=t.msa},render:function(){var t,e;return t=this.msa,e=r.mk("input"),e.type="file",e.style.display="none",e.multiple=!0,e.addEventListener("change",function(){var n;return n=e.files||[],t.u.file.importFiles(n)}),this.el.appendChild(e),this.setName("Import"),this.addNode("URL",function(t){return function(){var e;return e=prompt("URL","http://rostlab.org/~goldberg/clustalw2-I20140818-215249-0556-53699878-pg.clustalw"),t.msa.u.file.importURL(e,function(){})}}(this)),this.addNode("From file",function(){return function(){return e.click()}}(this)),this.addNode("Drag & Drop",function(){return function(){return alert("Yep. Just drag & drop your file")}}(this)),this.el.appendChild(this.buildDOM()),this}})},{"../menubuilder":86,"koala-js":43}],94:[function(t,e){var n,i,r,o;n=t("../menubuilder"),r=t("dom-helper"),o=t("underscore"),e.exports=i=n.extend({initialize:function(t){return this.g=t.g,this.order="ID",this.el.style.display="inline-block"},setOrder:function(t){return this.order=t,this.render()},render:function(){var t,e,n,i,o;for(this.setName("Ordering"),this.removeAllNodes(),t=this.getComparators(),i=0,o=t.length;o>i;i++)n=t[i],this._addNode(n);return e=this.buildDOM(),r.removeAllChilds(this.el),this.el.appendChild(e),this},_addNode:function(t){var e,n;return n=t.text,e={},n===this.order&&(e.backgroundColor="#77ED80"),this.addNode(n,function(e){return function(){return null!=t.precode&&t.precode(),e.model.comparator=t.comparator,e.model.sort(),e.setOrder(t.text)}}(this),{style:e})},getComparators:function(){var t,e;return t=[],t.push({text:"ID",comparator:"id"}),t.push({text:"ID Desc",comparator:function(t,e){return-(""+t.get("id")).localeCompare(""+e.get("id"),[],{numeric:!0})}}),t.push({text:"Label",comparator:"name"}),t.push({text:"Label Desc",comparator:function(t,e){return-t.get("name").localeCompare(e.get("name"))}}),t.push({text:"Seq",comparator:"seq"}),t.push({text:"Seq Desc",comparator:function(t,e){return-t.get("seq").localeCompare(e.get("seq"))}}),e=function(t){return function(){return t.ident=t.g.stats.identity()}}(this),t.push({text:"Identity",comparator:function(t){return function(e,n){var i;return i=t.ident[e.id]-t.ident[n.id],i>0?1:0>i?-1:0}}(this),precode:e}),t.push({text:"Identity Desc",comparator:function(t){return function(e,n){var i;return i=t.ident[e.id]-t.ident[n.id],i>0?-1:0>i?1:0}}(this),precode:e}),t.push({text:"Reference",comparator:function(t){return!t.get("ref")}}),t.push({text:"Partition codes",comparator:"partition",precode:function(t){return function(){return t.g.vis.set("labelPartition",!0),t.model.each(function(t){return t.set("partition",o.random(1,3))})}}(this)}),t}})},{"../menubuilder":86,"dom-helper":41,underscore:66}],95:[function(t,e){var n,i;n=t("../menubuilder"),e.exports=i=n.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block"},render:function(){return this.setName("Selection"),this.addNode("Find Motif (supports RegEx)",function(t){return function(){var e;return e=prompt("your search","D"),t.g.user.set("searchText",e)}}(this)),this.addNode("Invert columns",function(t){return function(){var e;return t.g.selcol.invertCol(function(){e=[];for(var n=0,i=t.model.getMaxLength();i>=0?i>=n:n>=i;i>=0?n++:n--)e.push(n);return e}.apply(this))}}(this)),this.addNode("Invert rows",function(t){return function(){return t.g.selcol.invertRow(t.model.pluck("id"))}}(this)),this.addNode("Reset",function(t){return function(){return t.g.selcol.reset()}}(this)),this.el.appendChild(this.buildDOM()),this}})},{"../menubuilder":86}],96:[function(t,e){var n,i,r;n=t("../menubuilder"),r=t("dom-helper"),e.exports=i=n.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block",this.listenTo(this.g.vis,"change",this.render)},render:function(){var t,e,n,i;for(this.removeAllNodes(),this.setName("Vis.elements"),e=this.getVisElements(),n=0,i=e.length;i>n;n++)t=e[n],this._addVisEl(t);return this.addNode("Reset",function(t){return function(){return t.g.vis.set("labels",!0),t.g.vis.set("sequences",!0),t.g.vis.set("metacell",!0),t.g.vis.set("conserv",!0),t.g.vis.set("labelId",!0),t.g.vis.set("labelName",!0),t.g.vis.set("labelCheckbox",!1),t.g.vis.set("seqlogo",!1),t.g.vis.set("gapHeader",!1),t.g.vis.set("leftHeader",!0),t.g.vis.set("metaGaps",!0),t.g.vis.set("metaIdentity",!0),t.g.vis.set("metaLinks",!0)}}(this)),r.removeAllChilds(this.el),this.el.appendChild(this.buildDOM()),this},_addVisEl:function(t){var e,n;return n={},this.g.vis.get(t.id)?(e="Hide ",n.color="red"):(e="Show ",n.color="green"),this.addNode(e+t.name,function(e){return function(){return e.g.vis.set(t.id,!e.g.vis.get(t.id))}}(this),{style:n})},getVisElements:function(){var t;return t=[],t.push({name:"Markers",id:"markers"}),t.push({name:"Labels",id:"labels"}),t.push({name:"Meta info",id:"metacell"}),t.push({name:"Overviewbox",id:"overviewbox"}),t.push({name:"Conserv",id:"conserv"}),t.push({name:"Seq. logo",id:"seqlogo"}),t.push({name:"Gap Header",id:"gapHeader"}),t.push({name:"Left header",id:"leftHeader"}),t.push({name:"Label name",id:"labelName"}),t.push({name:"Label id",id:"labelId"}),t.push({name:"Label checkbox",id:"labelCheckbox"}),t.push({name:"Meta gaps",id:"metaGaps"}),t.push({name:"Meta identity",id:"metaIdentity"}),t.push({name:"Meta links",id:"metaLinks"}),t}})},{"../menubuilder":86,"dom-helper":41}],97:[function(t,e){var n,i;n=t("./Feature"),i=t("backbone-thin").Model,e.exports=n=i.extend({defaults:{xStart:-1,xEnd:-1,height:-1,text:"",fillColor:"red",fillOpacity:.5,type:"rectangle",borderSize:1,borderColor:"black",borderOpacity:.5,validate:!0,row:0},initialize:function(t){return null!=t.start&&this.set("xStart",t.start),null!=t.end&&this.set("xEnd",t.end),null!=t.attributes&&(null!=t.attributes.Name&&this.set("text",t.attributes.Name),null!=t.attributes.Color&&this.set("fillColor",t.attributes.Color)),this.attributes.xEnd<this.attributes.xStart&&console.warn("invalid feature range for",this.attributes),_.isNumber(this.attributes.xStart)&&_.isNumber(this.attributes.xEnd)?void 0:(console.warn("please provide numeric feature ranges",t),this.set("xStart",parseInt(this.attributes.xStart)),this.set("xEnd",parseInt(this.attributes.xEnd)))},validate:function(){return isNaN(this.attributes.xStart||isNaN(this.attributes.xEnd))?"features need integer start and end.":void 0},contains:function(t){return this.attributes.xStart<=t&&t<=this.attributes.xEnd}})},{"./Feature":97,"backbone-thin":4}],98:[function(t,e){var n,i,r,o;i=t("./Feature"),n=t("backbone-thin").Collection,o=t("underscore"),e.exports=r=n.extend({model:i,constructor:function(){return this.startOnCache=[],this.on("all",function(){return this.startOnCache=[]},this),n.apply(this,arguments)},startOn:function(t){return null==this.startOnCache[t]&&(this.startOnCache[t]=this.where({xStart:t})),this.startOnCache[t]},contains:function(t){return this.reduce(function(e,n){return n||e.contains(t)},!1)},getFeatureOnRow:function(t,e){return this.filter(function(n){return n.get("row")===t&&n.get("xStart")<=e&&e<=n.get("xEnd")})},assignRows:function(){var t,e,n;return t=this.max(function(t){return t.get("xEnd")}).attributes.xEnd,e=function(){var e,i;for(i=[],n=e=0;t>=0?t>=e:e>=t;n=t>=0?++e:--e)i.push(0);return i}(),this.each(function(t){var i,r,o,s;for(i=0,n=r=o=t.get("xStart"),s=t.get("xEnd");s>=r;n=r+=1)e[n]>i&&(i=e[n]),e[n]++;return t.set("row",i)}),o.max(e)},getCurrentHeight:function(){return this.max(function(t){return t.get("row")}).attributes.row+1},getMinRows:function(){var t,e,n;return t=this.max(function(t){return t.get("xEnd")}).attributes.xEnd,e=function(){var e,i;for(i=[],n=e=0;t>=0?t>=e:e>=t;n=t>=0?++e:--e)i.push(0);return i}(),this.each(function(t){var i,r,o,s;for(s=[],n=i=r=t.get("xStart"),o=t.get("xEnd");o>=i;n=i+=1)s.push(e[n]++);return s}),o.max(e)}})},{"./Feature":97,"backbone-thin":4,underscore:66}],99:[function(t,e){var n,i,r,o;o=t("./Sequence"),i=t("./FeatureCol"),n=t("backbone-thin").Collection,e.exports=r=n.extend({model:o,constructor:function(t,e){return n.apply(this,arguments),this.g=e,this.on("add reset remove",function(t){return function(){return t.lengthCache=null,t._bindSeqsWithFeatures()}}(this),this),this.on("reset",function(t){return function(){return t._autoSetRefSeq()}}(this)),this._autoSetRefSeq(),this.lengthCache=null,this.features={},this},getMaxLength:function(){return 0===this.models.length?0:(null===this.lengthCache&&(this.lengthCache=this.max(function(t){return t.get("seq").length}).get("seq").length),this.lengthCache)},prev:function(t,e){var n;return n=this.indexOf(t)-1,0>n&&e&&(n=this.length-1),this.at(n)},next:function(t,e){var n;return n=this.indexOf(t)+1,n===this.length&&e&&(n=0),this.at(n)},calcHiddenSeqs:function(t){var e,n,i;for(n=t,e=i=0;n>=0?n>=i:i>=n;e=n>=0?++i:--i)this.at(e).get("hidden")&&n++;return n-t},addFeatures:function(t){var e,n;return null!=t.config&&(n=t,t=t.seqs,null!=n.config.colors&&(e=n.config.colors,_.each(t,function(t){return _.each(t,function(t){return null!=e[t.feature]?t.fillColor=e[t.feature]:void 0})}))),_.isEmpty(this.features)?this.features=t:_.each(t,function(t){return function(e,n){return t.features[n]=t.features.hasOwnProperty(n)?_.union(t.features[n],e):e}}(this)),this._bindSeqsWithFeatures()},_bindSeqWithFeatures:function(t){var e;return e=this.features[t.attributes.name],e?(t.set("features",new i(e)),t.attributes.features.assignRows(),t.set("height",t.attributes.features.getCurrentHeight()+1)):void 0},_bindSeqsWithFeatures:function(){return this.each(function(t){return function(e){return t._bindSeqWithFeatures(e)}}(this))},removeAllFeatures:function(){return delete this.features},_autoSetRefSeq:function(){return this.length>0?this.at(0).set("ref",!0):void 0},setRef:function(t){var e;return e=this.get(t),this.each(function(n){return t.cid?e.cid===n.cid?n.set("ref",!0):n.set("ref",!1):void 0}),this.g.config.set("hasRef",!0),this.trigger("change:reference",t)}})},{"./FeatureCol":98,"./Sequence":100,"backbone-thin":4}],100:[function(t,e){var n,i,r;i=t("backbone-thin").Model,n=t("./FeatureCol"),e.exports=r=i.extend({defaults:{name:"",id:"",seq:"",height:1,ref:!1},initialize:function(){return this.set("grey",[]),null==this.get("features")?this.set("features",new n):void 0}})},{"./FeatureCol":98,"backbone-thin":4}],101:[function(t,e){e.exports.seq=t("./Sequence"),e.exports.seqcol=t("./SeqCollection"),e.exports.feature=t("./Feature"),e.exports.featurecol=t("./FeatureCol")},{"./Feature":97,"./FeatureCol":98,"./SeqCollection":99,"./Sequence":100}],102:[function(t,e){var n,i,r,o,s,a,l,h,u,c,d,f,g,m,p,v,b,x;c=t("./model/SeqCollection"),i=t("./g/colorscheme"),r=t("./g/columns"),o=t("./g/config"),l=t("./g/package"),u=t("./g/selection/SelectionCol"),m=t("./g/user"),v=t("./g/visibility"),p=t("./g/visOrdering"),b=t("./g/zoomer"),x=t("backbone-childs"),s=t("biojs-events"),d=t("./views/Stage"),f=t("stat.seqs"),n=t("jbone"),a=t("./utils/file"),g=t("./utils/tree"),h=t("./utils/proxy"),e.exports=x.extend({initialize:function(t){var e,x,w,y,_,S;return null==t&&(t={}),null==t.colorscheme&&(t.colorscheme={}),null==t.columns&&(t.columns={}),null==t.conf&&(t.conf={}),null==t.vis&&(t.vis={}),null==t.zoomer&&((null!=(S=t.visorder)?S:t.zoomer={})||(t.visorder={})),this.g=s.mixin({}),this.seqs=new c(t.seqs,this.g),this.g.config=new o(t.conf),this.g["package"]=new l(this.g),this.g.selcol=new u([],{g:this.g}),this.g.user=new m,this.g.vis=new v(t.vis,{model:this.seqs}),this.g.visorder=new p(t.visorder),this.g.zoomer=new b(t.zoomer,{g:this.g,model:this.seqs}),"localhost"===window.location.hostname&&this.g.config.set("debug",!0),y=this.seqs.pluck("seq"),this.g.stats=new f(this.seqs),this.g.stats.alphabetSize=this.g.config.get("alphabetSize"),this.g.columns=new r(t.columns,this.g.stats),this.g.colorscheme=new i(t.colorscheme,y,this.g.stats),this.g.zoomer.setEl(this.el,this.seqs),this.addView("stage",new d({model:this.seqs,g:this.g})),this.el.setAttribute("class","biojs_msa_div"),this.u={},this.u.file=new a(this),this.u.proxy=new h({g:this.g}),this.u.tree=new g(this),this.g.config.get("eventBus")===!0&&this.startEventBus(),this.g.config.get("dropImport")&&(x={dragover:this.dragOver,drop:this.dropFile},this.delegateEvents(x)),t.importURL&&this.u.file.importURL(t.importURL,function(t){return function(){return t.render()}}(this)),t.bootstrapMenu&&(w=document.createElement("div"),_=document.createElement("div"),this.el.parentNode?(this.el.parentNode.replaceChild(_,this.el),_.appendChild(w),_.appendChild(this.el)):(_.appendChild(w),_.appendChild(this.el)),e=new msa.menu.defaultmenu({el:w,msa:this}),e.render()),n(window).on("resize",function(t){return function(){var e;return e=function(){return this.g.zoomer.autoResize()},setTimeout(e.bind(t),5)}}(this))},dragOver:function(t){return t.preventDefault(),t.target.className="hover",!1},dropFile:function(t){var e;return t.preventDefault(),e=t.target.files||t.dataTransfer.files,this.u.file.importFiles(e),!1},startEventBus:function(){var t,e,n,i,r;for(t=["config","columns","colorscheme","selcol","vis","visorder","zoomer"],r=[],n=0,i=t.length;i>n;n++)e=t[n],r.push(this._proxyToG(e));return r},_proxyToG:function(t){return this.listenTo(this.g[t],"all",function(e,n,i,r){return"change"!==e?null!=r?this.g.trigger(t+":"+e,i,n,r):this.g.trigger(t+":"+e,i,n):void 0})},render:function(){return(void 0===this.seqs||0===this.seqs.length)&&console.log("warning. empty seqs."),this.renderSubviews(),this.g.vis.set("loaded",!0),this}})},{"./g/colorscheme":73,"./g/columns":74,"./g/config":75,"./g/package":76,"./g/selection/SelectionCol":78,"./g/user":79,"./g/visOrdering":80,"./g/visibility":81,"./g/zoomer":82,"./model/SeqCollection":99,"./utils/file":105,"./utils/proxy":108,"./utils/tree":111,"./views/Stage":115,"backbone-childs":2,"biojs-events":13,jbone:42,"stat.seqs":65}],103:[function(t,e){var n;
e.exports=n=function(){function t(){}return t.randomInt=function(t,e){var n,i;return null==e&&(n=[0,t],t=n[0],e=n[1]),t>e&&(i=[e,t],t=i[0],e=i[1]),Math.floor(Math.random()*(e-t+1)+t)},t.uniqueId=function(t){var e;for(null==t&&(t=8),e="";e.length<t;)e+=Math.random().toString(36).substr(2);return e.substr(0,t)},t.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t}()},{}],104:[function(t,e){var n,i,r,o,s,a,l;i=t("biojs-io-fasta"),r=t("biojs-io-gff"),a=t("xhr"),o=t("blueimp_canvastoblob"),s=t("browser-saveas"),l=t("underscore"),e.exports=n={openInJalview:function(t,e){var n,i;return"."===t.charAt(0)&&(t=document.URL.substr(0,document.URL.lastIndexOf("/"))+"/"+t),t.indexOf("http")<0&&(n="http://"+window.location.hostname,t=n+t),t=encodeURIComponent(t),i="http://www.jalview.org/services/launchApp?open="+t,i+="&colour="+e,window.open(i,"_blank")},publishWeb:function(t,e){var n,r;return n=i.write(t.seqs.toJSON()),n=encodeURIComponent(n),r=t.u.proxy.corsURL("http://sprunge.biojs.net"),a({method:"POST",body:"sprunge="+n,uri:r,headers:{"Content-Type":"application/x-www-form-urlencoded"}},function(t,n,i){var r;return r=i.trim(),e(r)})},shareLink:function(t,e){var i,r,o;return o=t.g.config.get("importURL"),r="http://biojs-msa.org/app/?seq=",i=function(t){var n;return n=r+t,e?e(n):void 0},o?i(o):n.publishWeb(t,i)},saveAsFile:function(t,e){var n,r;return r=i.write(t.seqs.toJSON()),n=new Blob([r],{type:"text/plain"}),s(n,e)},saveSelection:function(t,e){var n,r,o,a,h,u;if(o=t.g.selcol.pluck("seqId"),console.log(o),o.length>0)for(o=t.seqs.filter(function(t){return l.contains(o,t.get("id"))}),r=h=0,u=o.length-1;u>=h;r=h+=1)o[r]=o[r].toJSON();else o=t.seqs.toJSON(),console.warn("no selection found");return a=i.write(o),n=new Blob([a],{type:"text/plain"}),s(n,e)},saveAnnots:function(t,e){var n,i,o;return i=t.seqs.map(function(t){var e;return i=t.get("features"),0!==i.length?(e=t.get("name"),i.each(function(t){return t.set("seqname",e)}),i.toJSON()):void 0}),i=l.flatten(l.compact(i)),console.log(i),o=r.exportLines(i),n=new Blob([o],{type:"text/plain"}),s(n,e)},saveAsImg:function(t,e){var n,i;return n=t.getView("stage").getView("body").getView("seqblock").el,null!=n?(i=n.toDataURL("image/png"),s(o(i),e,"image/png")):void 0}}},{"biojs-io-fasta":"biojs-io-fasta","biojs-io-gff":"biojs-io-gff",blueimp_canvastoblob:38,"browser-saveas":39,underscore:66,xhr:"xhr"}],105:[function(t,e){var n,i,r,o,s,a,l;i=t("biojs-io-fasta"),n=t("biojs-io-clustal"),o=t("biojs-io-gff"),l=t("underscore"),a=t("xhr"),e.exports=r=function(t){return this.msa=t,this},s={guessFileType:function(t){var e;switch(t=t.split("."),e=t[t.length(-1)]){case"aln":case"clustal":return n;case"fasta":return i;default:return i}},guessFileFromText:function(t){var e,r;return null==t?(console.warn("invalid file format"),["","error"]):("CLUSTAL"===t.substring(0,7)?(e=n,r="seqs"):">"===t.substring(0,1)?(e=i,r="seqs"):"("===t.substring(0,1)?r="newick":(e=o,r="features"),[e,r])},parseText:function(t){var e,n,i,r,o;return o=this.guessFileFromText(t),n=o[0],r=o[1],"seqs"===r?(i=n.parse(t),[i,r]):"features"===r?(e=n.parseSeqs(t),[e,r]):[t,r]},importFiles:function(t){var e,n,i,r,o,s;for(s=[],n=r=0,o=t.length-1;o>=r;n=r+=1)e=t[n],i=new FileReader,i.onload=function(t){return function(e){return t.importFile(e.target.result)}}(this),s.push(i.readAsText(e));return s},importFile:function(t){var e,n,i,r;return r=this.parseText(t),n=r[0],i=r[1],"error"===i?"error":("seqs"===i?(this.msa.seqs.reset(n),this.msa.g.config.set("url","userimport"),this.msa.g.trigger("url:userImport")):"features"===i?this.msa.seqs.addFeatures(n):"newick"===i&&this.msa.u.tree.loadTree(function(e){return function(){return e.msa.u.tree.showTree(t)}}(this)),e=t.name)},importURL:function(t,e){return t=this.msa.u.proxy.corsURL(t),this.msa.g.config.set("url",t),a(t,function(n){return function(i,r,o){var s;if(i)return console.log(i);if(s=n.importFile(o),"error"!==s)return n.msa.g.trigger("import:url",t),e?e():void 0}}(this))}},l.extend(r.prototype,s)},{"biojs-io-clustal":"biojs-io-clustal","biojs-io-fasta":"biojs-io-fasta","biojs-io-gff":"biojs-io-gff",underscore:66,xhr:"xhr"}],106:[function(t,e){e.exports.bmath=t("./bmath"),e.exports.proxy=t("./proxy"),e.exports.seqgen=t("./seqgen"),e.exports.file=t("./file"),e.exports["export"]=t("./export")},{"./bmath":103,"./export":104,"./file":105,"./proxy":108,"./seqgen":109}],107:[function(t,e){var n,i,r=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};n=t("koala-js"),e.exports=i={loadScript:function(t,e){var i,r;return i=n.mk("script"),i.type="text/javascript",i.src=t,i.async=!0,i.onload=i.onreadystatechange=function(){var t;return t||this.readyState&&"complete"!==this.readyState?void 0:(t=!0,e())},r=document.getElementsByTagName("script")[0],r.parentNode.appendChild(i)},joinCb:function(t,e,n){var i,o,s;return e=e||1,o=0,i=function(t,e){return null==t?s():function(){return r.call(t,"apply")>=0&&t.apply(e,arguments),s()}},s=function(){return o++,o===e?t.call(n):void 0},i}}},{"koala-js":43}],108:[function(t,e){var n,i,r;r=t("underscore"),e.exports=n=function(t){return this.g=t.g,this},i={corsURL:function(t){return document.URL.indexOf("localhost")>=0&&"/"===t[0]?t:"."===t.charAt(0)||"/"===t.charAt(0)?t:(t=t.replace("www.",""),t=t.replace("http://",""),t=this.g.config.get("importProxy")+t)}},r.extend(n.prototype,i)},{underscore:66}],109:[function(t,e){var n,i,r,o;i=t("biojs-model").seq,n=t("./bmath"),r=t("stat.seqs"),o=e.exports={_generateSequence:function(t){var e,n,i,r;for(n="",e=i=0,r=t-1;r>=i;e=i+=1)n+=o.getRandomChar();return n},getDummySequences:function(t,e){var r,s,a;for(s=[],null==t&&(t=n.getRandomInt(3,5)),null==e&&(e=n.getRandomInt(50,200)),r=a=1;t>=a;r=a+=1)s.push(new i(o._generateSequence(e),"seq"+r,"r"+r));return s},getRandomChar:function(t){var e;return e=t||"ABCDEFGHIJKLMNOPQRSTUVWXYZ",e.charAt(Math.floor(Math.random()*e.length))},genConservedSequences:function(t,e,s){var a,l,h,u,c,d,f,g,m,p,v,b,x,w,y,_;for(m=[],null==t&&(t=n.getRandomInt(3,5)),null==e&&(e=n.getRandomInt(50,200)),s=s||"ACDEFGHIKLMNPQRSTVWY---",c=v=1;t>=v;c=v+=1)m[c-1]="";for(p=.2,h=1,c=b=0,y=e-1;y>=b;c=b+=1)for(c%3===0&&(h=n.getRandomInt(50,100)/100),f=[],d=x=0,_=t-1;_>=x;d=x+=1){for(u=0;100>u&&(a=o.getRandomChar(s),l=r(f),l.addSeq(a),u++,!(Math.abs(h-l.scale(l.conservation())[0])<p)););m[d]+=a,f.push(a)}for(g=[],c=w=1;t>=w;c=w+=1)g.push(new i(m[c-1],"seq"+c,"r"+c));return g}}},{"./bmath":103,"biojs-model":21,"stat.seqs":65}],110:[function(t,e){var n,i,r,o,s,a;a="http://www.w3.org/2000/svg",s=function(t,e){var n,i;for(n in e)i=e[n],t.setAttributeNS(null,n,i);return t},n=function(t){var e;return e=document.createElementNS(a,"svg"),e.setAttribute("width",t.width),e.setAttribute("height",t.height),e},o=function(t){var e;return e=document.createElementNS(a,"rect"),s(e,t)},i=function(t){var e;return e=document.createElementNS(a,"line"),s(e,t)},r=function(t){var e;return e=document.createElementNS(a,"polygon"),s(e,t)},e.exports.rect=o,e.exports.line=i,e.exports.polygon=r,e.exports.base=n},{}],111:[function(t,e){var n,i,r;r=t("underscore"),e.exports=i=function(t){return this.msa=t,this},n={loadTree:function(t){return this.msa.g["package"].loadPackages(["msa-tnt","biojs-io-newick"],t)},showTree:function(t){var e,n,i,r,o,s,a;return n=this.require("biojs-io-newick"),i="string"==typeof t?n.parse_newick(t):t,e=this.require("msa-tnt"),o=new e.selections,a=document.createElement("div"),document.body.appendChild(a),console.log(this.msa.seqs.models),console.log(i),r=e.app({seqs:this.msa.seqs.models,tree:i}),console.log("nodes",r),s=new e.adapters.tree({model:r,el:a,sel:o}),a.style.width="500px"},require:function(e){return t(e)}},r.extend(i.prototype,n)},{underscore:66}],112:[function(t,e){var n,i,r;r=t("backbone-childs"),i=t("./canvas/CanvasSeqBlock"),n=t("./labels/LabelBlock"),e.exports=r.extend({initialize:function(t){var e,r;return this.g=t.g,e=new n({model:this.model,g:this.g}),e.ordering=-1,this.addView("labelblock",e),this.g.vis.get("sequences")&&(r=new i({model:this.model,g:this.g}),r.ordering=0,this.addView("seqblock",r)),this.listenTo(this.g.zoomer,"change:alignmentHeight",this.adjustHeight),this.listenTo(this.g.zoomer,"change:alignmentWidth",this.adjustWidth),this.listenTo(this.g.columns,"change:hidden",this.adjustHeight)},render:function(){return this.renderSubviews(),this.el.className="biojs_msa_albody",this.el.style.whiteSpace="nowrap",this.adjustHeight(),this.adjustWidth(),this},adjustHeight:function(){return this.el.style.height="auto"===this.g.zoomer.get("alignmentHeight")?this.g.zoomer.get("rowHeight")*this.model.length+5:this.g.zoomer.get("alignmentHeight")},adjustWidth:function(){return this.el.style.width=this.getWidth()},getWidth:function(){var t;return t=0,t+=this.g.zoomer.getLeftBlockWidth(),this.g.vis.get("sequences")&&(t+=this.g.zoomer.get("alignmentWidth")),t}})},{"./canvas/CanvasSeqBlock":119,"./labels/LabelBlock":128,"backbone-childs":2}],113:[function(t,e){var n,i,r,o,s,a;s=t("backbone-viewj"),r=t("mouse-pos"),o=t("../g/selection/Selection"),i=t("jbone"),a=t("underscore"),e.exports=n=s.extend({className:"biojs_msa_overviewbox",tagName:"canvas",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:boxRectWidth change:boxRectHeight change:overviewboxPaddingTop",this.render),this.listenTo(this.g.selcol,"add reset change",this.render),this.listenTo(this.g.columns,"change:hidden",this.render),this.listenTo(this.g.colorscheme,"change:showLowerCase",this.render),this.listenTo(this.model,"change",a.debounce(this.render,5)),this.color=this.g.colorscheme.getSelectedScheme(),this.listenTo(this.g.colorscheme,"change:scheme",function(){return this.color=this.g.colorscheme.getSelectedScheme(),this.render()}),this.dragStart=[]},events:{click:"_onclick",mousedown:"_onmousedown"},render:function(){var t,e,n,i,r,o,s,a,l,h,u,c,d,f,g;for(this._createCanvas(),this.el.textContent="overview",this.el.style.marginTop=this.g.zoomer.get("overviewboxPaddingTop"),this.ctx.fillStyle="#999999",this.ctx.fillRect(0,0,this.el.width,this.el.height),s=this.g.zoomer.get("boxRectWidth"),o=this.g.zoomer.get("boxRectHeight"),n=this.g.columns.get("hidden"),l=this.g.colorscheme.get("showLowerCase"),u=-o,i=c=0,f=this.model.length-1;f>=c;i=c+=1)if(a=this.model.at(i).get("seq"),h=0,u+=o,this.model.at(i).get("hidden"))console.log(this.model.at(i).get("hidden")),this.ctx.fillStyle="grey",this.ctx.fillRect(0,u,a.length*s,o);else for(r=d=0,g=a.length-1;g>=d;r=d+=1)t=a[r],l&&(t=t.toUpperCase()),e=this.color.getColor(t,{pos:r}),n.indexOf(r)>=0&&(e="grey"),null!=e&&(this.ctx.fillStyle=e,this.ctx.fillRect(h,u,s,o)),h+=s;return this._drawSelection()},_drawSelection:function(){var t,e,n,i,r,o,s,a,l;if(!(this.dragStart.length>0)||this.prolongSelection){for(r=this.g.zoomer.get("boxRectWidth"),i=this.g.zoomer.get("boxRectHeight"),e=i*this.model.length,this.ctx.fillStyle="#ffff00",this.ctx.globalAlpha=.9,t=a=0,l=this.g.selcol.length-1;l>=a;t=a+=1)o=this.g.selcol.at(t),"column"===o.get("type")?this.ctx.fillRect(r*o.get("xStart"),0,r*(o.get("xEnd")-o.get("xStart")+1),e):"row"===o.get("type")?(s=this.model.filter(function(t){return t.get("id")===o.get("seqId")})[0],n=this.model.indexOf(s),this.ctx.fillRect(0,i*n,r*s.get("seq").length,i)):"pos"===o.get("type")&&(s=this.model.filter(function(t){return t.get("id")===o.get("seqId")})[0],n=this.model.indexOf(s),this.ctx.fillRect(r*o.get("xStart"),i*n,r*(o.get("xEnd")-o.get("xStart")+1),i));return this.ctx.globalAlpha=1}},_onclick:function(t){return this.g.trigger("meta:click",{seqId:this.model.get("id",{evt:t})})},_onmousemove:function(t){var e;if(0!==this.dragStart.length)return this.render(),this.ctx.fillStyle="#ffff00",this.ctx.globalAlpha=.9,e=this._calcSelection(r.abs(t)),this.ctx.fillRect(e[0][0],e[1][0],e[0][1]-e[0][0],e[1][1]-e[1][0]),t.preventDefault(),t.stopPropagation()},_onmousedown:function(t){return this.dragStart=r.abs(t),this.dragStartRel=r.rel(t),this.prolongSelection=t.ctrlKey||t.metaKey?!0:!1,i(document.body).on("mousemove.overmove",function(t){return function(e){return t._onmousemove(e)}}(this)),i(document.body).on("mouseup.overup",function(t){return function(e){return t._onmouseup(e)}}(this)),this.dragStart},_calcSelection:function(t){var e,n,i,r,o;for(e=[t[0]-this.dragStart[0],t[1]-this.dragStart[1]],n=r=0;1>=r;n=r+=1)e[n]=this.dragStartRel[n]+e[n];for(i=[[this.dragStartRel[0],e[0]],[this.dragStartRel[1],e[1]]],n=o=0;1>=o;n=o+=1)i[n][1]<i[n][0]&&(i[n]=[i[n][1],i[n][0]]),i[n][0]=Math.max(i[n][0],0);return i},_endSelection:function(t){var e,n,r,s,a,l,h,u,c,d;if(i(document.body).off(".overmove"),i(document.body).off(".overup"),0!==this.dragStart.length){for(s=this._calcSelection(t),n=l=0;1>=l;n=++l)s[0][n]=Math.floor(s[0][n]/this.g.zoomer.get("boxRectWidth"));for(n=h=0;1>=h;n=++h)s[1][n]=Math.floor(s[1][n]/this.g.zoomer.get("boxRectHeight"));for(s[0][1]=Math.min(this.model.getMaxLength()-1,s[0][1]),s[1][1]=Math.min(this.model.length-1,s[1][1]),a=[],r=u=c=s[1][0],d=s[1][1];d>=u;r=u+=1)e={seqId:this.model.at(r).get("id"),xStart:s[0][0],xEnd:s[0][1]},a.push(new o.possel(e));return this.dragStart=[],this.prolongSelection?this.g.selcol.add(a):this.g.selcol.reset(a),this.g.zoomer.setLeftOffset(s[0][0]),this.g.zoomer.setTopOffset(s[1][0])}},_onmouseup:function(t){return this._endSelection(r.abs(t))},_onmouseout:function(t){return this._endSelection(r.abs(t))},_createCanvas:function(){var t,e;return e=this.g.zoomer.get("boxRectWidth"),t=this.g.zoomer.get("boxRectHeight"),this.el.height=this.model.length*t,this.el.width=this.model.getMaxLength()*e,this.ctx=this.el.getContext("2d"),this.el.style.overflow="scroll",this.el.style.cursor="crosshair"}})},{"../g/selection/Selection":77,"backbone-viewj":9,jbone:42,"mouse-pos":46,underscore:66}],114:[function(t,e){var n,i,r,o,s;n=t("backbone-childs"),s=t("underscore"),r=t("koala-js"),i=t("dom-helper"),o=t("../g/selection/Selection"),e.exports=n.extend({initialize:function(t){return this.g=t.g,this.listenTo(this.g.user,"change:searchText",function(t,e){return this.search(e),this.render()}),this.sel=[],this.selPos=0},events:{scroll:"_sendScrollEvent"},render:function(){var t;return this.renderSubviews(),this.el.className="biojs_msa_searchresult",t=this.g.user.get("searchText"),null!=t&&t.length>0&&(0===this.sel.length?this.el.textContent="no selection found":(this.resultBox=r.mk("div"),this.resultBox.className="biojs_msa_searchresult_ovbox",this.updateResult(),this.el.appendChild(this.resultBox),this.el.appendChild(this.buildBtns()))),this},updateResult:function(){var t,e;return e="search pattern: "+this.g.user.get("searchText"),e+=", selection: "+(this.selPos+1),t=this.sel[this.selPos],e+=" (",e+=t.get("xStart")+" - "+t.get("xEnd"),e+=", id: "+t.get("seqId"),e+=")",this.resultBox.textContent=e},buildBtns:function(){var t,e,n,i;return n=r.mk("button"),n.textContent="Prev",n.addEventListener("click",function(t){return function(){return t.moveSel(-1)}}(this)),e=r.mk("button"),e.textContent="Next",e.addEventListener("click",function(t){return function(){return t.moveSel(1)}}(this)),t=r.mk("button"),t.textContent="All",t.addEventListener("click",function(t){return function(){return t.g.selcol.reset(t.sel)}}(this)),i=r.mk("div"),i.appendChild(n),i.appendChild(e),i.appendChild(t),i.className="biojs_msa_searchresult_row",i},moveSel:function(t){var e;return e=this.selPos+t,0>e||e>=this.sel.length?-1:(this.focus(e),this.selPos=e,this.updateResult())},focus:function(t){var e,n;return n=this.sel[t],e=n.get("xStart"),this.g.zoomer.setLeftOffset(e),this.g.selcol.reset([n])},search:function(t){var e,n,i,r;return r=new RegExp(t,"gi"),n=[],e=i=100042,this.model.each(function(t){var i,s,a,l,h;for(l=t.get("seq"),h=[];a=r.exec(l);)s=a.index,i={xStart:s,xEnd:s+a[0].length-1,seqId:t.get("id")},n.push(new o.possel(i)),h.push(e=Math.min(s,e));return h}),this.g.selcol.reset(n),e===i&&(e=0),this.g.zoomer.setLeftOffset(e),this.sel=n}})},{"../g/selection/Selection":77,"backbone-childs":2,"dom-helper":41,"koala-js":43,underscore:66}],115:[function(t,e){var n,i,r,o,s,a;s=t("backbone-childs"),n=t("./AlignmentBody"),i=t("./header/HeaderBlock"),r=t("./OverviewBox"),o=t("./Search"),a=t("underscore"),e.exports=s.extend({initialize:function(t){return this.g=t.g,this.draw(),this.listenTo(this.g.stats,"reset",function(){return this.rerender()}),this.listenTo(this.model,"change:hidden",a.debounce(this.rerender,10)),this.listenTo(this.model,"sort",this.rerender),this.listenTo(this.model,"add",function(){return console.log("seq add")}),this.listenTo(this.g.vis,"change:sequences",this.rerender),this.listenTo(this.g.vis,"change:overviewbox",this.rerender),this.listenTo(this.g.visorder,"change",this.rerender)},draw:function(){var t,e,s,a;return this.removeViews(),this.g.vis.get("overviewbox")&&(s=new r({model:this.model,g:this.g}),s.ordering=this.g.visorder.get("overviewBox"),this.addView("overviewBox",s)),e=new i({model:this.model,g:this.g}),e.ordering=this.g.visorder.get("headerBox"),this.addView("headerBox",e),a=new o({model:this.model,g:this.g}),a.ordering=this.g.visorder.get("searchBox"),this.addView("searchbox",a),t=new n({model:this.model,g:this.g}),t.ordering=this.g.visorder.get("alignmentBody"),this.addView("body",t)},render:function(){return this.renderSubviews(),this.el.className="biojs_msa_stage",this},rerender:function(){return this.draw(),this.render()}})},{"./AlignmentBody":112,"./OverviewBox":113,"./Search":114,"./header/HeaderBlock":123,"backbone-childs":2,underscore:66}],116:[function(t,e){var n,i;i=t("biojs-events"),e.exports=n=function(){function t(t){this.g=t,this.cache={},this.cacheHeight=0,this.cacheWidth=0}return t.prototype.getFontTile=function(t,e,n){return(e!==this.cacheWidth||n!==this.cacheHeight)&&(this.cacheHeight=n,this.cacheWidth=e,this.cache={}),void 0===this.cache[t]&&this.createTile(t,e,n),this.cache[t]},t.prototype.createTile=function(t,e,n){var i;return i=this.cache[t]=document.createElement("canvas"),i.width=e,i.height=n,this.ctx=i.getContext("2d"),this.ctx.font=this.g.zoomer.get("residueFont")+"px mono",this.ctx.textBaseline="middle",this.ctx.textAlign="center",this.ctx.fillText(t,e/2,n/2,e)},t}()},{"biojs-events":13}],117:[function(t,e){var n,i,r,o;o=t("underscore"),n=t("biojs-events"),i={setMaxScrollHeight:function(){return this.maxScrollHeight=this.g.zoomer.getMaxAlignmentHeight()-this.g.zoomer.get("alignmentHeight")},setMaxScrollWidth:function(){return this.maxScrollWidth=this.g.zoomer.getMaxAlignmentWidth()-this.g.zoomer.getAlignmentWidth()}},e.exports=r=function(t,e){return this.g=t,this.model=e,this.maxScrollWidth=0,this.maxScrollHeight=0,this.setMaxScrollHeight(),this.setMaxScrollWidth(),this.listenTo(this.g.zoomer,"change:rowHeight",this.setMaxScrollHeight),this.listenTo(this.g.zoomer,"change:columnWidth",this.setMaxScrollWidth),this.listenTo(this.g.zoomer,"change:alignmentWidth",this.setMaxScrollWidth),this.listenTo(this.g.zoomer,"change:alignmentHeight",this.setMaxScrollHeight),this.listenTo(this.model,"add change reset",function(){return this.setMaxScrollHeight(),this.setMaxScrollWidth()},this),this},o.extend(r.prototype,i),n.mixin(r.prototype)},{"biojs-events":13,underscore:66}],118:[function(t,e){var n,i;i=t("underscore"),e.exports=n=function(t,e){return this.g=t,this.ctx=e,this},i.extend(n.prototype,{_getSelection:function(t){var e,n,r,o,s,a,l,h,u,c,d,f,g;if(e=t.get("seq").length,s=[],a=this.g.selcol.getSelForRow(t.get("id")),r=i.find(a,function(t){return"row"===t.get("type")}),null!=r)for(n=l=0,d=e-1;d>=l;n=l+=1)s.push(n);else if(a.length>0)for(h=0,c=a.length;c>h;h++)for(o=a[h],n=u=f=o.get("xStart"),g=o.get("xEnd");g>=u;n=u+=1)s.push(n);return s},_appendSelection:function(t){var e,n,i,r,o,s,a,l,h,u,c,d,f;if(h=t.model.get("seq"),l=this._getSelection(t.model),c=this._getPrevNextSelection(t.model),s=c[0],o=c[1],n=this.g.zoomer.get("columnWidth"),e=this.g.zoomer.get("rowHeight"),0!==l.length){for(i=0,f=[],a=u=0,d=h.length-1;d>=u;a=u+=1)t.hidden.indexOf(a)>=0?f.push(i++):(r=a-i,l.indexOf(a)>=0&&(0===r||l.indexOf(a-1)<0)?f.push(this._renderSelection({n:a,k:r,selection:l,mPrevSel:s,mNextSel:o,xZero:t.xZero,yZero:t.yZero,model:t.model})):f.push(void 0));return f}},_renderSelection:function(t){var e,n,i,r,o,s,a,l,h,u,c,d,f,g,m,p,v,b,x,w,y;for(p=t.xZero,v=t.yZero,u=t.n,a=t.k,c=t.selection,h=t.mPrevSel,l=t.mNextSel,d=0,s=b=u,w=t.model.get("seq").length-1;w>=b&&c.indexOf(s)>=0;s=b+=1)d++;for(r=this.g.zoomer.get("columnWidth"),i=this.g.zoomer.get("rowHeight"),f=r*d+1,o=this.g.columns.get("hidden"),this.ctx.beginPath(),n=this.ctx.lineWidth,this.ctx.lineWidth=3,e=this.ctx.strokeStyle,this.ctx.strokeStyle="#FF0000",p+=a*r,g=0,s=x=0,y=d-1;y>=0?y>=x:x>=y;s=y>=0?++x:--x)m=u+s,o.indexOf(m)>=0||(null!=h&&h.indexOf(m)>=0||(this.ctx.moveTo(p+g,v),this.ctx.lineTo(g+r+p,v)),null!=l&&l.indexOf(m)>=0||(this.ctx.moveTo(g+p,i+v),this.ctx.lineTo(g+r+p,i+v)),g+=r);return this.ctx.moveTo(p,v),this.ctx.lineTo(p,i+v),this.ctx.moveTo(p+f,v),this.ctx.lineTo(p+f,i+v),this.ctx.stroke(),this.ctx.strokeStyle=e,this.ctx.lineWidth=n},_getPrevNextSelection:function(t){var e,n,i,r;return r=t.collection.prev(t),i=t.collection.next(t),null!=r&&(n=this._getSelection(r)),null!=i&&(e=this._getSelection(i)),[n,e]}})},{underscore:66}],119:[function(t,e){var n,i,r,o,s,a,l,h;s=t("backbone-childs"),l=t("mouse-pos"),h=t("underscore"),a=t("jbone"),r=t("./CanvasCharCache"),o=t("./CanvasSelection"),i=t("./CanvasSeqDrawer"),n=t("./CanvasCoordsCache"),e.exports=s.extend({tagName:"canvas",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:_alignmentScrollLeft change:_alignmentScrollTop",function(t,e,n){return null==(null!=n?n.origin:void 0)||"canvasseq"!==n.origin?this.render():void 0}),this.listenTo(this.g.columns,"change:hidden",this.render),this.listenTo(this.g.zoomer,"change:alignmentWidth change:alignmentHeight",this.render),this.listenTo(this.g.colorscheme,"change",this.render),this.listenTo(this.g.selcol,"reset add",this.render),this.el.style.display="inline-block",this.el.style.overflowX="hidden",this.el.style.overflowY="hidden",this.el.className="biojs_msa_seqblock",this.ctx=this.el.getContext("2d"),this.cache=new r(this.g),this.coordsCache=new n(this.g,this.model),this.listenTo(this.g.zoomer,"change:residueFont",function(){return this.cache=new r(this.g),this.render()}),this.sel=new o(this.g,this.ctx),this._setColor(),this.throttleTime=0,this.throttleCounts=0,this.throttledDraw=null!=document.documentElement.style.webkitAppearance?function(){var t,e;return t=+new Date,this.draw(),this.throttleTime+=+new Date-t,this.throttleCounts++,this.throttleCounts>15?(e=Math.ceil(this.throttleTime/this.throttleCounts),console.log("avgDrawTime/WebKit",e),this.throttledDraw=this.draw):void 0}:h.throttle(this.throttledDraw,30),this.manageEvents()},throttledDraw:function(){var t,e;return t=+new Date,this.draw(),this.throttleTime+=+new Date-t,this.throttleCounts++,this.throttleCounts>15?(e=Math.ceil(this.throttleTime/this.throttleCounts),console.log("avgDrawTime",e),e*=1.2,e=Math.max(20,e),this.throttledDraw=h.throttle(this.draw,e)):void 0},manageEvents:function(){var t;return t={},t.mousedown="_onmousedown",t.touchstart="_ontouchstart",this.g.config.get("registerMouseClicks")&&(t.dblclick="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),t.mousewheel="_onmousewheel",t.DOMMouseScroll="_onmousewheel",this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents),this.dragStart=[]},_setColor:function(){return this.color=this.g.colorscheme.getSelectedScheme()},draw:function(){return this.el.width=this.el.width,null!=this.seqDrawer&&this.model.length>0?(this.seqDrawer.drawLetters(),this.seqDrawer.drawRows(this.sel._appendSelection,this.sel),this.seqDrawer.drawRows(this.drawFeatures,this)):void 0},drawFeatures:function(t){var e,n,i;return i=this.g.zoomer.get("columnWidth"),n=this.g.zoomer.get("rowHeight"),t.model.attributes.height>1?(e=this.ctx,t.model.attributes.features.each(function(r){var o,s;return e.fillStyle=r.attributes.fillColor||"red",o=r.attributes.xEnd-r.attributes.xStart+1,s=(r.attributes.row+1)*n,e.fillRect(r.attributes.xStart*i+t.xZero,s+t.yZero,i*o,n)}),e.fillStyle="black",e.font=this.g.zoomer.get("residueFont")+"px mono",e.textBaseline="middle",e.textAlign="center",t.model.attributes.features.each(function(r){var o,s;return o=r.attributes.xEnd-r.attributes.xStart+1,s=(r.attributes.row+1)*n,e.fillText(r.attributes.text,t.xZero+r.attributes.xStart*i+o/2*i,t.yZero+.5*n+s)})):void 0},render:function(){return this.el.setAttribute("height",this.g.zoomer.get("alignmentHeight")+"px"),this.el.setAttribute("width",this.g.zoomer.getAlignmentWidth()+"px"),this.g.zoomer._checkScrolling(this._checkScrolling([this.g.zoomer.get("_alignmentScrollLeft"),this.g.zoomer.get("_alignmentScrollTop")]),{header:"canvasseq"}),this._setColor(),this.seqDrawer=new i(this.g,this.ctx,this.model,{width:this.el.width,height:this.el.height,color:this.color,cache:this.cache}),this.throttledDraw(),this},_onmousemove:function(t,e){var n,i,r,o,s,a,h,u,c;if(0!==this.dragStart.length){for(n=l.abs(t),o=[n[0]-this.dragStart[0],n[1]-this.dragStart[1]],s=this.g.zoomer.get("canvasEventScale"),e&&(s=3),i=h=0;1>=h;i=h+=1)o[i]=o[i]*s;for(r=[this.dragStartScroll[0]-o[0],this.dragStartScroll[1]-o[1]],i=u=0;1>=u;i=u+=1)r[i]=Math.round(r[i]);for(a=this._checkScrolling(r),this.g.zoomer._checkScrolling(a,{origin:"canvasseq"}),i=c=0;1>=c;i=c+=1)a[i]!==r[i]&&(0===a[i]?(this.dragStart[i]=n[i],this.dragStartScroll[i]=0):this.dragStart[i]=n[i]-a[i]);return this.throttledDraw(),null!=t.preventDefault?(t.preventDefault(),t.stopPropagation()):void 0}},_ontouchmove:function(t){return this._onmousemove(t.changedTouches[0],!0),t.preventDefault(),t.stopPropagation()},_onmousedown:function(t){return this.dragStart=l.abs(t),this.dragStartScroll=[this.g.zoomer.get("_alignmentScrollLeft"),this.g.zoomer.get("_alignmentScrollTop")],a(document.body).on("mousemove.overmove",function(t){return function(e){return t._onmousemove(e)}}(this)),a(document.body).on("mouseup.overup",function(t){return function(){return t._cleanup()}}(this)),t.preventDefault()},_ontouchstart:function(t){return this.dragStart=l.abs(t.changedTouches[0]),this.dragStartScroll=[this.g.zoomer.get("_alignmentScrollLeft"),this.g.zoomer.get("_alignmentScrollTop")],a(document.body).on("touchmove.overtmove",function(t){return function(e){return t._ontouchmove(e)}}(this)),a(document.body).on("touchend.overtend touchleave.overtleave touchcancel.overtcanel",function(t){return function(e){return t._touchCleanup(e)}}(this))},_onmousewinout:function(t){return t.toElement===document.body.parentNode?this._cleanup():void 0},_cleanup:function(){return this.dragStart=[],a(document.body).off(".overmove"),a(document.body).off(".overup"),a(document.body).off(".overout")},_touchCleanup:function(t){return t.changedTouches.length>0&&this._onmousemove(t.changedTouches[0],!0),this.dragStart=[],a(document.body).off(".overtmove"),a(document.body).off(".overtend"),a(document.body).off(".overtleave"),a(document.body).off(".overtcancel")},_onmousewheel:function(t){var e;return e=l.wheelDelta(t),this.g.zoomer.set("_alignmentScrollLeft",this.g.zoomer.get("_alignmentScrollLeft")+e[0]),this.g.zoomer.set("_alignmentScrollTop",this.g.zoomer.get("_alignmentScrollTop")+e[1]),t.preventDefault()},_onclick:function(t){var e;return e=this._getClickPos(t),null!=e&&(null!=e.feature?this.g.trigger("feature:click",e):this.g.trigger("residue:click",e)),this.throttledDraw()},_onmousein:function(t){var e;return e=this._getClickPos(t),null!=e&&(null!=e.feature?this.g.trigger("feature:mousein",e):this.g.trigger("residue:mousein",e)),this.throttledDraw()},_onmouseout:function(t){var e;return e=this._getClickPos(t),null!=e&&(null!=e.feature?this.g.trigger("feature:mouseout",e):this.g.trigger("residue:mouseout",e)),this.throttledDraw()},_getClickPos:function(t){var e,n,i,r,o,s,a,h;return e=l.rel(t),e[0]+=this.g.zoomer.get("_alignmentScrollLeft"),s=Math.floor(e[0]/this.g.zoomer.get("columnWidth")),h=this.seqDrawer._getSeqForYClick(e[1]),a=h[0],r=h[1],s+=this.g.columns.calcHiddenColumns(s),a+=this.model.calcHiddenSeqs(a),s=Math.max(0,s),a=Math.max(0,a),o=this.model.at(a).get("id"),r>0?(i=this.model.at(a).get("features").getFeatureOnRow(r-1,s),0!==i.length?(n=i[0],console.log(i[0].attributes),{seqId:o,feature:n,rowPos:s,evt:t}):void 0):{seqId:o,rowPos:s,evt:t}},_checkScrolling:function(t){var e,n,i;for(n=[this.coordsCache.maxScrollWidth,this.coordsCache.maxScrollHeight],e=i=0;1>=i;e=i+=1)t[e]>n[e]&&(t[e]=n[e]),t[e]<0&&(t[e]=0);return t}})},{"./CanvasCharCache":116,"./CanvasCoordsCache":117,"./CanvasSelection":118,"./CanvasSeqDrawer":120,"backbone-childs":2,jbone:42,"mouse-pos":46,underscore:66}],120:[function(t,e){var n,i,r;r=t("underscore"),i={drawLetters:function(){var t;return t=this.rectHeight,this.ctx.globalAlpha=this.g.colorscheme.get("opacity"),this.drawSeqs(function(t){return this.drawSeq(t,this._drawRect)}),this.ctx.globalAlpha=1,this.drawSeqs(function(t){return this.drawSeq(t,this._drawLetter)})},drawSeqs:function(t,e){var n,i,r,o,s,a,l,h,u,c;for(n=this.g.columns.get("hidden"),e=e||this,h=this.getStartSeq(),s=h[0],a=h[1],c=[],i=l=s,u=this.model.length-1;u>=l;i=l+=1)if(r=this.model.at(i),!r.get("hidden")){if(t.call(e,{model:r,yPos:a,y:i,hidden:n}),o=(r.attributes.height||1)*this.rectHeight,a+=o,a>this.height)break;c.push(void 0)}return c},drawRows:function(t,e){return this.drawSeqs(function(n){return this.drawRow(n,t,e)})},drawRow:function(t,e,n){var i,r,o,s,a;return i=this.g.zoomer.get("columnWidth"),r=Math.max(0,Math.abs(Math.ceil(-this.g.zoomer.get("_alignmentScrollLeft")/i))),o=-Math.abs(-this.g.zoomer.get("_alignmentScrollLeft")%i),s=o-r*i,a=t.yPos,e.call(n,{model:t.model,xZero:s,yZero:a,hidden:t.hidden})},getStartSeq:function(){var t,e,n,i;for(n=Math.max(0,Math.floor(this.g.zoomer.get("_alignmentScrollTop")/this.rectHeight))+1,t=0,e=0;n>t&&e<this.model.length;)t+=this.model.at(e).attributes.height||1,e++;return i=Math.max(0,this.g.zoomer.get("_alignmentScrollTop")-t*this.rectHeight+(this.model.at(e-1).attributes.height||1)*this.rectHeight),[e-1,-i]},_getSeqForYClick:function(t){var e,n,i,r,o,s,a,l;for(l=this.getStartSeq(),o=l[0],s=l[1],a=s%this.rectHeight,e=Math.max(0,Math.floor((t-a)/this.rectHeight))+1,n=0,i=o;e>n&&i<this.model.length;)n+=this.model.at(i).attributes.height||1,i++;return r=Math.max(0,Math.floor(t/this.rectHeight)-n+(this.model.at(i-1).get("height")||1)),[i-1,r]},drawSeq:function(t,e){var n,i,r,o,s,a,l,h,u,c,d,f,g;for(l=t.model.get("seq"),c=t.yPos,s=this.rectWidth,o=this.rectHeight,h=Math.max(0,Math.abs(Math.ceil(-this.g.zoomer.get("_alignmentScrollLeft")/s))),u=-Math.abs(-this.g.zoomer.get("_alignmentScrollLeft")%s),a={rectWidth:s,rectHeight:o,yPos:c,y:t.y},i=this.width,g=[],r=d=h,f=l.length-1;f>=d;r=d+=1)if(n=l[r],n=n.toUpperCase(),a.x=r,a.c=n,a.xPos=u,t.hidden.indexOf(r)<0){if(e(this,a),u+=s,u>i)break;g.push(void 0)}return g},_drawRect:function(t,e){var n;return n=t.color.getColor(e.c,{pos:e.x,y:e.y}),null!=n?(t.ctx.fillStyle=n,t.ctx.fillRect(e.xPos,e.yPos,e.rectWidth,e.rectHeight)):void 0},_drawLetter:function(t,e){return t.ctx.drawImage(t.cache.getFontTile(e.c,e.rectWidth,e.rectHeight),e.xPos,e.yPos,e.rectWidth,e.rectHeight)}},e.exports=n=function(t,e,n,i){return this.g=t,this.ctx=e,this.model=n,this.width=i.width,this.height=i.height,this.color=i.color,this.cache=i.cache,this.rectHeight=this.g.zoomer.get("rowHeight"),this.rectWidth=this.g.zoomer.get("columnWidth"),this},r.extend(n.prototype,i)},{underscore:66}],121:[function(t,e){var n,i,r,o;o=t("backbone-viewj"),i=t("dom-helper"),r=t("../../utils/svg"),n=o.extend({className:"biojs_msa_conserv",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:stepSize change:labelWidth change:columnWidth",this.render),this.listenTo(this.g.vis,"change:labels change:metacell",this.render),this.listenTo(this.g.columns,"change:scaling",this.render),this.listenTo(this.g.stats,"reset",this.render),this.manageEvents()
},render:function(){var t,e,n,o,s,a,l,h,u,c,d,f,g,m,p,v;for(n=this.g.stats.scale(this.g.stats.conservation()),i.removeAllChilds(this.el),u=this.model.getMaxLength(),e=this.g.zoomer.get("columnWidth"),l=20,g=e*(u-this.g.columns.get("hidden").length),d=r.base({height:l,width:g}),d.style.display="inline-block",d.style.cursor="pointer",f=this.g.zoomer.get("stepSize"),s=this.g.columns.get("hidden"),m=0,h=0;u>h;)if(s.indexOf(h)>=0)h+=f;else{for(g=e*f,t=0,a=p=0,v=f-1;v>=0?v>=p:p>=v;a=v>=0?++p:--p)t+=n[h];o=l*(t/f),c=r.rect({x:m,y:l-o,width:g-e/4,height:o,style:"stroke:red;stroke-width:1;"}),c.rowPos=h,d.appendChild(c),m+=g,h+=f}return this.el.appendChild(d),this},_onclick:function(t){var e,n,i,r,o,s;for(n=t.target.rowPos,i=this.g.zoomer.get("stepSize"),s=[],e=r=0,o=i-1;o>=r;e=r+=1)s.push(this.g.trigger("bar:click",{rowPos:n+e,evt:t}));return s},manageEvents:function(){var t;return t={},this.g.config.get("registerMouseClicks")&&(t.click="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents)},_onmousein:function(t){var e;return e=this.g.zoomer.get("stepSize"*t.rowPos),this.g.trigger("bar:mousein",{rowPos:e,evt:t})},_onmouseout:function(t){var e;return e=this.g.zoomer.get("stepSize"*t.rowPos),this.g.trigger("bar:mouseout",{rowPos:e,evt:t})}}),e.exports=n},{"../../utils/svg":110,"backbone-viewj":9,"dom-helper":41}],122:[function(t,e){var n,i,r,o;o=t("backbone-viewj"),i=t("dom-helper"),r=t("../../utils/svg"),n=o.extend({className:"biojs_msa_gapview",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:stepSize change:labelWidth change:columnWidth",this.render),this.listenTo(this.g.vis,"change:labels change:metacell",this.render),this.listenTo(this.g.columns,"change:scaling",this.render),this.listenTo(this.model,"reset",this.render),this.manageEvents()},render:function(){var t,e,n,o,s,a,l,h,u,c,d,f,g,m,p,v;for(n=this.g.stats.gaps(),i.removeAllChilds(this.el),u=this.model.getMaxLength(),e=this.g.zoomer.get("columnWidth"),l=20,g=e*(u-this.g.columns.get("hidden").length),d=r.base({height:l,width:g}),d.style.display="inline-block",d.style.cursor="pointer",f=this.g.zoomer.get("stepSize"),s=this.g.columns.get("hidden"),m=0,h=0;u>h;)if(s.indexOf(h)>=0)h+=f;else{for(g=e*f,t=0,a=p=0,v=f-1;v>=0?v>=p:p>=v;a=v>=0?++p:--p)t+=n[h];o=l*(t/f),c=r.rect({x:m,y:l-o,width:g-e/4,height:o,style:"stroke:red;stroke-width:1;"}),c.rowPos=h,d.appendChild(c),m+=g,h+=f}return this.el.appendChild(d),this},_onclick:function(t){var e,n,i,r,o,s;for(n=t.target.rowPos,i=this.g.zoomer.get("stepSize"),s=[],e=r=0,o=i-1;o>=r;e=r+=1)s.push(this.g.trigger("gap:click",{rowPos:n+e,evt:t}));return s},manageEvents:function(){var t;return t={},this.g.config.get("registerMouseClicks")&&(t.click="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents)},_onmousein:function(t){var e;return e=this.g.zoomer.get("stepSize"*t.rowPos),this.g.trigger("gap:mousein",{rowPos:e,evt:t})},_onmouseout:function(t){var e;return e=this.g.zoomer.get("stepSize"*t.rowPos),this.g.trigger("gap:mouseout",{rowPos:e,evt:t})}}),e.exports=n},{"../../utils/svg":110,"backbone-viewj":9,"dom-helper":41}],123:[function(t,e){var n,i,r;r=t("backbone-childs"),n=t("./LabelHeader"),i=t("./RightHeaderBlock"),e.exports=r.extend({initialize:function(t){return this.g=t.g,this.draw(),this.listenTo(this.g.vis,"change:labels change:metacell change:leftHeader",function(t){return function(){return t.draw(),t.render()}}(this))},draw:function(){var t,e;return this.removeViews(),this.g.vis.get("leftHeader")&&(this.g.vis.get("labels")||this.g.vis.get("metacell"))&&(t=new n({model:this.model,g:this.g}),t.ordering=-50,this.addView("lHeader",t)),e=new i({model:this.model,g:this.g}),e.ordering=0,this.addView("rHeader",e)},render:function(){return this.renderSubviews(),this.el.className="biojs_msa_header"}})},{"./LabelHeader":124,"./RightHeaderBlock":126,"backbone-childs":2}],124:[function(t,e){var n,i,r,o;r=t("koala-js"),o=t("backbone-viewj"),i=t("dom-helper"),e.exports=n=o.extend({className:"biojs_msa_headers",initialize:function(t){return this.g=t.g,this.listenTo(this.g.vis,"change:metacell change:labels",this.render),this.listenTo(this.g.zoomer,"change:labelWidth change:metaWidth",this.render)},render:function(){var t;return i.removeAllChilds(this.el),t=0,t+=this.g.zoomer.getLeftBlockWidth(),this.el.style.width=t+"px",this.g.vis.get("labels")&&this.el.appendChild(this.labelDOM()),this.g.vis.get("metacell")&&this.el.appendChild(this.metaDOM()),this.el.style.display="inline-block",this.el.style.fontSize=this.g.zoomer.get("markerFontsize"),this},labelDOM:function(){var t,e;return t=r.mk("div"),t.style.width=this.g.zoomer.getLabelWidth(),t.style.display="inline-block",this.g.vis.get("labelCheckbox")&&t.appendChild(this.addEl(".",10)),this.g.vis.get("labelId")&&t.appendChild(this.addEl("id",this.g.zoomer.get("labelIdLength"))),this.g.vis.get("labelPartition")&&t.appendChild(this.addEl("part",15)),this.g.vis.get("labelName")&&(e=this.addEl("name"),t.appendChild(e)),t},addEl:function(t,e){var n;return n=document.createElement("span"),n.textContent=t,null!=e&&(n.style.width=e+"px"),n.style.display="inline-block",n},metaDOM:function(){var t;return t=r.mk("div"),t.style.width=this.g.zoomer.getMetaWidth(),t.style.display="inline-block",this.g.vis.get("metaGaps")&&t.appendChild(this.addEl("gaps",this.g.zoomer.get("metaGapWidth"))),this.g.vis.get("metaIdentity")&&t.appendChild(this.addEl("ident",this.g.zoomer.get("metaIdentWidth"))),this.g.vis.get("metaLinks")&&t.appendChild(this.addEl("links")),t}})},{"backbone-viewj":9,"dom-helper":41,"koala-js":43}],125:[function(t,e){var n,i,r,o,s;s=t("backbone-viewj"),i=t("dom-helper"),o=t("../../utils/svg"),r=t("jbone"),n=s.extend({className:"biojs_msa_marker",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:stepSize change:labelWidth change:columnWidth change:markerStepSize change:markerFontsize",this.render),this.listenTo(this.g.vis,"change:labels change:metacell",this.render),this.manageEvents()},render:function(){var t,e,n,r,o,s,a;for(i.removeAllChilds(this.el),this.el.style.fontSize=this.g.zoomer.get("markerFontsize"),e=document.createElement("span"),r=0,t=this.g.zoomer.get("columnWidth"),o=this.model.getMaxLength(),a=this.g.zoomer.get("stepSize"),n=this.g.columns.get("hidden");o>r;)n.indexOf(r)>=0?(this.markerHidden(s,r,a),r+=a):(s=document.createElement("span"),s.style.width=t*a+"px",s.style.display="inline-block",s.textContent=(r+1)%this.g.zoomer.get("markerStepSize")===0?r+1:".",s.rowPos=r,r+=a,e.appendChild(s));return this.el.appendChild(e),this},markerHidden:function(t,e,n){var i,s,a,l,h,u,c,d,f,g,m;for(i=this.g.columns.get("hidden").slice(0),h=Math.max(0,e-n),c=!0,a=g=h;e>=g;a=g+=1)c&=i.indexOf(a)>=0;if(!c){for(u=this.model.getMaxLength(),l=0,s=-1,e=m=e;u>=m&&(s>=0||(s=i.indexOf(e)),i.indexOf(e)>=0);e=m+=1)l++;return d=o.base({height:10,width:10}),d.style.position="relative",f=o.polygon({points:"0,0 5,5 10,0",style:"fill:lime;stroke:purple;stroke-width:1"}),r(f).on("click",function(t){return function(){return i.splice(s,l),t.g.columns.set("hidden",i)}}(this)),d.appendChild(f),t.appendChild(d),d}},manageEvents:function(){var t;return t={},this.g.config.get("registerMouseClicks")&&(t.click="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents)},_onclick:function(t){var e,n;return e=t.target.rowPos,n=this.g.zoomer.get("stepSize"),this.g.trigger("column:click",{rowPos:e,stepSize:n,evt:t})},_onmousein:function(t){var e,n;return e=this.g.zoomer.get("stepSize"*t.rowPos),n=this.g.zoomer.get("stepSize"),this.g.trigger("column:mousein",{rowPos:e,stepSize:n,evt:t})},_onmouseout:function(t){var e,n;return e=this.g.zoomer.get("stepSize"*t.rowPos),n=this.g.zoomer.get("stepSize"),this.g.trigger("column:mouseout",{rowPos:e,stepSize:n,evt:t})}}),e.exports=n},{"../../utils/svg":110,"backbone-viewj":9,"dom-helper":41,jbone:42}],126:[function(t,e){var n,i,r,o,s,a;r=t("./MarkerView"),n=t("./ConservationView"),s=t("backbone-childs"),a=t("underscore"),o=t("./SeqLogoWrapper"),i=t("./GapView"),e.exports=s.extend({initialize:function(t){return this.g=t.g,this.blockEvents=!1,this.listenTo(this.g.vis,"change:header",function(){return this.draw(),this.render()}),this.listenTo(this.g.vis,"change",this._setSpacer),this.listenTo(this.g.zoomer,"change:alignmentWidth",this._setWidth),this.listenTo(this.g.zoomer,"change:_alignmentScrollLeft",this._adjustScrollingLeft),this.listenTo(this.g.columns,"change:hidden",function(){return this.draw(),this.render()}),this.draw(),this.g.vis.once("change:loaded",this._adjustScrollingLeft,this)},events:{scroll:"_sendScrollEvent"},draw:function(){var t,e,s,a;return this.removeViews(),this.g.vis.get("conserv")&&(t=new n({model:this.model,g:this.g}),t.ordering=-20,this.addView("conserv",t)),this.g.vis.get("markers")&&(s=new r({model:this.model,g:this.g}),s.ordering=-10,this.addView("marker",s)),this.g.vis.get("seqlogo")&&(a=new o({model:this.model,g:this.g}),a.ordering=-30,this.addView("seqlogo",a)),this.g.vis.get("gapHeader")?(e=new i({model:this.model,g:this.g}),e.ordering=-25,this.addView("gapview",e)):void 0},render:function(){return this.renderSubviews(),this._setSpacer(),this.el.className="biojs_msa_rheader",this.el.style.overflowX="auto",this.el.style.display="inline-block",this._setWidth(),this._adjustScrollingLeft(),this},_sendScrollEvent:function(){return this.blockEvents||this.g.zoomer.set("_alignmentScrollLeft",this.el.scrollLeft,{origin:"header"}),this.blockEvents=!1},_adjustScrollingLeft:function(t,e,n){var i;return null==(null!=n?n.origin:void 0)||"header"!==n.origin?(i=this.g.zoomer.get("_alignmentScrollLeft"),this.blockEvents=!0,this.el.scrollLeft=i):void 0},_setSpacer:function(){return this.el.style.marginLeft=this._getLabelWidth()+"px"},_getLabelWidth:function(){var t;return t=0,this.g.vis.get("leftHeader")||(t+=this.g.zoomer.getLeftBlockWidth()),t},_setWidth:function(){return this.el.style.width=this.g.zoomer.getAlignmentWidth()+"px"}})},{"./ConservationView":121,"./GapView":122,"./MarkerView":125,"./SeqLogoWrapper":127,"backbone-childs":2,underscore:66}],127:[function(t,e){var n,i;n=t("biojs-vis-seqlogo/light"),i=t("backbone-viewj"),e.exports=i.extend({initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:alignmentWidth",this.render),this.listenTo(this.g.colorscheme,"change",function(){var t;return t=this.g.colorscheme.getSelectedScheme(),this.seqlogo.changeColors(t),this.render()}),this.listenTo(this.g.zoomer,"change:columnWidth",function(){return this.seqlogo.column_width=this.g.zoomer.get("columnWidth")}),this.render,this.draw()},draw:function(){var t,e,i;return console.log("redraw"),t=this.g.stats.conservResidue({scaled:!0}),t=_.map(t,function(t){return _.pick(t,function(t,e){return"-"!==e})}),i={alphabet:"aa",heightArr:t},e=this.g.colorscheme.getSelectedScheme(),this.seqlogo=new n({model:this.model,g:this.g,data:i,yaxis:!1,scroller:!1,xaxis:!1,height:100,column_width:this.g.zoomer.get("columnWidth"),positionMarker:!1,zoom:1,el:this.el,colors:e})},render:function(){return this.seqlogo.render()}})},{"backbone-viewj":9,"biojs-vis-seqlogo/light":23}],128:[function(t,e){var n,i;n=t("./LabelRowView"),i=t("backbone-childs"),e.exports=i.extend({initialize:function(t){return this.g=t.g,this.draw(),this.listenTo(this.g.zoomer,"change:_alignmentScrollTop",this._adjustScrollingTop),this.g.vis.once("change:loaded",this._adjustScrollingTop,this),this.listenTo(this.g.zoomer,"change:alignmentHeight",this._setHeight),this.listenTo(this.model,"change:reference",this.draw)},draw:function(){var t,e,i,r,o;for(this.removeViews(),o=[],t=i=0,r=this.model.length-1;r>=i;t=i+=1)this.model.at(t).get("hidden")||(e=new n({model:this.model.at(t),g:this.g}),e.ordering=t,o.push(this.addView("row_"+t,e)));return o},events:{scroll:"_sendScrollEvent"},_sendScrollEvent:function(){return this.g.zoomer.set("_alignmentScrollTop",this.el.scrollTop,{origin:"label"})},_adjustScrollingTop:function(){return this.el.scrollTop=this.g.zoomer.get("_alignmentScrollTop")},render:function(){return this.renderSubviews(),this.el.className="biojs_msa_labelblock",this.el.style.display="inline-block",this.el.style.verticalAlign="top",this.el.style.overflowY="auto",this.el.style.overflowX="hidden",this.el.style.fontSize=this.g.zoomer.get("labelFontsize")+"px",this.el.style.lineHeight=""+this.g.zoomer.get("labelLineHeight"),this._setHeight(),this},_setHeight:function(){return this.el.style.height=this.g.zoomer.get("alignmentHeight")+"px"}})},{"./LabelRowView":129,"backbone-childs":2}],129:[function(t,e){var n,i,r;r=t("backbone-childs"),n=t("./LabelView"),i=t("./MetaView"),e.exports=r.extend({initialize:function(t){return this.g=t.g,this.draw(),this.listenTo(this.g.vis,"change:labels",this.drawR),this.listenTo(this.g.vis,"change:metacell",this.drawR),this.listenTo(this.g.zoomer,"change:rowHeight",function(){return this.el.style.height=this.g.zoomer.get("rowHeight")+"px"}),this.listenTo(this.g.selcol,"change reset add",this.setSelection)},draw:function(){var t;return this.removeViews(),this.g.vis.get("labels")&&this.addView("labels",new n({model:this.model,g:this.g})),this.g.vis.get("metacell")?(t=new i({model:this.model,g:this.g}),this.addView("metacell",t)):void 0},drawR:function(){return this.draw(),this.render()},render:function(){return this.renderSubviews(),this.el.setAttribute("class","biojs_msa_labelrow"),this.el.style.height=this.g.zoomer.get("rowHeight")*(this.model.attributes.height||1)+"px",this.setSelection(),this},setSelection:function(){var t;return t=this.g.selcol.getSelForRow(this.model.id),this.el.style.fontWeight=t.length>0?"bold":"normal"}})},{"./LabelView":130,"./MetaView":131,"backbone-childs":2}],130:[function(t,e){var n,i,r;r=t("backbone-viewj"),i=t("dom-helper"),n=r.extend({initialize:function(t){return this.seq=t.seq,this.g=t.g,this.manageEvents()},manageEvents:function(){var t;return t={},this.g.config.get("registerMouseClicks")&&(t.click="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents),this.listenTo(this.g.vis,"change:labelName change:labelId change:labelPartition change:labelCheckbox",this.render),this.listenTo(this.g.zoomer,"change:labelIdLength change:labelNameLength change:labelPartLength change:labelCheckLength",this.render),this.listenTo(this.g.zoomer,"change:labelFontSize change:labelLineHeight change:labelWidth change:rowHeight",this.render)},render:function(){var t,e,n,r,o;return i.removeAllChilds(this.el),this.el.style.width=this.g.zoomer.getLabelWidth()+"px",this.el.setAttribute("class","biojs_msa_labels"),this.g.vis.get("labelCheckbox")&&(t=document.createElement("input"),t.setAttribute("type","checkbox"),t.value=this.model.get("id"),t.name="seq",t.style.width=this.g.zoomer.get("labelCheckLength")+"px",this.el.appendChild(t)),this.g.vis.get("labelId")&&(e=document.createElement("span"),o=this.model.get("id"),isNaN(o)||o++,e.textContent=o,e.style.width=this.g.zoomer.get("labelIdLength")+"px",e.style.display="inline-block",this.el.appendChild(e)),this.g.vis.get("labelPartition")&&(r=document.createElement("span"),r.style.width=this.g.zoomer.get("labelPartLength")+"px",r.textContent=this.model.get("partition"),r.style.display="inline-block",this.el.appendChild(e),this.el.appendChild(r)),this.g.vis.get("labelName")&&(n=document.createElement("span"),n.textContent=this.model.get("name"),this.model.get("ref")&&this.g.config.get("hasRef")&&(n.style.fontWeight="bold"),n.style.width=this.g.zoomer.get("labelNameLength")+"px",this.el.appendChild(n)),this.el.style.overflow=scroll,this.el.style.fontSize=this.g.zoomer.get("labelFontsize")+"px",this},_onclick:function(t){var e;return e=this.model.get("id"),this.g.trigger("row:click",{seqId:e,evt:t})},_onmousein:function(t){var e;return e=this.model.get("id"),this.g.trigger("row:mouseout",{seqId:e,evt:t})},_onmouseout:function(t){var e;return e=this.model.get("id"),this.g.trigger("row:mouseout",{seqId:e,evt:t})}}),e.exports=n},{"backbone-viewj":9,"dom-helper":41}],131:[function(t,e){var n,i,r,o,s,a;s=t("backbone-viewj"),n=t("../../menu/menubuilder"),a=t("underscore"),r=t("dom-helper"),o=t("msa-seqtools"),e.exports=i=s.extend({className:"biojs_msa_metaview",initialize:function(t){return this.g=t.g,this.listenTo(this.g.vis,"change:metacell",this.render),this.listenTo(this.g.zoomer,"change:metaWidth",this.render)},events:{click:"_onclick",mousein:"_onmousein",mouseout:"_onmouseout"},render:function(){var t,e,i,s,l,h,u,c,d;return r.removeAllChilds(this.el),this.el.style.display="inline-block",d=this.g.zoomer.getMetaWidth(),this.el.style.width=d-10,this.el.style.paddingRight=5,this.el.style.paddingLeft=5,this.el.style.fontSize=this.g.zoomer.get("labelFontsize")-2+"px",this.g.vis.get("metaGaps")&&(c=this.model.get("seq"),e=a.reduce(c,function(t,e){return"-"===e&&t++,t},0),e=(e/c.length).toFixed(1),t=document.createElement("span"),t.textContent=e,t.style.display="inline-block",t.style.width=35,this.el.appendChild(t)),this.g.vis.get("metaIdentity")&&(i=this.g.stats.identity()[this.model.id],s=document.createElement("span"),this.model.get("ref")&&this.g.config.get("hasRef")?s.textContent="ref.":null!=i&&(s.textContent=i.toFixed(2)),s.style.display="inline-block",s.style.width=40,this.el.appendChild(s)),this.g.vis.get("metaLinks")&&this.model.attributes.ids&&(h=o.buildLinks(this.model.attributes.ids),a.keys(h).length>0)?(u=new n({name:"↗"}),console.log(a.keys(h)),a.each(h,function(t,e){return u.addNode(e,function(){return window.open(t)})}),l=u.buildDOM(),l.style.cursor="pointer",this.el.appendChild(l)):void 0},_onclick:function(t){return this.g.trigger("meta:click",{seqId:this.model.get("id",{evt:t})})},_onmousein:function(t){return this.g.trigger("meta:mousein",{seqId:this.model.get("id",{evt:t})})},_onmouseout:function(t){return this.g.trigger("meta:mouseout",{seqId:this.model.get("id",{evt:t})})}})},{"../../menu/menubuilder":86,"backbone-viewj":9,"dom-helper":41,"msa-seqtools":64,underscore:66}],"biojs-io-clustal":[function(t,e){var n,i,r,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("./generic_reader"),r=t("msa-seqtools"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.parse=function(t){var e,n,i,o,s,a,l,h,u,c,d,f,g;if(f=[],l="[object Array]"===Object.prototype.toString.call(t)?t:t.split("\n"),l[0].slice(0,6)===!1)throw new Error("Invalid CLUSTAL Header");for(i=0,e=1,d=0;i<l.length;)i++,a=l[i],null!=a&&0!==a.length?0!==a.trim().length?r.contains(a,"*")||(1===e&&(d=0,e=0),c=/^(?:\s*)(\S+)(?:\s+)(\S+)(?:\s*)(\d*)(?:\s*|$)/g,h=c.exec(a),null!=h?(s=h[1],g=h[2],d>=f.length?(u=r.getMeta(s),s=u.name,n=new r.model(g,s,d),n.ids=u.ids||{},n.details=u.details||{},o=Object.keys(n.ids),o.length>0&&(n.id=n.ids[o[0]]),f.push(n)):f[d].seq+=g,d++):console.log("parse error",a)):e=1:e=1;return f},e}(i)},{"./generic_reader":16,"msa-seqtools":64}],"biojs-io-fasta":[function(t,e){e.exports=t("./parser")},{"./parser":18}],"biojs-io-gff":[function(t,e){var n=function(){};e.exports=n;var i=t("./utils"),r=t("./jalview");n.parse=function(t){var e=t.split("\n"),i={},o=[];i.type=n._guessType(e);var s=0;if("jalview"===i.type){var a=r.readHeader(e);s=a.offset,i.colors=a.colors,o=a.features}for(var l=s;l<e.length;l++){var h=e[l];0!==h.length&&"#"!==h[0]&&(h=n.parseLine(h),void 0!==h&&o.push(h))}return{features:o,config:i}},n._guessType=function(t){return"##gff-version 3"===t[0].substring(0,15)?"gff3":t[0].indexOf("#")<0&&2===t[0].split("	").length?"jalview":"gff3"},n.parseSeqs=function(t){var e=n.parse(t),i={};return e.features.forEach(function(t){var e=t.seqname;void 0===i[e]&&(i[e]=[]),delete t.seqname,i[e].push(t)}),delete e.features,e.seqs=i,e},n.parseLine=function(t){var e={},n=t.split(/\s+/);if(1!==n.length){e.seqname=n[0],e.source=n[1],e.feature=n[2],e.start=parseInt(n[3]),e.end=parseInt(n[4]),e.score=n[5],e.strand=n[6],e.frame=n[7];var r=n.slice(8).join(" ");return Object.keys(e).forEach(function(t){"."===e[t]&&(e[t]=void 0)}),e.score&&(e.score=parseFloat(e.score)),e.frame&&(e.frame=parseInt(e.frame)),e.attributes=i.extractKeys(r),e}},n.exportLine=function(t){var e=Object.keys(t.attributes).map(function(e){return e+"="+t.attributes[e]}).join(";"),n=[t.seqname,t.source,t.feature,t.start,t.end,t.score,t.strand,t.frame,e];return n=n.map(function(t){return void 0===t?".":t}),n.join("	")},n.exportLines=function(t){return"##gff-version 3\n"+t.map(n.exportLine).join("\n")},n.exportSeqs=function(t){var e=[];for(var i in t)t[i].forEach(function(t){t.seqname=i,e.push(t)});return n.exportLines(e)}},{"./jalview":19,"./utils":20}],msa:[function(t,e){"undefined"==typeof biojs&&(biojs={}),"undefined"==typeof biojs.vis&&(biojs.vis={}),window.msa=biojs.vis.msa=e.exports=t("./src/index"),"undefined"==typeof biojs.io&&(biojs.io={}),window.biojs.io.fasta=t("biojs-io-fasta"),window.biojs.io.clustal=t("biojs-io-clustal"),window.biojs.xhr=t("xhr"),e.exports=t("./src/index"),t("./css/msa.css")},{"./css/msa.css":1,"./src/index":83,"biojs-io-clustal":"biojs-io-clustal","biojs-io-fasta":"biojs-io-fasta",xhr:"xhr"}],xhr:[function(t,e){function n(t,e){function n(){4===m.readyState&&S()}function r(){var t=null;if(m.response?t=m.response:"text"!==m.responseType&&m.responseType||(t=m.responseText||m.responseXML),_)try{t=JSON.parse(t)}catch(e){}return t}function u(){return 1223===m.status?204:m.status}function c(t,e){var n=null;if(0===t||t>=400&&600>t){var i=("string"==typeof e?e:!1)||a[String(t).charAt(0)];n=new Error(i),n.statusCode=t}return n}function d(){var t=u(),n=r(),i=c(t,n),o={body:n,statusCode:t,statusText:m.statusText,raw:m};o.headers=m.getAllResponseHeaders?s(m.getAllResponseHeaders()):{},e(i,o,o.body)}function f(){var t=u(),n=c(t);m.status=m.statusCode=t,m.body=r(),m.headers=s(m.getAllResponseHeaders()),e(n,m,m.body)}function g(t){e(t,m)}"string"==typeof t&&(t={uri:t}),t=t||{},e=o(e);var m=t.xhr||null;m||(m=t.cors||t.useXDR?new h:new l);var p,v=m.url=t.uri||t.url,b=m.method=t.method||"GET",x=t.body||t.data,w=m.headers=t.headers||{},y=!!t.sync,_=!1,S=t.response?d:f;if("json"in t&&(_=!0,w.Accept="application/json","GET"!==b&&"HEAD"!==b&&(w["Content-Type"]="application/json",x=JSON.stringify(t.json))),m.onreadystatechange=n,m.onload=S,m.onerror=g,m.onprogress=function(){},m.ontimeout=i,m.open(b,v,!y),(t.withCredentials||t.cors&&t.withCredentials!==!1)&&(m.withCredentials=!0),y||(m.timeout="timeout"in t?t.timeout:5e3),m.setRequestHeader)for(p in w)w.hasOwnProperty(p)&&m.setRequestHeader(p,w[p]);else if(t.headers)throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(m.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(m),m.send(x),m}function i(){}var r=t("global/window"),o=t("once"),s=t("parse-headers"),a={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},l=r.XMLHttpRequest||i,h="withCredentials"in new l?l:r.XDomainRequest;e.exports=n},{"global/window":67,once:68,"parse-headers":72}]},{},["msa"]);